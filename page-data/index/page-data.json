{"componentChunkName":"component---src-templates-blog-tsx","path":"/","webpackCompilationHash":"ba1a271305926245155b","result":{"data":{"logo":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABFUlEQVQY023PvUrDUBTA8ZuCtoMoOLQ4dWhN14x2kEKXFkGoohQ/QBexOHRycAidKkgHHRq69APRoTjFJYODIA6+gSBYfYMmfYLE/5VT6NALP845NyeHc9UoCHZRQvonCLKKE4ZhAXYURTsYoE9dIy5iCzfUJnEdV+RF4iu6ikFH2EPxazzOcJmg4Rnn5C8ysIEOHqTe5/sT3qXOwYOtRr5/wLAqzpCTDXu4p2ETtyjgGJ/cX+se8jeU9fa4RBt5vWENpjzdkoGPcGg4RQsbOMEFmnBRRwVDHEK/yFXfvr/CoPjvZLKcdByDyzWGeajigzorGy0oOeRJiUtITe/pX1XzDk3buIMltSFR/zTtic3060X+8z8PsEUt8G3LVQAAAABJRU5ErkJggg==","width":400,"height":128,"src":"/static/2b5eaa0de166a8b5faebad4955c2200c/647de/ghost-logo.png","srcSet":"/static/2b5eaa0de166a8b5faebad4955c2200c/647de/ghost-logo.png 1x"}}},"header":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAcZUED//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAWEAADAAAAAAAAAAAAAAAAAAAAASD/2gAIAQEAAT8hHP8A/9oADAMBAAIAAwAAABD47//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABgQAAMBAQAAAAAAAAAAAAAAAAABERAh/9oACAEBAAE/EKPlG+FP/9k=","aspectRatio":1.4992503748125936,"src":"/static/9fb9647467dab072b9ebe36e9e52ae95/883ab/blog-cover.jpg","srcSet":"/static/9fb9647467dab072b9ebe36e9e52ae95/32ee9/blog-cover.jpg 500w,\n/static/9fb9647467dab072b9ebe36e9e52ae95/2f7e7/blog-cover.jpg 1000w,\n/static/9fb9647467dab072b9ebe36e9e52ae95/883ab/blog-cover.jpg 2000w","sizes":"(max-width: 2000px) 100vw, 2000px"}}},"allMarkdownRemark":{"edges":[{"node":{"timeToRead":6,"frontmatter":{"title":"Vim est vulnérable - Mise à jour de Vim sur macOS","subtitle":"Mettez à jour Vim avec la dernière version en quelques minutes.","date":"2019-06-23T19:00:00.000Z","tags":["Vim","Mac"],"draft":false,"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAMEAQX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABnPJRfYRJ3eAH/8QAHBAAAgICAwAAAAAAAAAAAAAAAQIDEgAEEBMh/9oACAEBAAEFAr+d1Wj3LA4kTSYuqAIoUYcf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAHRAAAgEEAwAAAAAAAAAAAAAAAAEhAhEigRASUf/aAAgBAQAGPwLGndUCqv2a0jKC7Zio9JZdrn//xAAeEAEAAgIBBQAAAAAAAAAAAAABABEhMXEQQWGRof/aAAgBAQABPyHF3pxvUElc2AUQ1SO9Eu7XLPvxqV1b8TNfXZ1Koo6f/9oADAMBAAIAAwAAABCDLzz/xAAWEQEBAQAAAAAAAAAAAAAAAAABESD/2gAIAQMBAT8QVSLj/8QAFxEBAAMAAAAAAAAAAAAAAAAAAREgIf/aAAgBAgEBPxANmn//xAAfEAEBAAIBBAMAAAAAAAAAAAABEQAhMUFRcaEQ4fD/2gAIAQEAAT8QTY2F4eBtwaGwenXlylUwS6h95VQu9P3rN0jXLMAV+uQPeSBaA2V3nVwAAAcAQPj/2Q==","aspectRatio":1,"src":"/static/368261693a41f4548bf3cc82019ebe1a/fb184/vim.jpg","srcSet":"/static/368261693a41f4548bf3cc82019ebe1a/f8f18/vim.jpg 930w,\n/static/368261693a41f4548bf3cc82019ebe1a/fb184/vim.jpg 1800w","sizes":"(max-width: 1800px) 100vw, 1800px"}}},"author":{"id":"ludo","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"src":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png"}}]}}},"excerpt":"Si vous travaillez dans le terminal, vous utilisez probablement Vim fréquemment. Beaucoup de gens ont une relation d’amour/haine avec Vim, mais personnellement c’est mon éditeur de ligne de commande préféré, surtout quand je suis sur une machine Linux, et je l’utilise aussi fréquemment sur mon Mac, aussi. Récemment, une vulnérabilité a été identifiée à Vim. La vulnérabilité concerne l’utilisation malveillante de la fonction modelines de Vim. Cette vulnérabilité affecte toutes les versions de Vim antérieures à la version 8.1.1365, ce qui signifie qu’elle affecte aussi votre Mac, si vous utilisez la version fournie avec macOS 10.14.5, qui est 8.0.1283. Au moment d’écrire ces lignes, la version que nous installons est la 8.1.1573, ce qui permettra de corriger la vulnérabilité. Nous allons discuter comment mettre à jour Vim à la dernière version pour éviter ce problème et aussi couvrir brièvement ce que signifie cette vulnérabilité. Parlons d’abord des mauvaises choses. Que sont les modelines et pourquoi devrais-je m’en soucier? Sans vous ennuyer avec les détails précis, nous pouvons dire que les modelines sont un moyent de configurer les préréglages dans Vim en ajoutant des commandes en haut des fichier qui définissent ces préréglages lors de l’exécution du fichier. Alors qu’est-ce que cela signifie? En termes de vulnérabilité, cela signifie que bien que les modelines aient des cas d’utilisation légitimes, si vous avez une version vulnérable de Vim, il est possible d’abuser de cette fonctionnalité et d’échapper à la sandbox d’exécution de Vim, ce qui permet d’exécuter du code arbitraire de manière non sécurisée. Comment fonctionne cette vulnérabilité? Imaginez un scénario dans lequel un acteur malveillant a chargé un script contenant des modelines dans GitHub et a réussi à valider le fichier dans un référentiel que vous utilisez. L’attaquant a ajouté quelques lignes de commandes modeline en haut d’un script censé être un script Bash standard. Vous décidez d’ouvrir le fichier dans Vim pour lire le code avant de l’exécuter (toujours une bonne idée… en général). C’est tout ce dont nous avons besoin; le code malveillant s’exécute car tout ce que Vim doit faire est de lire le fichier et les modelines sont exécutées, c’est ainsi que les modelines sont supposées fonctionner. Malheureusement pour vous, votre version de Vim est obsolète et vous avez été infecté car ce code malveillant peut maintenant être exécuté en dehors de Vim. Ou peut-être pas, parce que vous avez lu cet article en premier, puis vous avez mis à jour Vim. Liste de pré-installation Il convient de discuter de certaines mises en garde avant de poursuivre. Chaque fois que vous apportez des modifications à macOS en utilisant un terminal, et en particulier en exécutant des commandes utilisant sudo, vous devez faire attention car il est facile de casser des choses. Premièrement, nous ne pouvons pas supprimer la version de Vim installée avec macOS. Au lieu de cela, nous allons installer la dernière version et nous assurer que c’est celle utilisée lorsque vous accédez au terminal. La raison pour laquelle nous ne pouvons pas supprimer la version de Vim fournie avec macOS est due à la configuration des autorisations dans macOS. Apple a configuré en toute sécurité les autorisations de sorte que l’utilisateur ne puisse plus modifier (ni même casser les composants) du système principal, y compris Vim. De plus, nous ne souhaitons pas vraiment supprimer les logiciels de base afin de ne pas causer de conflits. Nous apportons un changement qui peut facilement être annulé si quelque chose se passait mal ou devait être changé à l’avenir. Deuxièmement, nous allons exécuter quelques commandes en utilisant sudo. Cela signifie que vous allez exécuter ces commandes comme si vous étiez l’utilisateur root. Cela pourrait poser problème si vous ne lisez pas et ne suivez pas les instructions à la lettre. Cela signifie également que vous devez avoir un accès administrateur dans macOS et que vous devrez fournir votre mot de passe lors de l’exécution de la commande. Tu as été prévenu. Mais ne vous inquiétez pas, ce que nous faisons est assez simple, et utiliser sudo n’est pas mauvais, c’est juste que vous voulez vous rappeler qu’un grand pouvoir implique de grandes responsabilités, et que sudo a définitivement un grand pouvoir. Un grand pouvoir implique de grandes responsabilités. Oncle Ben Cela dit, passons à autre chose et commençons à mettre à jour Vim. Compiler Vim sur macOS Pour commencer, ouvrons l’application Terminal. Vous pouvez rechercher cela en utilisant Spotlight (Cmd + Space) ou ouvrir votre dossier Applications, cliquez sur Utilitaires, puis sur Terminal. Tout d’abord, nous devons récupérer la dernière version de Vim dans le dépôt officiel GitHub, puis nous allons changer de répertoire dans le répertoire vim qui vient d’être créé. Nous venons de télécharger le code source de Vim, ce qui signifie que nous devrons le compiler avant de pouvoir l’installer. Pour ce faire, tapez simplement make dans le même répertoire. Vous allez voir un mur de texte en cours de création lors de la compilation de l’application. Cela prendra probablement quelques minutes, en fonction de la vitesse de votre Mac. Une fois terminé, vous serez renvoyé à l’invite de commande. Installer le dernier Vim sur macOS Maintenant que nous avons compilé Vim, il est temps de terminer l’installation. Pour exécuter la commande d’installation, vous devrez utiliser sudo. C’est une considération importante car cela signifie que nous installons dans un répertoire système et, comme je l’ai mentionné ci-dessus, nous souhaitons faire attention, veillez à exécuter correctement la commande suivante. Exécutez ce qui suit dans le même dossier vim que nous utilisions. Votre mot de passe vous sera demandé, indiquez-le et la commande sera exécutée. Encore une fois, vous verrez un mur de texte semblable à celui que vous avez vu lors de la compilation de Vim. Une fois ce processus terminé, Vim sera installé et vous reviendrez à l’invite de commande, mais nous ne l’avons pas encore terminée. Comme je l’ai mentionné plus tôt, nous installons une installation supplémentaire de Vim. Nous voulons être certains que lorsque nous exécutons vim à partir du terminal, nous obtenons vraiment la bonne version. Lisez la suite pour voir comment configurer ceci correctement. Configurer le bon Vim Lorsque nous avons installé Vim, l’application binaire exécutable a été placée dans /usr/local/bin/vim. Toutefois, l’installation initiale de MacOS se trouve toujours dans /usr/bin/vim. Cela ne posera aucun problème lorsque nous utiliserons vim depuis le terminal, mais cela posera des problèmes si nous exécutons vi, ce qui est très courant pour les utilisateurs de longue date de Vim, car Vi est l’application sur laquelle Vim est basé. Sur macOS, la commande vi est un lien symbolique vers /usr/bin/vim et cela n’a pas changé après notre installation. Vous remarquerez que la version affichée sur l’écran d’accueil de Vim est différente si vous exécutez vim vs. vi. Cela pourrait causer des problèmes plus tard. Voyons ce qui se passe. Que se passe t-il ici? Le problème est notre PATH - il sait toujours que le lien symbolique vi existe et lit le répertoire /usr/bin lorsque notre profil est chargé. Cependant, par défaut, /usr/local/bin est lu en premier, puis /usr/bin, ce qui signifie que nous devons simplement fournir un lien symbolique vers le chemin de l’application que nous voulons exécuter lorsque nous exécutons vi. Faisons-le maintenant. Créez un lien symbolique à l’aide de la commande suivante, puis redémarrez votre terminal. C’est tout! Une fois que vous aurez redémarré votre terminal, que vous utilisiez Vi ou Vim, vous obtiendrez la même installation mise à jour de Vim. Conclusion J’espère que cela a été une expérience éducative, mais simple, mettant à jour l’éditeur de texte en ligne de commande préféré de tout le monde. Merci d’avoir lu!","fields":{"layout":"post","slug":"/vim-modelines-vulnerable/"}}},{"node":{"timeToRead":8,"frontmatter":{"title":"Stratégie de déploiement de Kubernetes","subtitle":"Dans Kubernetes, il y a plusieurs façons de publier une application, il est nécessaire de choisir la bonne stratégie pour rendre votre infrastructure fiable pendant la mise à jour d'une application.","date":"2019-05-25T08:00:00.000Z","tags":["Kubernetes","DevOps"],"draft":false,"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgT/xAAVAQEBAAAAAAAAAAAAAAAAAAABAP/aAAwDAQACEAMQAAABzC2jBYj/xAAaEAACAgMAAAAAAAAAAAAAAAABAgARITFC/9oACAEBAAEFAu8hQtzZANss/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8BR//EABkQAAMAAwAAAAAAAAAAAAAAAAABERAxQf/aAAgBAQAGPwJXREcEs//EABgQAQEBAQEAAAAAAAAAAAAAAAERADFh/9oACAEBAAE/IRsrGWEVe4jVD66plnHI7Z2ZqM6Xf//aAAwDAQACAAMAAAAQwP8A/8QAFxEBAAMAAAAAAAAAAAAAAAAAAAERMf/aAAgBAwEBPxDZU//EABcRAAMBAAAAAAAAAAAAAAAAAAABESH/2gAIAQIBAT8QxIg//8QAHhABAAICAgMBAAAAAAAAAAAAAQAhEUExYXGBkaH/2gAIAQEAAT8QZGFr56O45sQgzWiXtrCEP6wYQCWcsZ1Hgda+xT8AxY17n//Z","aspectRatio":1.33422281521014,"src":"/static/cc32bd959fba19866af4a1302ca23593/883ab/interchange.jpg","srcSet":"/static/cc32bd959fba19866af4a1302ca23593/f8f18/interchange.jpg 930w,\n/static/cc32bd959fba19866af4a1302ca23593/0e6ff/interchange.jpg 1860w,\n/static/cc32bd959fba19866af4a1302ca23593/883ab/interchange.jpg 2000w","sizes":"(max-width: 2000px) 100vw, 2000px"}}},"author":{"id":"ludo","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"src":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png"}}]}}},"excerpt":"Dans Kubernetes, il existe plusieurs façons de publier une application. Il est donc nécessaire de choisir la bonne stratégie pour rendre votre infrastructure fiable lors de la mise à jour d’une application. Le choix de la procédure de déploiement appropriée dépend des besoins. Nous avons énuméré ci-dessous certaines des stratégies possibles à adopter: Recreate RollingUpdate Blue/Green Canary A/B testing Vous pouvez expérimenter chacune de ces stratégies avec Minikube, les manifestes et les étapes à suivre sont expliqués dans ce github Examinons chaque stratégie et voyons quel type d’application vous conviendrez le mieux.  Recreate - idéal pour l’environnement de développement Un déploiement défini avec une stratégie de type recreate mettra fin à toutes les instances en cours d’exécution, puis les recréera avec la version la plus récente.  Vous trouverez un exemple complet et les étapes de déploiement à l’adresse https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/recreate Avantage État d’application entièrement renouvelé Inconvénients Temps d’arrêt qui dépend à la fois de la durée d’arrêt et du démarrage de l’application  RollingUpdate - déploiement lent Ce déploiement met à jour les pods de façon progressive. Un ReplicaSet secondaire est créé avec la nouvelle version de l’application, puis le nombre de répliques de l’ancienne version est réduit et la nouvelle version est augmentée jusqu’à ce que le nombre correct de répliques soit atteint.  Vous trouverez un exemple complet et les étapes de déploiement à l’adresse https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/ramped Lors de la configuration avec la mise à l’ échelle automatique du pod horizontal, il peut être pratique d’utiliser une valeur en pourcentage au lieu d’un nombre pour maxSurge et maxUnavailable . maxSurge permet d’indiquez combien de Pod il peut créer en plus du nombre de répliqua actuellement configurer maxUnavailable permet d’indiquer combien de Pod peuvent être “non disponible” pendant la mise à jour, toujours en fonction du nombre de répliqua configuré Si vous déclenchez un déploiement alors qu’un déploiement existant est en cours, le déploiement mettra le déploiement en pause et passera à une nouvelle version en remplaçant le déploiement. Avantages la version est lentement publiée sur toutes les instances pratique pour les applications avec état pouvant gérer le rééquilibrage des données Inconvénients le déploiement/la restauration peut prendre du temps la prise en charge de plusieurs API est difficile aucun contrôle sur le trafic  Blue/Green - mieux éviter les problèmes de versioning de l’API Un déploiement blue/green diffère d’un déploiement parce que la version “green” de l’application est déployée en parallèle de la version “blue”. Après avoir vérifié que la nouvelle version réponde aux exigences, nous mettons à jour l’objet Kubernetes Service qui joue le rôle d’équilibreur de charge pour envoyer du trafic vers la nouvelle version en remplaçant l’étiquette de version dans le champ selector  Vous trouverez un exemple complet et les étapes de déploiement à l’adresse https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/blue-green Avantages déploiement instantané éviter le problème de versioning, changer l’état du cluster en une fois Inconvénients nécessite le double des ressources le bon test de toute la plate-forme doit être effectué avant la mise en production la gestion des applications avec état peut être difficile  Canary - laissez le consommateur faire le test Le déploiement Canary consiste à router un sous-ensemble d’utilisateurs vers une nouvelle fonctionnalité. Dans Kubernetes, un déploiement canary peut être effectué en utilisant deux déploiements avec des étiquettes de pods communes. Une réplique de la nouvelle version est publiée à côté de l’ancienne version. Ensuite, après un certain temps et si aucune erreur n’est détectée, augmentez le nombre de répliques de la nouvelle version et supprimez l’ancien déploiement. L’utilisation de cette technique ReplicaSet nécessite de faire tourner autant de pod que nécessaire pour obtenir le bon pourcentage de trafic. Cela dit, si vous voulez envoyer 1% du trafic vers la version B, vous devez avoir un pod fonctionnant avec la version B et 99 pods fonctionnant avec la version A. Cela peut être assez peu pratique à gérer donc si vous recherchez une meilleure répartition du trafic, regarder les équilibreurs de charge tels que HAProxy ou les mailles de service comme Linkerd, qui offrent un meilleur contrôle du trafic.  Dans l’exemple suivant, nous utilisons deux ReplicaSets côte à côte, la version A avec trois répliques (75% du trafic), la version B avec un répliqua (25% du trafic). Manifeste de déploiement tronqué version A: Manifeste de déploiement tronqué version B, notez que ous ne démarrons qu’un seul répliqua de l’application: Vous trouverez un exemple complet et les étapes de déploiement à l’adresse https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/canary Avantages version publiée pour un sous-ensemble d’utilisateurs pratique pour la surveillance du taux d’erreur et des performances rollback rapide Inconvénients déploiement lent la répartition du trafic ajustée peut être coûteuse (99% A / 1% B = 99 pod A, 1 pod B) La procédure utilisée ci-dessus est native de Kubernetes, nous ajustons le nombre de répliques gérées par un ReplicaSet pour distribuer le trafic entre les versions. Si vous n’êtes pas sûr de l’impact que la sortie d’une nouvelle fonctionnalité pourrait avoir sur la stabilité de la plate-forme, une stratégie de sortie canari est suggérée.  A/B testing - idéal pour testes les fonctionnalités sur un sous-ensemble d’utilisateurs Le test A/B est en fait une technique permettant de prendre des décisions d’affaires basées sur des statistiques, plutôt qu’une stratégie de déploiement. Cependant, il est apparenté et peut être mis en oeuvre à l’aide d’un déploiement canari, c’est pourquoi nous en parlerons brièvement ici. En plus de répartir le trafic entre les versions en fonction du poids, vous pouvez cibler précisément un groupe donné d’utilisateurs en fonction de quelques paramètres (cookie, user agent, etc.). Cette technique est largement utilisée pour tester la conversion d’une fonctionnalité donnée et ne déployer que la version qui convient le plus. Istio, comme les autres maillages de service, fournis un moyen plus fin de subdiviser les instances de service avec un routage dynamique des requêtes basé sur des poids et/ou des en-têtes HTTP.  Vous trouverez ci-dessous un exemple d’installation de règles à l’aide d’Istio. Vous trouverez un exemple complet et les étapes de déploiement à l’adresse https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/ab-testing D’autres outils comme Linkerd, Traefik, NGINX, HAProxy, vous permettent également de le faire. Avantages nécessite un équilibreur de charge intelligent plusieurs versions en parallèle un contrôle total sur la répartition du trafic Inconvénients les erreurs difficiles à dépanner pour une session donnée, le traçage distribué deviennent obligatoires pas simple, vous devez configurer des outils supplémentaires  En résumé Il y a différentes façons de déployer une application, lors de la mise en production dans un environnement de développement/staging, un déploiement big bang ou progressif est généralement un bon choix. Lorsqu’il s’agit de production, un déploiement progressif ou en blue/green est généralement un bon choix, mais un test approprié de la nouvelle plate-forme est nécessaire. Si vous n’êtes pas sûr de la stabilité de la plate-forme et de l’impact que pourrait avoir la sortie d’une nouvelle version de logiciel, alors une version canari devrait être la bonne solution. Ce faisant, vous laissez le consommateur tester l’application et son intégration à la plate-forme. Enfin, si votre entreprise a besoin de tester une nouvelle fonctionnalité parmi un groupe spécifique d’utilisateurs, par exemple, tous les utilisateurs accédant à l’application à l’aide d’un téléphone mobile sont envoyés à la version A, tous les utilisateurs accédant via un ordinateur passent à la version B. Vous pouvez alors utiliser la technique de test A/B qui en utilisant un réseau de services Kubernetes ou une configuration serveur personnalisée vous permet de déterminer où un utilisateur doit être dirigé en fonction de certains paramètres.","fields":{"layout":"post","slug":"/k8s-deployement-strategies/"}}},{"node":{"timeToRead":4,"frontmatter":{"title":"Configuration locale de Kubernetes avec minikube sur MacOS X","subtitle":"","date":"2019-05-23T08:00:00.000Z","tags":["Kubernetes","DevOps"],"draft":false,"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIFA//EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHN5DxbJYf/xAAaEAACAgMAAAAAAAAAAAAAAAAAAQIDEBET/9oACAEBAAEFAlaRsOmEbZ//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAYEAACAwAAAAAAAAAAAAAAAAAAMgEgMf/aAAgBAQAGPwJhpNp//8QAGhAAAwEAAwAAAAAAAAAAAAAAAAERITFhgf/aAAgBAQABPyHSUvSOU7FgtjtClyf/2gAMAwEAAgADAAAAEGQv/8QAFhEBAQEAAAAAAAAAAAAAAAAAABFB/9oACAEDAQE/EMV//8QAFREBAQAAAAAAAAAAAAAAAAAAEEH/2gAIAQIBAT8Qp//EABoQAQEAAwEBAAAAAAAAAAAAAAEAESExUZH/2gAIAQEAAT8QTFAXqtS5LFXZken2T1hAFInS/9k=","aspectRatio":1.7809439002671417,"src":"/static/aac12d8124ce6730c0247f5495bff894/883ab/ship.jpg","srcSet":"/static/aac12d8124ce6730c0247f5495bff894/f8f18/ship.jpg 930w,\n/static/aac12d8124ce6730c0247f5495bff894/0e6ff/ship.jpg 1860w,\n/static/aac12d8124ce6730c0247f5495bff894/883ab/ship.jpg 2000w","sizes":"(max-width: 2000px) 100vw, 2000px"}}},"author":{"id":"ludo","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"src":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png"}}]}}},"excerpt":"Minikube est un outil idéal pour configuer localement Kubernetes afin de tester et d’expérimenter vos déploiements. Dans ce guide, je vais essayer de vous aider à le mettre en marche sur votre machine locale, à donner quelques conseils sur où et comment effectuer certaines tâches et à le rendre aussi capable (je suppose quand vous utilisez k8s que vous veulent apprendre et utiliser Helm, etcd, istio, etc.). Installation de minikube Minikube fonctionne avec une machine virtuelle. Pour cela, on peut utiliser diverses options en fonction de vos préférences et de votre système d’exploitation. Ma préférence dans ce cas est Orable VirtualBox. Vous pouvez utiliser brew pour tout installer: Dans ce cas, vous pourriez obtenir une erreur d’installation peu concluante liée à l’installation de virtualbox, en particulier sur Mojave et problablement par la suite. Quoi qu’il en soit, il s’agit problablement d’une nouvelle fonctionnalité de sécurité dans MacOs X qui vous gêne. Allez dans Préférences Système> Sécurité et confidentialité et sur l’écran Général, vous verrez un (ou quelques) messages concernant certains logiciels nécessitant une approbation pour être installés. Vous devez examiner attentivement la liste s’il en existe plusieurs et autoriser l’installation du logiciel dont vous avez besoin - dans ce cas, le logiciel Oracle. Cela fait, vous pourrez relancer la commande ci-dessus et vous devrez alors être prêt pour les étapes suivantes. Exécuter et accéder au cluster Afin d’utiliser de manière optimale les ressources de votre ordinateur local, je suggérerais de l’arrêter quand vous n’en avez plus besoin… Avec VirtualBox au centre, il utilisera la batterie de votre ordinateur portable assez rapidement. Recommencer plus tard vous ramènera là où vous l’avez laissé: Le tableau de bord Kubernetes est également disponible (lorsque minikube est en cours d’exécution): Je vais supposer que vous avez kubectl installé localement et que vous l’utilisez déjà pour certains clusters distants, vous disposez donc de plusieurs contextes. Dans ce cas, vous devez répertorier les contextes et passer à minikube. Vous vous trouvez maintenant dans le contexte de votre cluster k8 local qui s’exécute sur minikube et vous pouvez effectuer toutes les opérations k8 qu’il contient. Ingress Pour exécuter vos déploiements comportant un ingress, vous aurez besoin d’un add-on d’entrée: Assurez-vous que vous configurez l’ingress en fonction de vos hôtes locaux. Cela signifie fondamentalement que tout ce que vous définissez comme hôte dans vos règles d’ingress doit être configuré dans votre fichier /etc/hosts Où [minikube ip] devrait être remplacé par l’ip actuel de minikube. Il fonctionne également avec plusieurs hôtes locaux séparés par des espaces après l’adresse ip de minikube. Voici un raccourci pour le faire en bash Docker registry La réalité de l’utilisation réelle du registre de conteneurs dans l’environnement local est rude. Je vais donc vous fournir une option simple, rapide et simpliste qui facilite le déploiement de votre travail local sur vos k8s locaux, mais vous prive de l’expérience très importante du registre de conteneurs. Registre de conteneurs local Obtenez le contexte de votre docker local pour pointer vers le context minikube:  Dans le contexte minikube, pour démarrer le registre docker local Donc, vous avez maintenant un registre local dans lequel pousser des choses (tant que votre docker est dans le contexte minikube) Vous pouvez maintenant faire: A ce stade, vous pouvez utiliser localhost:5000/<your_tag>: comme image dans votre déploiement et c’est tout. Utilisation du référentiel de conteneur distant Pour utiliser localement le référentiel de conteneur distant, vous devez fournir un moyen d’authentification, qui se base sur les secrets de Kubernetes. Pour la gestion des secrets locaux pour ECR, GCR and Docker registry, je recommande d’utiliser l’addon minikube appelé registry-creds. Je ne le considère pas suffisamment sûr pour être utilisé ailleurs que dans l’environnement local. Helm Helm est un gestionnaire de paquets pour k8s et est souvent utilisé pour la gestion de la configuration d’un déploiement à l’autre. Compte tenu de la grande popularité de l’outil et de son adoption croissante, je voudrais terminer ce guide par une note sur l’ajout de helm à votre environnement Kubernetes local. C’est assez facile à ce stade, il suffit de mettre en place minikube et: Helm utilise un backend appelé Tiller. C’est ce qui est installé/déployé lors de l’exécution de helm init. Une lecture précieuse: https://helm.sh/docs/using_helm/ Maintenant, vous disposez d’un environnement Kubernetes local complet capable d’accepter tous vos déploiements de test avant de décider de les placer dans le cloud.","fields":{"layout":"post","slug":"/k8s-minikube/"}}},{"node":{"timeToRead":2,"frontmatter":{"title":"Bash - Vérifier les variables d'environnement sont définies ou s'il existe des fichiers/références","subtitle":"","date":"2019-05-21T22:00:00.000Z","tags":["Bash","DevOps"],"draft":false,"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAQBAgMF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAFak9W5wHg//8QAGxAAAQQDAAAAAAAAAAAAAAAAAQACAxESISL/2gAIAQEAAQUCKy6E1BuzHEyqC//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABoQAQACAwEAAAAAAAAAAAAAAAABMRESIYH/2gAIAQEABj8C8Qi3WdVP/8QAGRAAAgMBAAAAAAAAAAAAAAAAAAERITGR/9oACAEBAAE/IaNiOjRsui2rXBjEiRSTh//aAAwDAQACAAMAAAAQpN//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPxBX/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Qp//EABwQAQACAgMBAAAAAAAAAAAAAAEAESFRMUFhwf/aAAgBAQABPxDieh8j0AS9GPIJjMXQwMpryCyIpy61KNPs2wWhNAn/2Q==","aspectRatio":1.7777777777777777,"src":"/static/b9929b1a4915b5e4d241ad5af23c0901/989b1/servers.jpg","srcSet":"/static/b9929b1a4915b5e4d241ad5af23c0901/f8f18/servers.jpg 930w,\n/static/b9929b1a4915b5e4d241ad5af23c0901/989b1/servers.jpg 1600w","sizes":"(max-width: 1600px) 100vw, 1600px"}}},"author":{"id":"ludo","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"src":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png"}}]}}},"excerpt":"La configuration, le CI et les flux de déploiement représente un peu l’ancien script bash. Malgré mon profond intérêt pour les subtilités de Bash (/sarcasme), j’ai continué à chercher des solution aux mêmes situations sur  Google et StackOverflow. Pour éviter d’avoir à le refaire moi-même et pour votre plaisir de lecture, les voici. Pour être dangereux en termes d’installation, de CI et de flux de déploiement, nous rencontrerons ce qui suit: azerty azerty Vérifier si un fichier existe Vérifier si un lien symbolique existe Vérifier si une variable d’environnement est définie Basculer une variable d’environnement Demander à l’utilisateur Un dernier conseil, s’il s’agit de plusieurs lignes, essayez d’utiliser quelque chose comme JavaScript ou Python pour écrire votre script. Injecter .env dans votre session/environnement Nous avons des fichiers .env, Docker Compose traite cela avec une utilisation habituelle, mais disons que nous voulons que quelque chose tourne en dehors de Docker (et sans utiliser quelque chose comme dotenv). Voici l’extrait de code pour un shell UNIX","fields":{"layout":"post","slug":"/bash-justeAssezPourEtreDangereux/"}}},{"node":{"timeToRead":2,"frontmatter":{"title":"Mocking des classes ES6 dans les tests unitaires","subtitle":"Cet article passe en revue certains modèles pouvant être utilisés pour tester les classes ES6.","date":"2019-05-11T09:00:00.000Z","tags":["Sequelize","Node.js","Javascript"],"draft":false,"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAED/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAZUjJmr/xAAaEAACAgMAAAAAAAAAAAAAAAAAAQIQESFB/9oACAEBAAEFAsROMjsbr//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/AYf/xAAWEQADAAAAAAAAAAAAAAAAAAABEBH/2gAIAQIBAT8BoX//xAAWEAADAAAAAAAAAAAAAAAAAAACIDL/2gAIAQEABj8CkW//xAAaEAACAwEBAAAAAAAAAAAAAAAAAREhMVGh/9oACAEBAAE/IVpgJCrobEekUovp/9oADAMBAAIAAwAAABDIH//EABURAQEAAAAAAAAAAAAAAAAAABAh/9oACAEDAQE/EIP/xAAWEQADAAAAAAAAAAAAAAAAAAAQETH/2gAIAQIBAT8QZB//xAAZEAEAAwEBAAAAAAAAAAAAAAABABEhoTH/2gAIAQEAAT8QpiZGNGdgQmmlT3Om9j1wyKmP/9k=","aspectRatio":1.5037593984962405,"src":"/static/4facbfac04767ff55d17ee1932aa8b00/883ab/books.jpg","srcSet":"/static/4facbfac04767ff55d17ee1932aa8b00/f8f18/books.jpg 930w,\n/static/4facbfac04767ff55d17ee1932aa8b00/0e6ff/books.jpg 1860w,\n/static/4facbfac04767ff55d17ee1932aa8b00/883ab/books.jpg 2000w","sizes":"(max-width: 2000px) 100vw, 2000px"}}},"author":{"id":"ludo","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"src":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png"}}]}}},"excerpt":"Cet article passe en revue certains modèles pouvant être utilisés pour tester les classes ES6. Les exemples utiliseront l’auto-mocking du module Jest mais devraient être portables à d’autres bibliothèques de mocking de module (par exemple Proxyquire) avec quelques modifications. Dans cet article, nous avons exploré comment définir des modèles Sequelize en utilisant des classes ES6. Un des avantages d’une telle approche est qu’elle permet des tests unitaires faciles, elle permet d’instancier le modèle sans le bagage de toute Sequelize (et/ou une base de données). Alternative avec Object.assign Nous allons tester le modèle suivant (qui est une classe ES6): Au niveau des modules, nous le voulons: mock/stub Sequelize (et la classe de base Model) importer le modèle Dans le test: Instantaner le modèle que nous avons défini (sans crash) Définissez quelques propriétés sur cette instance Exécuter certaines méthodes Affirmer sur le rendement  Alternative avec Object.assign Si nous définissons plus d’une propriété d’instance unique, l’utilisation de Object.assign peut être plus simple à gérer:","fields":{"layout":"post","slug":"/node-sequelize-mocking/"}}},{"node":{"timeToRead":4,"frontmatter":{"title":"Utilisation des classes ES6 pour les modèles Sequelize 4 ou 5","subtitle":"Sequelize supporte les classe ES6, mais la documentation manque un peu.","date":"2019-05-10T18:00:00.000Z","tags":["Sequelize","Node.js","Javascript"],"draft":false,"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAwAE/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQP/2gAMAwEAAhADEAAAAczZEjZ4If/EABcQAAMBAAAAAAAAAAAAAAAAAAABESD/2gAIAQEAAQUCRc//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAbEAACAgMBAAAAAAAAAAAAAAAAASExEWGRgf/aAAgBAQABPyFlvghOxC9szFvp/9oADAMBAAIAAwAAABD3P//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/EKf/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPxCI/8QAHhABAAICAQUAAAAAAAAAAAAAAQARMUEhgZGxwdH/2gAIAQEAAT8QM6NHdF0LzWJa5roJYEtwbZlS0dFPcHTyPs//2Q==","aspectRatio":1.440922190201729,"src":"/static/4bd4c364aa3d236b8cdbcdcd88b5bbff/883ab/drawer.jpg","srcSet":"/static/4bd4c364aa3d236b8cdbcdcd88b5bbff/f8f18/drawer.jpg 930w,\n/static/4bd4c364aa3d236b8cdbcdcd88b5bbff/0e6ff/drawer.jpg 1860w,\n/static/4bd4c364aa3d236b8cdbcdcd88b5bbff/883ab/drawer.jpg 2000w","sizes":"(max-width: 2000px) 100vw, 2000px"}}},"author":{"id":"ludo","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"src":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png"}}]}}},"excerpt":"La spécification ES2015 ou ES6 a introduit la class en JavaScript. Des bibliothèques telles que React sont passées de React.createClass à la class MyComponent extends React.Component, c’est-à-dire qu’ils sont passés de l’utilisation de leur propre constructeur à l’utilisation d’un langage intégré pour transmettre l’intention du programmeur. Pour la couche de persistance d’une application Web Node.js, quelques bases de données me viennent à l’esprit, comme MongoDB (éventuellement associé à mongoose), ou une association de clés-valeurs comme Redis. Pour exécuter une base de données relationnelle avec une application Node, Sequelize , “Un ORM de dialecte multi-SQL facile à utiliser pour Node.js” est une bonne option. Il permet à l’application de fonctionner avec une instance MySQL ou PostgreSQL et offre un moyen simple de mapper la représentation des entités dans la base de données vers JavaScript et inversement. Les API v4 et inférieure de Sequelize pour les définitions de modèle se présentent comme suit: Pour ajouter des méthodes de classes et d’instance, vous devez écrire ce qui suit: Cela est nécessaire avant l’ES6 car il n’existait pas de notion d’héritage classique. Maintenant, nous avons les classes, pourquoi ne pas les exploiter? Pour les développeurs habitués à avoir des classes, les éléments suivants vous sembleront probablement familiers: Sequelize supporte réellement cela, mais la documentation manque un peu. L’un des seuls endroits où trouver une référence à la procédure à suivre est dans un numéro de GitHub: https://github.com/sequelize/sequelize/issues/6524. Voici un aide-mémoire sur ce que vous souhaitez faire et comment le réaliser à l’aide de la classe ES6 + héritage de Sequelize.Model:  Initialiser le modèle avec le ou les champs saisis Associez votre modèle à d’autres modèles Définition d’un nom de table personnalisé pour votre modèle Définition d’un nom de modèle personnalisé pour votre modèle (pour Sequelize) Les requêtes Méthodes d’instance Initialisez tous vos modèles  Initialiser le modèle avec le ou les champs saisis  Associez votre modèle à d’autres modèles  Définition d’un nom de table personnalisé pour votre modèle  Définition d’un nom de modèle personnalisé pour votre modèle (pour Sequelize)  Les requêtes  Méthodes d’instance  Initialisez tous vos modèles require() suivi de model.init() est une alternative à sequelize.import(path), il est un peu plus clair ce qui est importé et non importé et sous quel nom.","fields":{"layout":"post","slug":"/node-sequelize-classes/"}}},{"node":{"timeToRead":3,"frontmatter":{"title":"Sequelize DataTypes: guide pratique","subtitle":"Les DataTypes sont au coeur de la bibliothèque Sequelize. Ceci est un guide pratique et complet pour compenser la documentation officielle clairsemée de Sequelize sur le sujet.","date":"2019-05-10T18:00:00.000Z","tags":["Sequelize","Node.js","Javascript"],"draft":false,"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAgADBP/EABYBAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAwDAQACEAMQAAAB4EVlxhR//8QAFhABAQEAAAAAAAAAAAAAAAAAAAER/9oACAEBAAEFApGKitf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAVEAEBAAAAAAAAAAAAAAAAAAAQAf/aAAgBAQAGPwJr/8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERIUFRYYH/2gAIAQEAAT8hS42SnnRbwW9FZjQ2P//aAAwDAQACAAMAAAAQqP8A/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8Qp//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/EIf/xAAdEAEAAwACAwEAAAAAAAAAAAABABEhMYFRYXHR/9oACAEBAAE/EANWvcVFIIaBtTy+hHS24OpjsUuH5+sY8z//2Q==","aspectRatio":1.7777777777777777,"src":"/static/09af639daa5f4b188077c5051da031c3/883ab/metal-typesetting.jpg","srcSet":"/static/09af639daa5f4b188077c5051da031c3/f8f18/metal-typesetting.jpg 930w,\n/static/09af639daa5f4b188077c5051da031c3/0e6ff/metal-typesetting.jpg 1860w,\n/static/09af639daa5f4b188077c5051da031c3/883ab/metal-typesetting.jpg 2000w","sizes":"(max-width: 2000px) 100vw, 2000px"}}},"author":{"id":"ludo","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"src":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png"}}]}}},"excerpt":"Les DataTypes sont au coeur de la bibliothèque Sequelize. Ceci est un guide pratique et complet pour compenser la documentation officielle clairsemée de Sequelize sur le sujet. Tout d’abord, DataTypes contient à la fois les types et les générateurs pour les valeurs par défaut: NOW , \u001dUUIDV1 et UUIDV4 sont des valeurs par défaut spéciales. Les endroits où vous êtes susceptible de rencontrer des DataTypes se trouvent dans la définition du champ de modèle et dans les définitions de migration. Notez que pour un modèle et un champ donnés, le type de données doit être identique dans le modèle et dans la migration. Table des matières: Types de texte Les valeurs par défaut Nombre Types primitifs fantaisie Date/heure Types de fantaisie Types fantaisie Postgres  Types de texte STRING Une chaîne de longueur variable. Longueur par défaut 255. Prend en charge BINARY Utilisation: une chaîne binaire de 100 longueurs DataTypes.STRING(100).BINARY CHAR Une chaîne de longueur fixe. Longueur par défaut 255. Prend en charge BINARY Utilisation: un caractère binaire de 100 longueurs DataTypes.CHAR(100).BINARY TEXT : une colonne de texte de longueur illimitée  Les valeurs par défaut NOW : une valeur par défaut de l’horodatage actuel UUIDV1 : Un identifiant universel unique par défaut généré conformément à la norme UUID v1 UUIDV4 : Un identifiant universel unique par défaut généré conformément à la norme UUID v2  Nombre Tous les éléments suivants prennent en charge ces propriétés: UNSIGNED, ZEROFILL. Par exemple: La même chose peut être faite en utilisant BIGINT.UNSIGNED, FLOAT.UNSIGNED,… INTEGER: Un entier de 32 bits. BIGINT: Un entier de 64 bits. FLOAT: nombre à virgule flottante (précision sur 4 octets). Accepte un ou deux arguments de précision REAL: nombre à virgule flottante (précision sur 4 octets). Accepte un ou deux arguments de précision DOUBLE: nombre à virgule flottante (précision sur 8 octets). Accepte un ou deux arguments de précision DECIMAL: nombre décimal. Accepte un ou deux arguments de précision  Types primitifs fantaisie BOOLEAN: colonne booléenne / tinyint qui est forcée de devenir un booléen JavaScript. UUID: Une colonne contenant un identifiant universel unique, la forme est validée, à utiliser avec les valeurs par défaut UUIDV1 ou UUIDV4  Date/heure TIME: une colonne de temps DATE: une colonne datetime DATEONLY: Une colonne de date seulement  Types fantaisie BLOB: Stockage binaire. Longueurs disponibles: tiny, medium, long. Par exemple: DataTypes.BLOG('tiny') VIRTUAL Une valeur virtuelle qui n’est pas stockée dans la base de données. Cela peut par exemple être utile si vous souhaitez fournir une valeur par défaut dans votre modèle, qui est renvoyée à l’utilisateur mais non stockée dans la base de données. Voir les docs ENUM Une énumération. DataTypes.ENUM('value', 'another value') Idéalement, devrait être utilisé avec les chaînes stockées dans les constantes  Types fantaisie Postgres HSTORE: une colonne clé/valeur JSON: une colonne de chaîne JSON. JSONB: une colonne de données JSON pré-traitée. RANGE: Pour Postgres 9.4+, les types de plage sont des types de données représentant une plage de valeurs d’un type d’élément (appelé sous-type de plage). ARRAY Un tableau de type, par exemple DataTypes.ARRAY(DataTypes.DECIMAL)","fields":{"layout":"post","slug":"/node-sequelize-datatypes/"}}},{"node":{"timeToRead":1,"frontmatter":{"title":"Changer la date d'un commit","subtitle":"Une des choses les plus grandes et les pires avec git est que vous pouvez réécrire l'histoire. Voici une façon sournoise d'abuser de cela, je ne peux pas penser à une raison légitime de le faire.","date":"2019-05-08T09:00:00.000Z","tags":["Git","Bash"],"draft":false,"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAeRAQwf/xAAbEAACAQUAAAAAAAAAAAAAAAAAARECAxIhIv/aAAgBAQABBQK4RoVULPk//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRAAAwADAAAAAAAAAAAAAAAAARARADFx/9oACAEBAAY/AhxzYyARf//EABoQAQADAQEBAAAAAAAAAAAAAAEAETEhURD/2gAIAQEAAT8hNcYxUx2WkWwHgzQ4d9+f/9oADAMBAAIAAwAAABAbL//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAQEBAAIDAQAAAAAAAAAAAAERAFGBITFBcf/aAAgBAQABPxCBiAjqt5bfRjwIPWQXOcH4/NAocqqu3LFob//Z","aspectRatio":1.4981273408239701,"src":"/static/84ded7f830441f1151fac27920347fb2/883ab/infinity.jpg","srcSet":"/static/84ded7f830441f1151fac27920347fb2/f8f18/infinity.jpg 930w,\n/static/84ded7f830441f1151fac27920347fb2/0e6ff/infinity.jpg 1860w,\n/static/84ded7f830441f1151fac27920347fb2/883ab/infinity.jpg 2000w","sizes":"(max-width: 2000px) 100vw, 2000px"}}},"author":{"id":"ludo","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"src":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png"}}]}}},"excerpt":"Une des choses les plus grandes et les pires avec git est que vous pouvez réécrire l’histoire. Voici une façon sournoise d’abuser de cela, je ne peux pas penser à une raison légitime de le faire. Comme pour tout, merci StackOverflow pour toutes les options que je peux choisir parmi Fixe la date du dernier commit à la date du jour Fixer la date du dernier commit à une date arbitraire Définir la date d’une validation arbitraire sur une date arbitraire ou courante Rebaser avant ledit engagement et arrêter pour modification: git rebase <commit-hash>^ -i Remplace pick par e (edit) sur la ligne avec ce commit (le premier) Quittez l’éditeur (ESC suivi de :wq dans VIM) Non plus: GIT_COMMITTER_DATE=\"$(date)\" git commit --amend --no-edit --date \"$(date)\" GIT_COMMITTER_DATE=\"Mon 20 Aug 2018 20:19:19 BST\" git commit --amend --no-edit --date \"Mon 20 Aug 2018 20:19:19 BST\" Voir ici pour plus d’informations sur le rebase et l’édition dans git: Fractionner un commit git existant. Après l’une de ces 3 options, vous voudrez exécuter:","fields":{"layout":"post","slug":"/git-changeGitOfCommit/"}}},{"node":{"timeToRead":1,"frontmatter":{"title":"Fractionner un commit existant","subtitle":"Une des choses les plus grandes et les pires avec git est que vous pouvez réécrire l'histoire. Voici une façon sournoise d'abuser de cela, je ne peux pas penser à une raison légitime de le faire.","date":"2019-05-08T08:00:00.000Z","tags":["Git","Bash"],"draft":false,"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHLd3SQoD//xAAZEAACAwEAAAAAAAAAAAAAAAAAAgESIQP/2gAIAQEAAQUCVNnmSpGFmLMf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRABAAIDAAAAAAAAAAAAAAAAACExATJB/9oACAEBAAY/ApdQttlb/8QAHBABAAICAwEAAAAAAAAAAAAAAQARITFBYYGx/9oACAEBAAE/IaOHqJg+Io5YgtYrlm09iTvP/9oADAMBAAIAAwAAABDT7//EABYRAQEBAAAAAAAAAAAAAAAAAAABEf/aAAgBAwEBPxCRj//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAQEBAAIDAQAAAAAAAAAAAAERACFBMVFhgf/aAAgBAQABPxAQhQtQietJZHLenHejKfTMgmjscy8F4tZAB/u//9k=","aspectRatio":1.6246953696181965,"src":"/static/6367e3250bf5dd6b3387bdab9a38b098/883ab/lumberjack.jpg","srcSet":"/static/6367e3250bf5dd6b3387bdab9a38b098/f8f18/lumberjack.jpg 930w,\n/static/6367e3250bf5dd6b3387bdab9a38b098/0e6ff/lumberjack.jpg 1860w,\n/static/6367e3250bf5dd6b3387bdab9a38b098/883ab/lumberjack.jpg 2000w","sizes":"(max-width: 2000px) 100vw, 2000px"}}},"author":{"id":"ludo","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"src":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png"}}]}}},"excerpt":"L’une des principales différences entre git et les autres systèmes de contrôle de version est qu’il permet à l’utilisateur de réécrire l’historique. Pour ce faire, le moyen principal consiste à utiliser git rebase, généralement suivi d’un git push --force pour écraser l’historique du serveur (remote) avec l’historique local. Voici comment diviser les commits existants à l’aide de rebase, reset et commit. Supposons que vous ayez deux fichiers édités dans un commit (A et B) et que vous souhaitiez importer les modifications d’un de ces fichiers (A) dans votre branche actuelle, mais pas celles de l’autre (B). Utiliser git cherry-pick <commit-hash> n’est pas une option, car cela impliquerait les modifications pour A et B. La solution consiste à scinder le commit en 2 et à ne sélectionner que le nouveau commit contenant les modifications pour A. Pour faire ça:  lancez git rebase -i <commit-hash>~ (notez le -) ou git rebase -i <hash-of-previous-commit> recherchez le commit que vous voulez scinder dans l’écran d’édition du rebase, changez le pick en e (edit) sauvegardez et quittez (ESC suivi de :wq pour fermer VIM) git reset HEAD~ pour réinitialiser les modifications planifiées (stash) git add [files-to-add] tous les fichiers que nous voulons ajouter au premier commit (ici, ce serait git add A) git commit normalement, avec un message, etc. Exécutez autant de fois que vous le souhaitez: git add [other-files-to-add] git commit git rebase -- continue d’indiquer que la division est terminée et continue la refonte  Enfin, nous pouvons git cherry-pick <new-commit-hash> pour intégrer les modifications dans notre branche.","fields":{"layout":"post","slug":"/git-splitExistingCommit/"}}}]}},"pageContext":{"isCreatedByStatefulCreatePages":false,"limit":9,"skip":0,"numPages":4,"currentPage":1}}}