{"componentChunkName":"component---src-templates-post-tsx","path":"/angular-dynamic-environment/","result":{"data":{"logo":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABFUlEQVQY023PvUrDUBTA8ZuCtoMoOLQ4dWhN14x2kEKXFkGoohQ/QBexOHRycAidKkgHHRq69APRoTjFJYODIA6+gSBYfYMmfYLE/5VT6NALP845NyeHc9UoCHZRQvonCLKKE4ZhAXYURTsYoE9dIy5iCzfUJnEdV+RF4iu6ikFH2EPxazzOcJmg4Rnn5C8ysIEOHqTe5/sT3qXOwYOtRr5/wLAqzpCTDXu4p2ETtyjgGJ/cX+se8jeU9fa4RBt5vWENpjzdkoGPcGg4RQsbOMEFmnBRRwVDHEK/yFXfvr/CoPjvZLKcdByDyzWGeajigzorGy0oOeRJiUtITe/pX1XzDk3buIMltSFR/zTtic3060X+8z8PsEUt8G3LVQAAAABJRU5ErkJggg==","width":400,"height":128,"src":"/static/2b5eaa0de166a8b5faebad4955c2200c/c0bbd/ghost-logo.png","srcSet":"/static/2b5eaa0de166a8b5faebad4955c2200c/c0bbd/ghost-logo.png 1x"}}},"markdownRemark":{"html":"<p>Dans les applications m√©tiers, nous rencontrons souvent une configuration de livraison continue comportant plusieurs stages. Chaque √©tape a sa configuration pour acc√©der aux syst√®mes p√©riph√©riques sp√©cifiques √† l‚Äôenvironnement. Pour ce faire, nous devons g√©rer les configurations bas√©es sur les stages.</p>\n<p>Angular CLI est livr√© avec certains concepts int√©gr√©s permettant de g√©rer diff√©rents environnements.</p>\n<p>Mais quelle est leur fiabilit√© dans un environnement de livraison continu ? ü§î</p>\n<h2>Livraison continue - une courte introduction</h2>\n<p>La livraison continue r√©sulte du mouvement agile. La r√©troaction it√©rative est √† la base. Il est essentiel d‚Äôapprendre des exp√©riences pratiques et d‚Äôint√©grer ces commentaires.</p>\n<p>La livraison continue prend des id√©es agiles et d√©finit une approche pour livrer des logiciels test√©s automatiquement dans des cycles courts.</p>\n<blockquote>\n<p>La diffusion continue consiste √† cr√©er un pipeline pour automatiser le processus de publication du logiciel</p>\n</blockquote>\n<h2>√âtapes de livraison continue</h2>\n<p>Un sch√©ma typique dans la livraison continue est le <em>steging</em>. Dans une configuration de livraison continue typique, nous avons diff√©rents stages avec des objectifs diff√©rents.\nChaque validation entra√Æne une ex√©cution du pipeline sur notre serveur CI. Les ex√©cutions r√©ussies sur la branche <code>master</code> entra√Ænent un d√©ploiement sur l‚Äôun de nos stages.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1000px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/13c78901660c3a1ee09b0f1d126463e2/c0a24/continuous-deployment.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAACM0lEQVQoz41Ty27TQBS1+BV+hb9gyZIFX9AVG8QXFLHogkWlImVXJCgooikNIYQmcRInsePHeDx+x287fozDddNGgpaHNbKu7txz7rmPYbb/8dV1XZRlXW/Lsko3ebbJwQA/czcO/hDaZRfIsHdOCE2yjaBiP4qQbo95CfCU1r+DKSTJC8VeP3xzctDpbeutHyd5UWNrdfD68SX7LozLMS9WFa0oZeprAMCAW7fXimE5a59VyYPDoyfv2zTLJd0KohyZ3MmXR4PlW9cvWEEqq6oB76VKWJ8KSpSkjc6qaqvayvObW2CndRCHPO7ZniYTey6pUZIBivGiTZjkYMmGB0E75fWvtYAobLo1bWw/ih0/hLwQw7Dc1dPnL047/ePW8bOXh1le7LRU1xSa6QiIYMsBLeDf5IVmu3tyRhY6n85bIjbap6+6o4lMLBHrXhiZrqc7awMaECWgJYgTkDoTVXCGSRrE6T2jgiGNltLFcAbaojQDCsDziHC8hDDpDqdXs4WqkdGcz4uSadpBG420af5NvQtZO/s6XCoa0i3L9cM4lTRDt90fHL+QVKhFISbddfvOntw0CRICRjVsoFghTUC4Mxj3xpyEyVJWoQvMvftIb/dsCiDTBbyMiYLJxYDtDifEsFYyKco/gPfDB8kzEblBKGFDJuY3dsGtVIHgFvdhYLLM397DrcGJaCnK5/3h2eX3j91BfzL7PO/Lnsb88z014y0KzXJU00aGBQebtuUEcPUTlGpFB9V0AEcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/13c78901660c3a1ee09b0f1d126463e2/14b47/continuous-deployment.webp 293w,\n/static/13c78901660c3a1ee09b0f1d126463e2/91928/continuous-deployment.webp 585w,\n/static/13c78901660c3a1ee09b0f1d126463e2/e00f7/continuous-deployment.webp 1000w\"\n          sizes=\"(max-width: 1000px) 100vw, 1000px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/13c78901660c3a1ee09b0f1d126463e2/b6dd9/continuous-deployment.png 293w,\n/static/13c78901660c3a1ee09b0f1d126463e2/037e5/continuous-deployment.png 585w,\n/static/13c78901660c3a1ee09b0f1d126463e2/c0a24/continuous-deployment.png 1000w\"\n          sizes=\"(max-width: 1000px) 100vw, 1000px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/13c78901660c3a1ee09b0f1d126463e2/c0a24/continuous-deployment.png\"\n          alt=\"Continuous Deployment\"\n          title=\"Continuous Deployment\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>Dans l‚Äôexemple ci-dessus, la phase de <code>test</code> contient une snapshot de la branche <code>master</code>. √Ä certains intervalles, par exemple, apr√®s chaque sprint, nous pouvons d√©ployer au stade interm√©diaire (<code>staging</code>). C‚Äôest √† ce stade que les tests de r√©ception finaux sont effectu√©s. Une fois accept√©, l‚Äôartefact est d√©plac√© en production.</p>\n<p>Bien s√ªr, certaines entreprises ont un temps de production plus rapide. Certains d√©ploient m√™me chaque commit directement en production.</p>\n<p>Mais dans la plupart des applications li√©es aux entreprises, il est bon d‚Äôavoir une √©tape avant la production. Cela permet √† nos <em>product owners</em>, repr√©sentants commerciaux et testeurs d‚Äôavoir un dernier aper√ßu et de v√©rifier la logique m√©tier.</p>\n<h2>Build une fois - d√©ployer partout</h2>\n<p>Il est essentiel de ne construire votre artefact qu‚Äôune seule fois et de le d√©placer d‚Äôune √©tape √† l‚Äôautre.\nCette approche garantit que le m√™me artefact qui a √©t√© test√© entre √©galement en production.</p>\n<h2>Les environnements Angular et livraison continue, sont-il adapt√© ? ü§î</h2>\n<p>Angular CLI est livr√©e avec un m√©canisme int√©gr√© de fichier d‚Äôenvironnement. Voyons comment ils fonctionnent.</p>\n<p>Lors de la g√©n√©ration d‚Äôun tout nouveau projet, il existe un <code>environment.ts</code>et un <code>envrironment.prod.ts</code>. De plus, nous pouvons toujours ajouter √† ces fichiers de nouveaux fichiers d‚Äôenvironnement dans le dossier <code>environment</code> et les configurer dans votre fichier <code>angular.json</code>.</p>\n<p>Pendant le build, l‚Äôenvironnement souhait√© est ensuite transmis en tant qu‚Äôargument √† la commande de build. Le CLI utilise ensuite le fichier d‚Äôenvironnement correct et remplace le fichier par d√©faut pendant le build, que nous pouvons ensuite importer avec la ligne suivante</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>environment<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../environments/environment'</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Maintenant que nous connaissons le concept int√©gr√© de la CLI angulaire. Voyons en quoi cela correspond aux principes de la livraison continue.</p>\n<p>Il est donc essentiel de noter que Angular CLI d√©finit l‚Äôenvironnement pendant la construction. Cela signifie que nous devons cr√©er notre application avant chaque d√©ploiement sur une √©tape sp√©cifique.</p>\n<p>Cette approche comporte quelques risques.</p>\n<p>Si vous cr√©ez votre application √† chaque fois avant de d√©ployer, il se peut que l‚Äôartefact que vous avez test√© ne soit pas le m√™me que celui qui entre en production.</p>\n<blockquote>\n<p>Il est important de r√©aliser qu‚Äôun processus de build n‚Äôest pas toujours d√©terministe. M√™me si le m√™me code entre dans la construction, il n‚Äôest pas garanti que le m√™me artefact sortira.</p>\n</blockquote>\n<p>L‚Äôartefact ne d√©pend pas seulement de votre code, il d√©pend √©galement des biblioth√®ques tierces, des mises √† jour du syst√®me d‚Äôexploitation ou d‚Äôautres modifications de l‚Äôenvironnement qui se produisent avec le temps.</p>\n<p>Rappelez-vous √† l‚Äô√©poque o√π nous avions un <code>package.lock.json</code>. √Ä l‚Äô√©poque, les builds √©taient encore moins pr√©dictives. Les biblioth√®ques tierces apparaissent souvent avec un <code>^</code> dans notre <code>package.json</code>. Malgr√© <code>semver</code>, les nouvelles versions d‚Äôune biblioth√®que tierce produisaient parfois une incompatibilit√© avec une autre d√©pendance qui entra√Ænait la rupture de votre application.</p>\n<blockquote>\n<p>Plus vous pouvez maintenir la coh√©rence entre les d√©ploiements, plus le d√©ploiement en production est susceptible de se d√©rouler sans heurts.</p>\n</blockquote>\n<p><strong>La livraison continue et les fichiers d‚Äôenvironnement fournis par Angular CLI ne conviennent pas!</strong></p>\n<p><strong>Dans la livraison continue, votre artefact doit obtenir des configurations sp√©cifiques √† l‚Äôenvironnement au d√©marrage ou √† l‚Äôex√©cution. Angular CLI, en revanche, obtient ces configurations au moment du build.</strong></p>\n<p>Alors, comment combiner les id√©es de la livraison continue avec notre application angulaire?</p>\n<p>Il existe diff√©rentes approches pour combiner les id√©es de livraison continue avec Angular CLI. Chacun comporte des avantages et des inconv√©nients.</p>\n<p>Regardons-les.</p>\n<h2>Configurer l‚Äôh√¥te comme assets - Monter les fichiers de configuration par environnement</h2>\n<p>Au lieu d‚Äôextraire la configuration sur un endpoint REST, nous extrayons directement un fichier JSON avec des configurations situ√©es dans notre dossier <code>assets</code>.</p>\n<p>Nous allons donc cr√©er un dossier de <code>config</code> √† l‚Äôint√©rieur <code>assets</code> et y placer un <code>JSON</code> contenant les configurations sp√©cifiques √† l‚Äôenvironnement local.</p>\n<p>Mais comment charge-t-on le fichier <code>configuration.json</code>? Au travers d‚Äôun service au travers duquel nous r√©cup√©rons le fichier √† partir du dossier <code>assets</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>Injectable<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/core'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>HttpClient<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/common/http'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>Observable<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'rxjs'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>shareReplay<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'rxjs/operators'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">Configuration</span> <span class=\"token punctuation\">{</span>\n  resourceServerA<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  resourceServerB<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  stage<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n@<span class=\"token function\">Injectable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>providedIn<span class=\"token punctuation\">:</span> <span class=\"token string\">'root'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ConfigAssetLoaderService</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> <span class=\"token constant\">CONFIG_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">'assets/config/config.json'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> configuration$<span class=\"token punctuation\">:</span> Observable<span class=\"token operator\">&lt;</span>Configuration<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token keyword\">private</span> http<span class=\"token punctuation\">:</span> HttpClient</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">loadConfigurations</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">any</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>configuration$<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>configuration$ <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>http<span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token operator\">&lt;</span>Configuration<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token constant\">CONFIG_URL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>\n        <span class=\"token function\">shareReplay</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>configuration$<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code>ConfigurationAssetsLoaderService</code> charge maintenant notre fichier <code>assets/config/config.json</code> qui contient toutes les configurations. Mais comment pouvons-nous changer ces configurations par rapport √† l‚Äôenvironnement actuel dans lequel nous nous trouvons?</p>\n<p>Nous allons simplement h√©berger notre configuration sur chaque √©tape, puis monter le fichier <code>configuration.json</code> dans le dossier <code>assets</code>. Lorsque votre pod d√©marre, nous montons votre configuration dans le r√©pertoire <code>assets/config</code>.</p>\n<p>Il est important de noter que vous cr√©ez un dossier <code>config</code> √† l‚Äôint√©rieur du dossier <code>assets</code>. Nous ne pouvons pas utiliser une hi√©rarchie √† plat. Lors du montage, tous les fichiers du dossier mont√© sont supprim√©s.</p>\n<p>La mani√®re concr√®te de monter des volumes d√©pend de votre outil de CI. Sur mon projet, nous utilisons Kubernetes pour nos d√©ploiements. Kubernetes nous fournit des <code>ConfigMaps</code> qui peuvent √™tre une propri√©t√© ou m√™me un fichier de configuration complet. Donc, sur Kubernetes, nous avons diff√©rents stages. Chaque stage h√©berge ensuite des configurations sp√©cifiques et les monte dans notre dossier <code>assets/config</code> au d√©marrage du pod.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">volumeMounts</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">mountPath</span><span class=\"token punctuation\">:</span> /usr/share/nginx/html/assets/config\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> yourVolumeName</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Nous avons maintenant vu deux approches dont la mise en oeuvre c√¥t√© client est tr√®s similaire. Nous avons cr√©√© un service qui r√©cup√®re les configurations √† partir d‚Äôun endpoint REST ou du dossier <code>assets</code>.</p>\n<p>Nous avons donc vu deux mani√®res d‚Äôutiliser un service pour acc√©der √† des configurations. Mais quand appelons-nous ces services?</p>\n<p>Eh bien, r√©ponse courte, c‚Äôest √† vous de voir. Il y a des moments diff√©rents o√π il est logique de les appeler. Chacun vient avec des avantages et des inconv√©nients.</p>\n<h2>Remplacer les configurations par environnement</h2>\n<p>Dans cet exemple, nous utilisons les fichiers d‚Äôenvironnement Angular tels quels. Un <code>environment.ts</code>et un <code>environment.prod.ts</code>.</p>\n<p>M√™me si nous avons plus de stages que la production et le d√©veloppement, nous distinguons seulement ces deux-l√†. Pour le d√©veloppement local, nous utilisons le fichier <code>environment.ts</code>. Tous les autres stages sont g√©r√©s par <code>environment.prod.ts</code>.</p>\n<p>Mais comment ?</p>\n<p>Notre <code>environment.prod.ts</code> ne contient pas les valeurs r√©elles; il contient des valeurs d‚Äôespace r√©serv√© qui seront √©cras√©es √† chaque √©tape par un script de construction.</p>\n<p>Un exemple de fichier <code>environment.prod.ts</code> pourrait ressembler √† ceci:</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> environment <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  resourceServerA<span class=\"token punctuation\">:</span> <span class=\"token string\">'REPLACED_BY_BUILD_RESOURCEA'</span><span class=\"token punctuation\">,</span>\n  resourceServerB<span class=\"token punctuation\">:</span> <span class=\"token string\">'REPLACED_BY_BUILD_RESOURCEB'</span><span class=\"token punctuation\">,</span>\n  stage<span class=\"token punctuation\">:</span> <span class=\"token string\">'REPLACED_BY_BUILD_STAGE'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Lorsque nous d√©marrons notre serveur Web, nous pouvons ensuite utiliser un script <code>start.sh</code> qui remplacera les espaces r√©serv√©s.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/sh</span>\n\n<span class=\"token comment\"># replace static values with environment-variables</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> -n <span class=\"token string\">\"<span class=\"token variable\">$RESOURCEA</span>\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n  <span class=\"token function\">sed</span> -i <span class=\"token string\">\"s#REPLACED_BY_BUILD_RESOURCEA#<span class=\"token variable\">$AUTHSERVER_URL</span>#g\"</span> /usr/share/nginx/html/main.*.bundle.js\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token comment\"># start webserver</span>\n<span class=\"token builtin class-name\">exec</span> nginx</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Nous ex√©cutons ensuite ce script au d√©marrage. Par exemple, dans notre fichier Docker.</p>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-dockerfile line-numbers\"><code class=\"language-dockerfile\"><span class=\"token comment\"># Dockerfile</span>\n<span class=\"token punctuation\">...</span>\n<span class=\"token comment\"># Start nginx via script, which replaces static urls with environment variables</span>\n<span class=\"token keyword\">ADD</span> start.sh /usr/share/nginx/start.sh\n<span class=\"token keyword\">RUN</span> chmod +x /usr/share/nginx/start.sh\n<span class=\"token keyword\">CMD</span> /usr/share/nginx/start.sh</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Cette approche, du moins pour moi, est un peu ‚Äúhacky‚Äù. Remplacer des cha√Ænes dans un paquet n‚Äôest probablement pas le moyen le plus agr√©able. Il comporte en outre le risque de remplacer quelque chose qui ne devrait pas √™tre remplac√©.</p>\n<p>Si vous d√©cidez quand m√™me d‚Äôutiliser cette approche, il est extr√™mement important d‚Äôavoir de bons espaces r√©serv√©s. Utilisez des caract√®res sp√©ciaux que vous n‚Äôutilisez g√©n√©ralement pas dans les noms de variables.</p>\n<h2>Conclusion</h2>\n<p>Angular est livr√© avec des fichiers d‚Äôenvironnement qui nous permettent de g√©rer des configurations sp√©cifiques √† l‚Äôenvironnement. Ils ne r√©pondent pas aux exigences d‚Äôune configuration de livraison continue.</p>\n<p>Les fichiers d‚Äôenvironnement Angular sont utilis√©s pendant la phase de build. En mode de livraison continue, il est essentiel de d√©ployer le m√™me artefact √† diff√©rents stages. Par cons√©quent, nous devons transmettre les configurations d‚Äôenvironnement au d√©marrage ou √† l‚Äôex√©cution.</p>\n<p>En fonction de votre configuration, nous pouvons charger des configurations via un service. Soit directement √† partir d‚Äôun backend ou de notre dossier d‚Äôactifs.</p>\n<p>Il est donc recommand√© de les mettre en cache.</p>\n<hr>\n<p>Un des gros d√©fauts de la fa√ßon dont Angular CLI traite les environnements, dans la culture DevOps c‚Äôest mieux de <strong>build une seule fois et de d√©ployer sur plusieurs environnements</strong>, hors Angular CLI veut que vous cr√©er un buildnpm s√©par√© par environnement.</p>\n<p>Pourquoi devriez-vous build une seule fois et r√©utiliser cette version dans tous les environnements?</p>\n<p>La raison pour laquelle vous ne souhaitez pas cr√©er une version distincte pour chaque environnement est la suivante:</p>\n<ol>\n<li>Cela ralentit les pipelines d‚Äôint√©gration continue (CI), car il doit cr√©er un build pour chaque environnement.</li>\n<li>Cela augmente le risque d‚Äôerreurs / de diff√©rences dans diff√©rents environnements, car les versions sont s√©par√©es</li>\n<li>Il ajoute des informations inutiles sur d‚Äôautres environnements dans le code</li>\n<li>Pour des raisons de s√©curit√©, vous pourriez ne pas vouloir afficher d‚Äôinformations confidentielles dans la configuration de l‚Äôenvironnement, qui est enregistr√©e dans Git.</li>\n</ol>\n<p>Tous ces probl√®mes me font me demander pourquoi <strong>Angular CLI opte pour une version par environnement</strong>. Je voulais bien s√ªr une solution √† ces probl√®mes.</p>\n<p>Comment ces probl√®mes sont-ils r√©solus ?</p>\n<p>En faisant en sorte que le serveur de d√©ploiement <strong>substitue un fichier config.json, charg√© au moment de l‚Äôex√©cution</strong> par l‚Äôapplication.</p>\n<h2>Faire en sorte qu‚Äôune application Angular utilise des configurations dynamiques</h2>\n<p>Nous voulons que l‚Äôapplication Angular ne comporte que deux fichiers d‚Äôenvironnement: <code>environment.ts</code> et <code>environment.prod.ts</code>.</p>\n<p>Pourquoi deux environnements, vous pouvez demander? Un pour les d√©veloppeurs locaux, o√π vous pouvez mettre ce que vous voulez pour servir localement et un autre pour cr√©er l‚Äôapplication. Ces fichiers d‚Äôenvironnement tirent l‚Äôessentiel de ses valeurs d‚Äôun fichier <code>app-config.json</code> charg√© lors de l‚Äôex√©cution, contrairement √† la codification en dur de toutes les informations sur l‚Äôenvironnement dans les fichiers d‚Äôenvironnement.</p>\n<h2>Cr√©er une nouvelle application Angular</h2>\n<p>La premi√®re √©tape consiste √† cr√©er une nouvelle application Angular en ouvrant le terminal, acc√©der au r√©pertoire souhait√© pour l‚Äôapplication et taper:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">ng new dynamic-config-demo</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Et cela devrait cr√©er une nouvelle application Angular pour vous.</p>\n<h2>Chargement du fichier config.json au d√©marrage</h2>\n<p>Toute la configuration de l‚Äôenvironnement va √™tre stock√©e dans un fichier <code>app-config.json</code> utilis√© par le fichier <code>environment.ts</code> pour r√©f√©rencer ces valeurs en toute s√©curit√©.</p>\n<p>Nous cr√©ons simplement un fichier JSON vide dans le dossier <code>assets</code> appel√© <code>app-config.json</code>.</p>\n<p>L‚Äô√©tape suivante consiste √† <strong>charger le fichier config.json</strong> √† l‚Äôaide d‚Äôun service d‚Äôinitialisation <code>app.init.ts</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Injectable <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/core'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">from</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'rxjs'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> filter<span class=\"token punctuation\">,</span> map<span class=\"token punctuation\">,</span> switchMap<span class=\"token punctuation\">,</span> tap <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'rxjs/operators'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">declare</span> <span class=\"token keyword\">var</span> window<span class=\"token punctuation\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">;</span>\n\n@<span class=\"token function\">Injectable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AppInitService</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// This is the method you want to call at bootstrap</span>\n  <span class=\"token comment\">// Important: It should return a Promise</span>\n  <span class=\"token keyword\">public</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">from</span><span class=\"token punctuation\">(</span>\n        <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'assets/app-config.json'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>\n        <span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">config</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        window<span class=\"token punctuation\">.</span>config <span class=\"token operator\">=</span> config<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toPromise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Ce service s‚Äôex√©cutera au d√©marrage et garantira que la configuration de l‚Äôapplication est r√©cup√©r√©e en utilisant <code>fetch</code> pour obtenir le fichier de configuration, puis enregistrez-le dans <code>window</code> pour le rendre globalement disponible pour l‚Äôapplication. Notez que lorsque vous utilisez <code>fetch</code>, vous aurez peut-√™tre besoin de polyfills pour la prise en charge du navigateur IE.</p>\n<p>Le service d‚Äôinitialisation d‚Äôapplication est configur√© dans le module <code>app.module</code> comme suit:</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">init_app</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">appLoadService<span class=\"token punctuation\">:</span> AppInitService</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> appLoadService<span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n@<span class=\"token function\">NgModule</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  declarations<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>AppComponent<span class=\"token punctuation\">,</span> ComponentAComponent<span class=\"token punctuation\">,</span> ComponentBComponent<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  imports<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>BrowserModule<span class=\"token punctuation\">,</span> CoreModule<span class=\"token punctuation\">,</span> HttpClientModule<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  providers<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    AppInitService<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      provide<span class=\"token punctuation\">:</span> <span class=\"token constant\">APP_INITIALIZER</span><span class=\"token punctuation\">,</span>\n      useFactory<span class=\"token punctuation\">:</span> init_app<span class=\"token punctuation\">,</span>\n      deps<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>AppInitService<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      multi<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  bootstrap<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>AppComponent<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AppModule</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>L‚Äôutilisation d‚Äôun service d‚Äôinitialisation d‚Äôapplication cr√©e un l√©ger retard sur le temps de d√©marrage de l‚Äôapplication, mais des √©l√©ments simples comme celui-ci n‚Äôauront pas d‚Äôimpact consid√©rable sur le temps de d√©marrage. N√©anmoins, je vous recommande d‚Äôindiquer √† vos utilisateurs d‚Äôattendre avec une spinner de chargement.</p>\n<h2>Faire en sorte que les fichiers d‚Äôenvironnement utilisent des valeurs dynamiques</h2>\n<p>Maintenant que nous chargeons le JSON de configuration de mani√®re dynamique et que nous les enregistrons dans <code>window</code>, nous voulons pouvoir les r√©f√©rencer en toute s√©curit√©. Pour ce faire, nous devrions avoir trois fichiers d‚Äôenvironnement: <code>environment</code>, <code>environment.prod</code> et <code>dynamic-environment</code>.</p>\n<p><code>environment</code> est destin√© √† √™tre utilis√© localement, <code>environment.prod</code> est destin√© √† la production et <code>dynamic-environment</code> est partag√© avec <code>environment</code> et <code>environment.prod</code> afin de fournir une configuration dynamique.</p>\n<p><code>dynamic-environment</code> ressemble √† ceci:</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">declare</span> <span class=\"token keyword\">var</span> window<span class=\"token punctuation\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">DynamicEnvironment</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">get</span> <span class=\"token function\">environment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> window<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">.</span>environment<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Ceci est utilis√© dans <code>environnement</code> comme celui-ci:</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> DynamicEnvironment <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./dynamic-environment'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Environment</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">DynamicEnvironment</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">public</span> production<span class=\"token punctuation\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>production <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> environment <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Environment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Vous pouvez trouver une d√©monstration compl√®te d‚Äôune application angulaire √† configuration dynamique sur mon Github ici.</p>\n<h2>Substitution du fichier config.json sur le serveur de d√©ploiement</h2>\n<p>Maintenant que nous avons configur√© l‚Äôapplication pour la configuration dynamique, la prochaine √©tape consiste √† configurer le remplacement du fichier de configuration sur le serveur de d√©ploiement.</p>\n<p>Vous pouvez faire cela en utilisant <strong>Octopus</strong>, qui a une fonction intelligente pour <strong>remplacer un fichier JSON</strong> par des valeurs de configuration pour l‚Äôenvironnement. Les autres serveurs de d√©ploiement devraient avoir des fonctionnalit√©s similaires pour substituer un fichier JSON juste avant de d√©ployer l‚Äôapplication sur le serveur frontal.</p>\n<h2>Conclusion</h2>\n<p>Nous avons discut√© des probl√®mes pos√©s par la m√©thode de ‚ÄúAngular CLI‚Äù pour g√©rer la configuration de l‚Äôenvironnement avec <strong>un build par environnement</strong>. Nous avons √©galement cherch√© √† d√©terminer l‚Äôint√©r√™t de <strong>build une version √† la fois</strong>. Nous avons examin√© comment impl√©menter cela √† l‚Äôaide d‚Äôun service app.init qui chargeait un fichier de configuration dynamique lors de l‚Äôinitialisation, avec des valeurs d√©finies par le serveur de d√©ploiement.</p>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Dans les applications m√©tiers, nous rencontrons souvent une configuration de livraison continue comportant plusieurs stages. Chaque √©tape a sa configuration pour acc√©der aux syst√®mes p√©riph√©riques sp√©cifiques √† l‚Äôenvironnement. Pour ce faire, nous devons g√©rer les configurations bas√©es sur les stages."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Angular CLI est livr√© avec certains concepts int√©gr√©s permettant de g√©rer diff√©rents environnements."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Mais quelle est leur fiabilit√© dans un environnement de livraison continu ? ü§î"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Livraison continue - une courte introduction"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"La livraison continue r√©sulte du mouvement agile. La r√©troaction it√©rative est √† la base. Il est essentiel d‚Äôapprendre des exp√©riences pratiques et d‚Äôint√©grer ces commentaires."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"La livraison continue prend des id√©es agiles et d√©finit une approche pour livrer des logiciels test√©s automatiquement dans des cycles courts."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"La diffusion continue consiste √† cr√©er un pipeline pour automatiser le processus de publication du logiciel"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"√âtapes de livraison continue"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Un sch√©ma typique dans la livraison continue est le "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"steging"}]},{"type":"text","value":". Dans une configuration de livraison continue typique, nous avons diff√©rents stages avec des objectifs diff√©rents.\nChaque validation entra√Æne une ex√©cution du pipeline sur notre serveur CI. Les ex√©cutions r√©ussies sur la branche "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"master"}]},{"type":"text","value":" entra√Ænent un d√©ploiement sur l‚Äôun de nos stages."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1000px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/13c78901660c3a1ee09b0f1d126463e2/c0a24/continuous-deployment.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 74%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAACM0lEQVQoz41Ty27TQBS1+BV+hb9gyZIFX9AVG8QXFLHogkWlImVXJCgooikNIYQmcRInsePHeDx+x287fozDddNGgpaHNbKu7txz7rmPYbb/8dV1XZRlXW/Lsko3ebbJwQA/czcO/hDaZRfIsHdOCE2yjaBiP4qQbo95CfCU1r+DKSTJC8VeP3xzctDpbeutHyd5UWNrdfD68SX7LozLMS9WFa0oZeprAMCAW7fXimE5a59VyYPDoyfv2zTLJd0KohyZ3MmXR4PlW9cvWEEqq6oB76VKWJ8KSpSkjc6qaqvayvObW2CndRCHPO7ZniYTey6pUZIBivGiTZjkYMmGB0E75fWvtYAobLo1bWw/ih0/hLwQw7Dc1dPnL047/ePW8bOXh1le7LRU1xSa6QiIYMsBLeDf5IVmu3tyRhY6n85bIjbap6+6o4lMLBHrXhiZrqc7awMaECWgJYgTkDoTVXCGSRrE6T2jgiGNltLFcAbaojQDCsDziHC8hDDpDqdXs4WqkdGcz4uSadpBG420af5NvQtZO/s6XCoa0i3L9cM4lTRDt90fHL+QVKhFISbddfvOntw0CRICRjVsoFghTUC4Mxj3xpyEyVJWoQvMvftIb/dsCiDTBbyMiYLJxYDtDifEsFYyKco/gPfDB8kzEblBKGFDJuY3dsGtVIHgFvdhYLLM397DrcGJaCnK5/3h2eX3j91BfzL7PO/Lnsb88z014y0KzXJU00aGBQebtuUEcPUTlGpFB9V0AEcAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"picture","properties":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/13c78901660c3a1ee09b0f1d126463e2/14b47/continuous-deployment.webp 293w","/static/13c78901660c3a1ee09b0f1d126463e2/91928/continuous-deployment.webp 585w","/static/13c78901660c3a1ee09b0f1d126463e2/e00f7/continuous-deployment.webp 1000w"],"sizes":["(max-width:","1000px)","100vw,","1000px"],"type":"image/webp"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/13c78901660c3a1ee09b0f1d126463e2/b6dd9/continuous-deployment.png 293w","/static/13c78901660c3a1ee09b0f1d126463e2/037e5/continuous-deployment.png 585w","/static/13c78901660c3a1ee09b0f1d126463e2/c0a24/continuous-deployment.png 1000w"],"sizes":["(max-width:","1000px)","100vw,","1000px"],"type":"image/png"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"src":"/static/13c78901660c3a1ee09b0f1d126463e2/c0a24/continuous-deployment.png","alt":"Continuous Deployment","title":"Continuous Deployment","loading":"lazy"},"children":[]},{"type":"text","value":"\n      "}]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Dans l‚Äôexemple ci-dessus, la phase de "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"test"}]},{"type":"text","value":" contient une snapshot de la branche "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"master"}]},{"type":"text","value":". √Ä certains intervalles, par exemple, apr√®s chaque sprint, nous pouvons d√©ployer au stade interm√©diaire ("},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"staging"}]},{"type":"text","value":"). C‚Äôest √† ce stade que les tests de r√©ception finaux sont effectu√©s. Une fois accept√©, l‚Äôartefact est d√©plac√© en production."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Bien s√ªr, certaines entreprises ont un temps de production plus rapide. Certains d√©ploient m√™me chaque commit directement en production."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Mais dans la plupart des applications li√©es aux entreprises, il est bon d‚Äôavoir une √©tape avant la production. Cela permet √† nos "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"product owners"}]},{"type":"text","value":", repr√©sentants commerciaux et testeurs d‚Äôavoir un dernier aper√ßu et de v√©rifier la logique m√©tier."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Build une fois - d√©ployer partout"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Il est essentiel de ne construire votre artefact qu‚Äôune seule fois et de le d√©placer d‚Äôune √©tape √† l‚Äôautre.\nCette approche garantit que le m√™me artefact qui a √©t√© test√© entre √©galement en production."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Les environnements Angular et livraison continue, sont-il adapt√© ? ü§î"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Angular CLI est livr√©e avec un m√©canisme int√©gr√© de fichier d‚Äôenvironnement. Voyons comment ils fonctionnent."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Lors de la g√©n√©ration d‚Äôun tout nouveau projet, il existe un "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"environment.ts"}]},{"type":"text","value":"et un "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"envrironment.prod.ts"}]},{"type":"text","value":". De plus, nous pouvons toujours ajouter √† ces fichiers de nouveaux fichiers d‚Äôenvironnement dans le dossier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":" et les configurer dans votre fichier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"angular.json"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Pendant le build, l‚Äôenvironnement souhait√© est ensuite transmis en tant qu‚Äôargument √† la commande de build. Le CLI utilise ensuite le fichier d‚Äôenvironnement correct et remplace le fichier par d√©faut pendant le build, que nous pouvons ensuite importer avec la ligne suivante"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"environment"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'../environments/environment'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Maintenant que nous connaissons le concept int√©gr√© de la CLI angulaire. Voyons en quoi cela correspond aux principes de la livraison continue."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Il est donc essentiel de noter que Angular CLI d√©finit l‚Äôenvironnement pendant la construction. Cela signifie que nous devons cr√©er notre application avant chaque d√©ploiement sur une √©tape sp√©cifique."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Cette approche comporte quelques risques."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Si vous cr√©ez votre application √† chaque fois avant de d√©ployer, il se peut que l‚Äôartefact que vous avez test√© ne soit pas le m√™me que celui qui entre en production."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Il est important de r√©aliser qu‚Äôun processus de build n‚Äôest pas toujours d√©terministe. M√™me si le m√™me code entre dans la construction, il n‚Äôest pas garanti que le m√™me artefact sortira."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"L‚Äôartefact ne d√©pend pas seulement de votre code, il d√©pend √©galement des biblioth√®ques tierces, des mises √† jour du syst√®me d‚Äôexploitation ou d‚Äôautres modifications de l‚Äôenvironnement qui se produisent avec le temps."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Rappelez-vous √† l‚Äô√©poque o√π nous avions un "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"package.lock.json"}]},{"type":"text","value":". √Ä l‚Äô√©poque, les builds √©taient encore moins pr√©dictives. Les biblioth√®ques tierces apparaissent souvent avec un "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"^"}]},{"type":"text","value":" dans notre "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"package.json"}]},{"type":"text","value":". Malgr√© "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"semver"}]},{"type":"text","value":", les nouvelles versions d‚Äôune biblioth√®que tierce produisaient parfois une incompatibilit√© avec une autre d√©pendance qui entra√Ænait la rupture de votre application."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Plus vous pouvez maintenir la coh√©rence entre les d√©ploiements, plus le d√©ploiement en production est susceptible de se d√©rouler sans heurts."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"La livraison continue et les fichiers d‚Äôenvironnement fournis par Angular CLI ne conviennent pas!"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Dans la livraison continue, votre artefact doit obtenir des configurations sp√©cifiques √† l‚Äôenvironnement au d√©marrage ou √† l‚Äôex√©cution. Angular CLI, en revanche, obtient ces configurations au moment du build."}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Alors, comment combiner les id√©es de la livraison continue avec notre application angulaire?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Il existe diff√©rentes approches pour combiner les id√©es de livraison continue avec Angular CLI. Chacun comporte des avantages et des inconv√©nients."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Regardons-les."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Configurer l‚Äôh√¥te comme assets - Monter les fichiers de configuration par environnement"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Au lieu d‚Äôextraire la configuration sur un endpoint REST, nous extrayons directement un fichier JSON avec des configurations situ√©es dans notre dossier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"assets"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Nous allons donc cr√©er un dossier de "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"config"}]},{"type":"text","value":" √† l‚Äôint√©rieur "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"assets"}]},{"type":"text","value":" et y placer un "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"JSON"}]},{"type":"text","value":" contenant les configurations sp√©cifiques √† l‚Äôenvironnement local."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Mais comment charge-t-on le fichier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"configuration.json"}]},{"type":"text","value":"? Au travers d‚Äôun service au travers duquel nous r√©cup√©rons le fichier √† partir du dossier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"assets"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"Injectable"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'@angular/core'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"HttpClient"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'@angular/common/http'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"Observable"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'rxjs'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"shareReplay"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'rxjs/operators'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"interface"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Configuration"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  resourceServerA"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","builtin"]},"children":[{"type":"text","value":"string"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n  resourceServerB"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","builtin"]},"children":[{"type":"text","value":"string"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n  stage"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","builtin"]},"children":[{"type":"text","value":"string"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n@"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"Injectable"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"providedIn"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'root'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"ConfigAssetLoaderService"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n\n  "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"readonly"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"CONFIG_URL"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'assets/config/config.json'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" configuration$"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Observable"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"Configuration"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n  "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"constructor"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","parameter"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" http"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" HttpClient"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n  "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"loadConfigurations"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","builtin"]},"children":[{"type":"text","value":"any"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"if"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"!"}]},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"configuration$"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"configuration$ "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"http"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"get"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"Configuration"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"CONFIG_URL"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"pipe"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"shareReplay"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"return"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"configuration$"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"ConfigurationAssetsLoaderService"}]},{"type":"text","value":" charge maintenant notre fichier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"assets/config/config.json"}]},{"type":"text","value":" qui contient toutes les configurations. Mais comment pouvons-nous changer ces configurations par rapport √† l‚Äôenvironnement actuel dans lequel nous nous trouvons?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Nous allons simplement h√©berger notre configuration sur chaque √©tape, puis monter le fichier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"configuration.json"}]},{"type":"text","value":" dans le dossier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"assets"}]},{"type":"text","value":". Lorsque votre pod d√©marre, nous montons votre configuration dans le r√©pertoire "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"assets/config"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Il est important de noter que vous cr√©ez un dossier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"config"}]},{"type":"text","value":" √† l‚Äôint√©rieur du dossier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"assets"}]},{"type":"text","value":". Nous ne pouvons pas utiliser une hi√©rarchie √† plat. Lors du montage, tous les fichiers du dossier mont√© sont supprim√©s."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"La mani√®re concr√®te de monter des volumes d√©pend de votre outil de CI. Sur mon projet, nous utilisons Kubernetes pour nos d√©ploiements. Kubernetes nous fournit des "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"ConfigMaps"}]},{"type":"text","value":" qui peuvent √™tre une propri√©t√© ou m√™me un fichier de configuration complet. Donc, sur Kubernetes, nous avons diff√©rents stages. Chaque stage h√©berge ensuite des configurations sp√©cifiques et les monte dans notre dossier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"assets/config"}]},{"type":"text","value":" au d√©marrage du pod."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-yaml","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"volumeMounts"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"mountPath"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" /usr/share/nginx/html/assets/config\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" yourVolumeName"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Nous avons maintenant vu deux approches dont la mise en oeuvre c√¥t√© client est tr√®s similaire. Nous avons cr√©√© un service qui r√©cup√®re les configurations √† partir d‚Äôun endpoint REST ou du dossier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"assets"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Nous avons donc vu deux mani√®res d‚Äôutiliser un service pour acc√©der √† des configurations. Mais quand appelons-nous ces services?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Eh bien, r√©ponse courte, c‚Äôest √† vous de voir. Il y a des moments diff√©rents o√π il est logique de les appeler. Chacun vient avec des avantages et des inconv√©nients."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Remplacer les configurations par environnement"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Dans cet exemple, nous utilisons les fichiers d‚Äôenvironnement Angular tels quels. Un "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"environment.ts"}]},{"type":"text","value":"et un "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"environment.prod.ts"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"M√™me si nous avons plus de stages que la production et le d√©veloppement, nous distinguons seulement ces deux-l√†. Pour le d√©veloppement local, nous utilisons le fichier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"environment.ts"}]},{"type":"text","value":". Tous les autres stages sont g√©r√©s par "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"environment.prod.ts"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Mais comment ?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Notre "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"environment.prod.ts"}]},{"type":"text","value":" ne contient pas les valeurs r√©elles; il contient des valeurs d‚Äôespace r√©serv√© qui seront √©cras√©es √† chaque √©tape par un script de construction."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Un exemple de fichier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"environment.prod.ts"}]},{"type":"text","value":" pourrait ressembler √† ceci:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"const"}]},{"type":"text","value":" environment "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  resourceServerA"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'REPLACED_BY_BUILD_RESOURCEA'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  resourceServerB"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'REPLACED_BY_BUILD_RESOURCEB'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  stage"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'REPLACED_BY_BUILD_STAGE'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Lorsque nous d√©marrons notre serveur Web, nous pouvons ensuite utiliser un script "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"start.sh"}]},{"type":"text","value":" qui remplacera les espaces r√©serv√©s."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-bash","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","shebang","important"]},"children":[{"type":"text","value":"#!/bin/sh"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# replace static values with environment-variables"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"if"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":" -n "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\""},{"type":"element","tagName":"span","properties":{"className":["token","variable"]},"children":[{"type":"text","value":"$RESOURCEA"}]},{"type":"text","value":"\""}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"then"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"sed"}]},{"type":"text","value":" -i "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"s#REPLACED_BY_BUILD_RESOURCEA#"},{"type":"element","tagName":"span","properties":{"className":["token","variable"]},"children":[{"type":"text","value":"$AUTHSERVER_URL"}]},{"type":"text","value":"#g\""}]},{"type":"text","value":" /usr/share/nginx/html/main.*.bundle.js\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"fi"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# start webserver"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","builtin","class-name"]},"children":[{"type":"text","value":"exec"}]},{"type":"text","value":" nginx"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Nous ex√©cutons ensuite ce script au d√©marrage. Par exemple, dans notre fichier Docker."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"dockerfile"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-dockerfile","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Dockerfile"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"..."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Start nginx via script, which replaces static urls with environment variables"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"ADD"}]},{"type":"text","value":" start.sh /usr/share/nginx/start.sh\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" chmod +x /usr/share/nginx/start.sh\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"CMD"}]},{"type":"text","value":" /usr/share/nginx/start.sh"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Cette approche, du moins pour moi, est un peu ‚Äúhacky‚Äù. Remplacer des cha√Ænes dans un paquet n‚Äôest probablement pas le moyen le plus agr√©able. Il comporte en outre le risque de remplacer quelque chose qui ne devrait pas √™tre remplac√©."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Si vous d√©cidez quand m√™me d‚Äôutiliser cette approche, il est extr√™mement important d‚Äôavoir de bons espaces r√©serv√©s. Utilisez des caract√®res sp√©ciaux que vous n‚Äôutilisez g√©n√©ralement pas dans les noms de variables."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Conclusion"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Angular est livr√© avec des fichiers d‚Äôenvironnement qui nous permettent de g√©rer des configurations sp√©cifiques √† l‚Äôenvironnement. Ils ne r√©pondent pas aux exigences d‚Äôune configuration de livraison continue."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Les fichiers d‚Äôenvironnement Angular sont utilis√©s pendant la phase de build. En mode de livraison continue, il est essentiel de d√©ployer le m√™me artefact √† diff√©rents stages. Par cons√©quent, nous devons transmettre les configurations d‚Äôenvironnement au d√©marrage ou √† l‚Äôex√©cution."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"En fonction de votre configuration, nous pouvons charger des configurations via un service. Soit directement √† partir d‚Äôun backend ou de notre dossier d‚Äôactifs."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Il est donc recommand√© de les mettre en cache."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Un des gros d√©fauts de la fa√ßon dont Angular CLI traite les environnements, dans la culture DevOps c‚Äôest mieux de "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"build une seule fois et de d√©ployer sur plusieurs environnements"}]},{"type":"text","value":", hors Angular CLI veut que vous cr√©er un buildnpm s√©par√© par environnement."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Pourquoi devriez-vous build une seule fois et r√©utiliser cette version dans tous les environnements?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"La raison pour laquelle vous ne souhaitez pas cr√©er une version distincte pour chaque environnement est la suivante:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Cela ralentit les pipelines d‚Äôint√©gration continue (CI), car il doit cr√©er un build pour chaque environnement."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Cela augmente le risque d‚Äôerreurs / de diff√©rences dans diff√©rents environnements, car les versions sont s√©par√©es"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Il ajoute des informations inutiles sur d‚Äôautres environnements dans le code"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Pour des raisons de s√©curit√©, vous pourriez ne pas vouloir afficher d‚Äôinformations confidentielles dans la configuration de l‚Äôenvironnement, qui est enregistr√©e dans Git."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Tous ces probl√®mes me font me demander pourquoi "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Angular CLI opte pour une version par environnement"}]},{"type":"text","value":". Je voulais bien s√ªr une solution √† ces probl√®mes."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Comment ces probl√®mes sont-ils r√©solus ?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"En faisant en sorte que le serveur de d√©ploiement "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"substitue un fichier config.json, charg√© au moment de l‚Äôex√©cution"}]},{"type":"text","value":" par l‚Äôapplication."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Faire en sorte qu‚Äôune application Angular utilise des configurations dynamiques"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Nous voulons que l‚Äôapplication Angular ne comporte que deux fichiers d‚Äôenvironnement: "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"environment.ts"}]},{"type":"text","value":" et "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"environment.prod.ts"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Pourquoi deux environnements, vous pouvez demander? Un pour les d√©veloppeurs locaux, o√π vous pouvez mettre ce que vous voulez pour servir localement et un autre pour cr√©er l‚Äôapplication. Ces fichiers d‚Äôenvironnement tirent l‚Äôessentiel de ses valeurs d‚Äôun fichier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"app-config.json"}]},{"type":"text","value":" charg√© lors de l‚Äôex√©cution, contrairement √† la codification en dur de toutes les informations sur l‚Äôenvironnement dans les fichiers d‚Äôenvironnement."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Cr√©er une nouvelle application Angular"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"La premi√®re √©tape consiste √† cr√©er une nouvelle application Angular en ouvrant le terminal, acc√©der au r√©pertoire souhait√© pour l‚Äôapplication et taper:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-bash","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"ng new dynamic-config-demo"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Et cela devrait cr√©er une nouvelle application Angular pour vous."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Chargement du fichier config.json au d√©marrage"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Toute la configuration de l‚Äôenvironnement va √™tre stock√©e dans un fichier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"app-config.json"}]},{"type":"text","value":" utilis√© par le fichier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"environment.ts"}]},{"type":"text","value":" pour r√©f√©rencer ces valeurs en toute s√©curit√©."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Nous cr√©ons simplement un fichier JSON vide dans le dossier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"assets"}]},{"type":"text","value":" appel√© "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"app-config.json"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"L‚Äô√©tape suivante consiste √† "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"charger le fichier config.json"}]},{"type":"text","value":" √† l‚Äôaide d‚Äôun service d‚Äôinitialisation "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"app.init.ts"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":" Injectable "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'@angular/core'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'rxjs'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":" filter"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" map"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" switchMap"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" tap "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'rxjs/operators'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"declare"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"var"}]},{"type":"text","value":" window"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","builtin"]},"children":[{"type":"text","value":"any"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n@"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"Injectable"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"AppInitService"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// This is the method you want to call at bootstrap"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// Important: It should return a Promise"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"init"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"return"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"fetch"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'assets/app-config.json'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"then"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"function"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","parameter"]},"children":[{"type":"text","value":"response"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n          "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"return"}]},{"type":"text","value":" response"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"json"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"pipe"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"map"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","parameter"]},"children":[{"type":"text","value":"config"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=>"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        window"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"config "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" config"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"return"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"toPromise"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Ce service s‚Äôex√©cutera au d√©marrage et garantira que la configuration de l‚Äôapplication est r√©cup√©r√©e en utilisant "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" pour obtenir le fichier de configuration, puis enregistrez-le dans "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"window"}]},{"type":"text","value":" pour le rendre globalement disponible pour l‚Äôapplication. Notez que lorsque vous utilisez "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":", vous aurez peut-√™tre besoin de polyfills pour la prise en charge du navigateur IE."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Le service d‚Äôinitialisation d‚Äôapplication est configur√© dans le module "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"app.module"}]},{"type":"text","value":" comme suit:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"function"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"init_app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","parameter"]},"children":[{"type":"text","value":"appLoadService"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" AppInitService"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"return"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=>"}]},{"type":"text","value":" appLoadService"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"init"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n@"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"NgModule"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  declarations"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"AppComponent"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" ComponentAComponent"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" ComponentBComponent"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  imports"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"BrowserModule"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" CoreModule"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" HttpClientModule"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  providers"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"\n    AppInitService"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n      provide"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"APP_INITIALIZER"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      useFactory"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" init_app"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      deps"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"AppInitService"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      multi"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","boolean"]},"children":[{"type":"text","value":"true"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  bootstrap"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"AppComponent"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"AppModule"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"L‚Äôutilisation d‚Äôun service d‚Äôinitialisation d‚Äôapplication cr√©e un l√©ger retard sur le temps de d√©marrage de l‚Äôapplication, mais des √©l√©ments simples comme celui-ci n‚Äôauront pas d‚Äôimpact consid√©rable sur le temps de d√©marrage. N√©anmoins, je vous recommande d‚Äôindiquer √† vos utilisateurs d‚Äôattendre avec une spinner de chargement."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Faire en sorte que les fichiers d‚Äôenvironnement utilisent des valeurs dynamiques"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Maintenant que nous chargeons le JSON de configuration de mani√®re dynamique et que nous les enregistrons dans "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"window"}]},{"type":"text","value":", nous voulons pouvoir les r√©f√©rencer en toute s√©curit√©. Pour ce faire, nous devrions avoir trois fichiers d‚Äôenvironnement: "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":", "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"environment.prod"}]},{"type":"text","value":" et "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"dynamic-environment"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":" est destin√© √† √™tre utilis√© localement, "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"environment.prod"}]},{"type":"text","value":" est destin√© √† la production et "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"dynamic-environment"}]},{"type":"text","value":" est partag√© avec "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":" et "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"environment.prod"}]},{"type":"text","value":" afin de fournir une configuration dynamique."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"dynamic-environment"}]},{"type":"text","value":" ressemble √† ceci:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"declare"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"var"}]},{"type":"text","value":" window"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","builtin"]},"children":[{"type":"text","value":"any"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"DynamicEnvironment"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"get"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"environment"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"return"}]},{"type":"text","value":" window"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"config"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"environment"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Ceci est utilis√© dans "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"environnement"}]},{"type":"text","value":" comme celui-ci:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":" DynamicEnvironment "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'./dynamic-environment'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Environment"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"extends"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"DynamicEnvironment"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n\n  "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" production"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","builtin"]},"children":[{"type":"text","value":"boolean"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"constructor"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"super"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"production "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","boolean"]},"children":[{"type":"text","value":"false"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"const"}]},{"type":"text","value":" environment "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"new"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Environment"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Vous pouvez trouver une d√©monstration compl√®te d‚Äôune application angulaire √† configuration dynamique sur mon Github ici."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Substitution du fichier config.json sur le serveur de d√©ploiement"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Maintenant que nous avons configur√© l‚Äôapplication pour la configuration dynamique, la prochaine √©tape consiste √† configurer le remplacement du fichier de configuration sur le serveur de d√©ploiement."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Vous pouvez faire cela en utilisant "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Octopus"}]},{"type":"text","value":", qui a une fonction intelligente pour "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"remplacer un fichier JSON"}]},{"type":"text","value":" par des valeurs de configuration pour l‚Äôenvironnement. Les autres serveurs de d√©ploiement devraient avoir des fonctionnalit√©s similaires pour substituer un fichier JSON juste avant de d√©ployer l‚Äôapplication sur le serveur frontal."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Conclusion"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Nous avons discut√© des probl√®mes pos√©s par la m√©thode de ‚ÄúAngular CLI‚Äù pour g√©rer la configuration de l‚Äôenvironnement avec "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"un build par environnement"}]},{"type":"text","value":". Nous avons √©galement cherch√© √† d√©terminer l‚Äôint√©r√™t de "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"build une version √† la fois"}]},{"type":"text","value":". Nous avons examin√© comment impl√©menter cela √† l‚Äôaide d‚Äôun service app.init qui chargeait un fichier de configuration dynamique lors de l‚Äôinitialisation, avec des valeurs d√©finies par le serveur de d√©ploiement."}]}],"data":{"quirksMode":false}},"excerpt":"Dans les applications m√©tiers, nous rencontrons souvent une configuration de livraison continue comportant plusieurs stages. Chaque √©tape a‚Ä¶","timeToRead":11,"frontmatter":{"title":"Gestion des environnements Angular en livraison continue","subtitle":"Mise en oeuvre de la configuration de l'environnement dynamique dans Angular pour √©viter un build par environnement","userDate":"8 September 2019","date":"2019-09-08T17:00:00.000Z","tags":["Angular","Typescript","Node.js","DevOps"],"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAQFA//EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAGSyjpVIQD/xAAaEAEBAQADAQAAAAAAAAAAAAACAQMAERIh/9oACAEBAAEFAsR700BMKlkvVeifBPn/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPwFX/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAERIf/aAAgBAgEBPwHIRH//xAAbEAACAgMBAAAAAAAAAAAAAAAAARExAhASIv/aAAgBAQAGPwJJ0dYyoepR6ZZ//8QAGRABAQEBAQEAAAAAAAAAAAAAAQARMUEh/9oACAEBAAE/IQpM7+IwFOMhJie2P9Mlexf/2gAMAwEAAgADAAAAEMQP/8QAFREBAQAAAAAAAAAAAAAAAAAAACH/2gAIAQMBAT8QiH//xAAXEQADAQAAAAAAAAAAAAAAAAAAAREh/9oACAECAQE/EE6KaW2H/8QAGhABAQEAAwEAAAAAAAAAAAAAAREAITFBcf/aAAgBAQABPxB44qsZZqokmpY+XKXwX5l59YPJhhB4CazDXo3/2Q==","aspectRatio":1.5005861664712778,"src":"/static/fc4a9d82e0465367f3d289f60d0b6834/bcc02/bloom.jpg","srcSet":"/static/fc4a9d82e0465367f3d289f60d0b6834/1f72c/bloom.jpg 930w,\n/static/fc4a9d82e0465367f3d289f60d0b6834/bcc02/bloom.jpg 1280w","sizes":"(max-width: 1280px) 100vw, 1280px"}}},"author":{"id":"ludo","name":"Wyffels Ludovic","bio":"D√©veloppeur senior. Fullstack + DevOps","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAABMUlEQVQ4y2MwsXf5T03MMGogGBvbOYNpUwdXOIbJwdgwNQQNhCk0snX6r2thC8Y6QGxg7QCWA/FBcrgMxepCkAZrV6//EYmpYBydkvHfMzjiv5mj2//whJT/Nm7ecEMJGgjykp6V/f+AqLj/O/Ye+L8diA8dO/m/pbv/v72n3/+tu/f9D45N/K9naYcSFESFoRXQlSCX2rh7g/kgr1u5epIWhiAMCi/3wLD/fVNn/u+fNgtMT5g+6//kmXOB/Jn/PYLCwWrINnDijDlAPBvKJ8NAZC+DIgCkGYRBbJAYSV5GjpTte/b/PwiMkLj0nP8xqVn/Dxw9AY6kwOh40iIFlmzCgUkmKjnjvx0wdu08fMFskJi1mxfxyQY9YetAEzJyQic5YaNnPeTgIDnrjZaHJGMACtTMXoVAJ6sAAAAASUVORK5CYII=","width":400,"height":400,"src":"/static/5f2c129e42248a92c87b13b4293950cf/c684e/ghost.png","srcSet":"/static/5f2c129e42248a92c87b13b4293950cf/c684e/ghost.png 1x"}}]}}}},"relatedPosts":{"totalCount":3,"edges":[{"node":{"id":"5a9f4e28-76a1-5c32-9601-a4e1921c3776","timeToRead":5,"excerpt":"Bien que le titre de cet article soit un peu trompeur, car nous ne souhaitons pas vraiment communiquer directement entre les composants. Nos‚Ä¶","frontmatter":{"title":"3 fa√ßons de communiquer entre les composants Angular","subtitle":""},"fields":{"slug":"/angular-3way-communication/"}}},{"node":{"id":"d4769f02-9f70-5b9b-8a8c-5346ff7f886b","timeToRead":11,"excerpt":"Dans les applications m√©tiers, nous rencontrons souvent une configuration de livraison continue comportant plusieurs stages. Chaque √©tape a‚Ä¶","frontmatter":{"title":"Gestion des environnements Angular en livraison continue","subtitle":"Mise en oeuvre de la configuration de l'environnement dynamique dans Angular pour √©viter un build par environnement"},"fields":{"slug":"/angular-dynamic-environment/"}}},{"node":{"id":"f3d9e7d1-3a29-5f66-b17f-926e06970fe8","timeToRead":5,"excerpt":"Cet article explique comment utiliser Travis CI pour surveiller les modifications apport√©es √† la branche principale de notre r√©f√©rentiel‚Ä¶","frontmatter":{"title":"Angular DevOps: CT/CI avec Travis CI et Github Pages","subtitle":"Utilisation de Travis CI pour impl√©menter les tests continus (CT) et l'int√©gration continue (CI) afin de d√©ployer notre application Angular sur Github Pages"},"fields":{"slug":"/angular-travis-ctci/"}}}]}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/angular-dynamic-environment/","prev":{"excerpt":"La journalisation est quelque chose que chaque d√©veloppeur fait depuis ses d√©buts en programmation, mais tr√®s peu connaissent la valeur qu‚Ä¶","timeToRead":14,"frontmatter":{"title":"Journalisation: quelques r√®gles pratique","subtitle":"Apprenez comment tirer le meilleur parti de la journalisation","tags":["Node.js"],"category":["Node.js"],"date":"2019-09-07T08:00:00.000Z","draft":false,"image":{"childImageSharp":{"fluid":{"aspectRatio":1.5763546798029557,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAVth6Nm00L//xAAcEAABAwUAAAAAAAAAAAAAAAACAAERAxITIjP/2gAIAQEAAQUCEnQW5YdUH2DtK//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABwQAAEDBQAAAAAAAAAAAAAAAAABESEQIjEyUf/aAAgBAQAGPwK7UiE4ZGUan//EABkQAQADAQEAAAAAAAAAAAAAAAEAESFRMf/aAAgBAQABPyG4NngZgcE8cR33EZWhVRQz/9oADAMBAAIAAwAAABAzL//EABYRAAMAAAAAAAAAAAAAAAAAAAEQUf/aAAgBAwEBPxARf//EABYRAQEBAAAAAAAAAAAAAAAAAAEQQf/aAAgBAgEBPxANn//EABwQAQADAAIDAAAAAAAAAAAAAAEAESFBcTFRYf/aAAgBAQABPxAYQbcl/Ik2gzSvXey61PSzZ5SfCxHAgzSKAqhn/9k=","sizes":"(max-width: 1280px) 100vw, 1280px","src":"/static/3105533b16c3c3b87bfb428faeeec641/bcc02/bloom-bee.jpg","srcSet":"/static/3105533b16c3c3b87bfb428faeeec641/1f72c/bloom-bee.jpg 930w,\n/static/3105533b16c3c3b87bfb428faeeec641/bcc02/bloom-bee.jpg 1280w"}}},"author":{"id":"ludo","bio":"D√©veloppeur senior. Fullstack + DevOps","avatar":{"children":[{"fixed":{"src":"/static/5f2c129e42248a92c87b13b4293950cf/c684e/ghost.png"}}]}}},"fields":{"layout":"post","slug":"/node-logging/"}},"next":null,"primaryTag":"Angular","primaryCategory":"Node.js"}}}