{"componentChunkName":"component---src-templates-post-tsx","path":"/node-pm2/","webpackCompilationHash":"28b74a5dec589e4586df","result":{"data":{"logo":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABFUlEQVQY023PvUrDUBTA8ZuCtoMoOLQ4dWhN14x2kEKXFkGoohQ/QBexOHRycAidKkgHHRq69APRoTjFJYODIA6+gSBYfYMmfYLE/5VT6NALP845NyeHc9UoCHZRQvonCLKKE4ZhAXYURTsYoE9dIy5iCzfUJnEdV+RF4iu6ikFH2EPxazzOcJmg4Rnn5C8ysIEOHqTe5/sT3qXOwYOtRr5/wLAqzpCTDXu4p2ETtyjgGJ/cX+se8jeU9fa4RBt5vWENpjzdkoGPcGg4RQsbOMEFmnBRRwVDHEK/yFXfvr/CoPjvZLKcdByDyzWGeajigzorGy0oOeRJiUtITe/pX1XzDk3buIMltSFR/zTtic3060X+8z8PsEUt8G3LVQAAAABJRU5ErkJggg==","width":400,"height":128,"src":"/static/2b5eaa0de166a8b5faebad4955c2200c/647de/ghost-logo.png","srcSet":"/static/2b5eaa0de166a8b5faebad4955c2200c/647de/ghost-logo.png 1x"}}},"markdownRemark":{"html":"<h2>Utilisations de PM2</h2>\n<p>PM2 a beaucoup d’utilisations, jetons un coup d’oeil à quelques-unes d’entre elles:</p>\n<ul>\n<li>Redémarrage après un crash: PM2 nous permet de maintenir les processus en cours d’exécution</li>\n<li>Suivi et gestion des processus à distance: un portail web vous permet de garder un oeil sur les precessus distants et de les gérer.</li>\n<li>Il ne se contente pas d’exécuter des applications Node: PM2 n’est pas limité aux seuls processus Node.js, c’est vrai, vous pouvez même l’utiliser pour garder votre serveur Minecraft en ligne.</li>\n<li>PM2 peut mémoriser tous vos processus et les redémarrer après un redémarrage du système.</li>\n<li>Et bien plus encore.</li>\n</ul>\n<h2>Pour commencer</h2>\n<p>La première chose que nous devons faire est d’installer PM2 globalement sur votre machine :</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">npm i -g pm2</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2>Commandes de base</h2>\n<p>Venons-en aux principe de base de son utilisation. Pour démarrer un processus sous PM2, il suffit de lancer <code>pm2 start &#x3C;app></code>. <em>App</em> étant le nom du fihier que vous exécutez. PM2 produira quelque chose comme ceci</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">[PM2] Starting /Users/ludovicwyffels/myApp/app.js in fork_mode (1 instance)\n[PM2] Done.\n\n┌──────┬────┬──────┬────────┬─────────┬─────┬───────────┐\n│ Name │ id │ mode │ status │ restart │ cpu │ memory    │\n├──────┼────┼──────┼────────┼─────────┼─────┼───────────┤\n│ app  │ 0  │ fork │ online │ 0       │ 0%  │ 35.1 MB   │\n└──────┴────┴──────┴────────┴─────────┴─────┴───────────┘</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Faites attention à ce qu’il dis sous <code>id</code>. Si vous oubliez, lancez <code>pm2 list</code>. Si vous voulez ajouter un nom au processus lorsque vous le lancez, vous pouvez utiliser le paramètre <code>--name</code> (<code>pm2 start app.js --name my-api</code>).</p>\n<p>Votre application fonctionne maintenant sous PM2, si elle plante, PM2 la redémarrera.</p>\n<h2>Redémarrage en cas de modification de fichier</h2>\n<p>Une autre fonctionnalité impressionnante que PM2 a est de redémarrer quand un fichier dans le répertoire de travail change. Pour que PM2 regarde notre répertoire et redémmarre les changements de fichier, incluez <code>--watch</code> lorsque vous démarrez votre application.</p>\n<h2>Persistance jusqu’au redémarrage</h2>\n<p>PM2 nous permet également de démarrer nos processus lorsque notre serveur (re)démarre. Commencez tout ce que vous voulez avoir en cours d’exécution tout le temps à travers <code>pm2 start</code> et puis exécutez <code>pm2 save</code>.</p>\n<p>Maintenant, quand notre système redémarre, PM2 démarrera tous les processus que nous avions en cours d’exécution lorsque nous avons lancé <code>pm2 save</code>.</p>\n<p>PM2 fait beaucoup de choses, je vais vous laisser découvrir le reste par vous même d’autres fonctions</p>\n<h3>Le mode cluster</h3>\n<table>\n<thead>\n<tr>\n<th>Commandes</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>pm2 start app.js -i 0</code></td>\n<td>Démarre un maximum de processus avec LB en fonction des CPU disponibles.</td>\n</tr>\n</tbody>\n</table>\n<h3>Listen</h3>\n<table>\n<thead>\n<tr>\n<th>Commandes</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>pm2 list</code></td>\n<td>Afficher l’état de tous les processus</td>\n</tr>\n<tr>\n<td><code>pm2 jlist</code></td>\n<td>Impression de la liste des processus en JSON brut</td>\n</tr>\n<tr>\n<td><code>pm2 prettylist</code></td>\n<td>Impression de la liste des processus en JSON embelli</td>\n</tr>\n<tr>\n<td><code>pm2 describe 0</code></td>\n<td>Afficher toutes les informations concernant</td>\n</tr>\n<tr>\n<td><code>pm2 monit</code></td>\n<td>Surveiller tous les processus</td>\n</tr>\n</tbody>\n</table>\n<h3>Logs</h3>\n<table>\n<thead>\n<tr>\n<th>Commandes</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>pm2 logs [--raw]</code></td>\n<td>Afficher tous les journaux de processus en streaming</td>\n</tr>\n<tr>\n<td><code>pm2 flush</code></td>\n<td>Vider tous les fichiers logs</td>\n</tr>\n<tr>\n<td><code>pm2 reloadLogs</code></td>\n<td>Recharger tous les logs</td>\n</tr>\n</tbody>\n</table>\n<h3>Actions</h3>\n<table>\n<thead>\n<tr>\n<th>Commandes</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>pm2 stop all</code></td>\n<td>Arrêter tous les processus</td>\n</tr>\n<tr>\n<td><code>pm2 restart all</code></td>\n<td>Redémarrer tous les processus</td>\n</tr>\n<tr>\n<td><code>pm2 reload all</code></td>\n<td>Rechargement des temps d’arrêt 0s (pour les applications NETWORKED)</td>\n</tr>\n<tr>\n<td><code>pm2 stop 0</code></td>\n<td>Arrêt d’un id de processus spécifique</td>\n</tr>\n<tr>\n<td><code>pm2 restart 0</code></td>\n<td>Redémarrer un id de processus spécifique</td>\n</tr>\n<tr>\n<td><code>pm2 delete 0</code></td>\n<td>Supprimer le processus de la liste</td>\n</tr>\n<tr>\n<td><code>pm2 delete all</code></td>\n<td>Supprimer tous les processus de la liste</td>\n</tr>\n</tbody>\n</table>\n<p>PM2 fait beaucoup de choses, dont la plupart sortent du cadre de cette brève introduction. A l’avenir, nous pourrions couvrir le mode cluster de PM2, la gestion des processus à distance et plus encore. Merci de votre lecture !</p>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Utilisations de PM2"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"PM2 a beaucoup d’utilisations, jetons un coup d’oeil à quelques-unes d’entre elles:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Redémarrage après un crash: PM2 nous permet de maintenir les processus en cours d’exécution"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Suivi et gestion des processus à distance: un portail web vous permet de garder un oeil sur les precessus distants et de les gérer."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Il ne se contente pas d’exécuter des applications Node: PM2 n’est pas limité aux seuls processus Node.js, c’est vrai, vous pouvez même l’utiliser pour garder votre serveur Minecraft en ligne."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"PM2 peut mémoriser tous vos processus et les redémarrer après un redémarrage du système."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Et bien plus encore."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Pour commencer"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"La première chose que nous devons faire est d’installer PM2 globalement sur votre machine :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sh"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-sh","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"npm i -g pm2"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Commandes de base"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Venons-en aux principe de base de son utilisation. Pour démarrer un processus sous PM2, il suffit de lancer "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 start <app>"}]},{"type":"text","value":". "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"App"}]},{"type":"text","value":" étant le nom du fihier que vous exécutez. PM2 produira quelque chose comme ceci"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-text","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"[PM2] Starting /Users/ludovicwyffels/myApp/app.js in fork_mode (1 instance)\n[PM2] Done.\n\n┌──────┬────┬──────┬────────┬─────────┬─────┬───────────┐\n│ Name │ id │ mode │ status │ restart │ cpu │ memory    │\n├──────┼────┼──────┼────────┼─────────┼─────┼───────────┤\n│ app  │ 0  │ fork │ online │ 0       │ 0%  │ 35.1 MB   │\n└──────┴────┴──────┴────────┴─────────┴─────┴───────────┘"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Faites attention à ce qu’il dis sous "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"id"}]},{"type":"text","value":". Si vous oubliez, lancez "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 list"}]},{"type":"text","value":". Si vous voulez ajouter un nom au processus lorsque vous le lancez, vous pouvez utiliser le paramètre "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"--name"}]},{"type":"text","value":" ("},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 start app.js --name my-api"}]},{"type":"text","value":")."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Votre application fonctionne maintenant sous PM2, si elle plante, PM2 la redémarrera."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Redémarrage en cas de modification de fichier"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Une autre fonctionnalité impressionnante que PM2 a est de redémarrer quand un fichier dans le répertoire de travail change. Pour que PM2 regarde notre répertoire et redémmarre les changements de fichier, incluez "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"--watch"}]},{"type":"text","value":" lorsque vous démarrez votre application."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Persistance jusqu’au redémarrage"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"PM2 nous permet également de démarrer nos processus lorsque notre serveur (re)démarre. Commencez tout ce que vous voulez avoir en cours d’exécution tout le temps à travers "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 start"}]},{"type":"text","value":" et puis exécutez "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 save"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Maintenant, quand notre système redémarre, PM2 démarrera tous les processus que nous avions en cours d’exécution lorsque nous avons lancé "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 save"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"PM2 fait beaucoup de choses, je vais vous laisser découvrir le reste par vous même d’autres fonctions"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Le mode cluster"}]},{"type":"text","value":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"type":"element","tagName":"table","properties":{},"children":[{"type":"element","tagName":"thead","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"Commandes"}]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"Description"}]}]}]},{"type":"element","tagName":"tbody","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 start app.js -i 0"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Démarre un maximum de processus avec LB en fonction des CPU disponibles."}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Listen"}]},{"type":"text","value":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"type":"element","tagName":"table","properties":{},"children":[{"type":"element","tagName":"thead","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"Commandes"}]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"Description"}]}]}]},{"type":"element","tagName":"tbody","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 list"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Afficher l’état de tous les processus"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 jlist"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Impression de la liste des processus en JSON brut"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 prettylist"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Impression de la liste des processus en JSON embelli"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 describe 0"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Afficher toutes les informations concernant"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 monit"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Surveiller tous les processus"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Logs"}]},{"type":"text","value":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"type":"element","tagName":"table","properties":{},"children":[{"type":"element","tagName":"thead","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"Commandes"}]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"Description"}]}]}]},{"type":"element","tagName":"tbody","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 logs [--raw]"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Afficher tous les journaux de processus en streaming"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 flush"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Vider tous les fichiers logs"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 reloadLogs"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Recharger tous les logs"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Actions"}]},{"type":"text","value":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"type":"element","tagName":"table","properties":{},"children":[{"type":"element","tagName":"thead","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"Commandes"}]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"Description"}]}]}]},{"type":"element","tagName":"tbody","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 stop all"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Arrêter tous les processus"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 restart all"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Redémarrer tous les processus"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 reload all"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Rechargement des temps d’arrêt 0s (pour les applications NETWORKED)"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 stop 0"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Arrêt d’un id de processus spécifique"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 restart 0"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Redémarrer un id de processus spécifique"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 delete 0"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Supprimer le processus de la liste"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pm2 delete all"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Supprimer tous les processus de la liste"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"PM2 fait beaucoup de choses, dont la plupart sortent du cadre de cette brève introduction. A l’avenir, nous pourrions couvrir le mode cluster de PM2, la gestion des processus à distance et plus encore. Merci de votre lecture !"}]}],"data":{"quirksMode":false}},"excerpt":"Utilisations de PM2 PM2 a beaucoup d’utilisations, jetons un coup d’oeil à quelques-unes d’entre elles: Redémarrage après un crash: PM2 nous permet de maintenir les processus en cours d’exécution Suivi et gestion des processus à distance: un portail web vous permet de garder un oeil sur les precessus distants et de les gérer. Il ne se contente pas d’exécuter des applications Node: PM2 n’est pas limité aux seuls processus Node.js, c’est vrai, vous pouvez même l’utiliser pour garder votre serveur Minecraft en ligne. PM2 peut mémoriser tous vos processus et les redémarrer après un redémarrage du système. Et bien plus encore. Pour commencer La première chose que nous devons faire est d’installer PM2 globalement sur votre machine : Commandes de base Venons-en aux principe de base de son utilisation. Pour démarrer un processus sous PM2, il suffit de lancer pm2 start <app>. App étant le nom du fihier que vous exécutez. PM2 produira quelque chose comme ceci Faites attention à ce qu’il dis sous id. Si vous oubliez, lancez pm2 list. Si vous voulez ajouter un nom au processus lorsque vous le lancez, vous pouvez utiliser le paramètre --name (pm2 start app.js --name my-api). Votre application fonctionne maintenant sous PM2, si elle plante, PM2 la redémarrera. Redémarrage en cas de modification de fichier Une autre fonctionnalité impressionnante que PM2 a est de redémarrer quand un fichier dans le répertoire de travail change. Pour que PM2 regarde notre répertoire et redémmarre les changements de fichier, incluez --watch lorsque vous démarrez votre application. Persistance jusqu’au redémarrage PM2 nous permet également de démarrer nos processus lorsque notre serveur (re)démarre. Commencez tout ce que vous voulez avoir en cours d’exécution tout le temps à travers pm2 start et puis exécutez pm2 save. Maintenant, quand notre système redémarre, PM2 démarrera tous les processus que nous avions en cours d’exécution lorsque nous avons lancé pm2 save. PM2 fait beaucoup de choses, je vais vous laisser découvrir le reste par vous même d’autres fonctions Le mode cluster Commandes Description pm2 start app.js -i 0 Démarre un maximum de processus avec LB en fonction des CPU disponibles. Listen Commandes Description pm2 list Afficher l’état de tous les processus pm2 jlist Impression de la liste des processus en JSON brut pm2 prettylist Impression de la liste des processus en JSON embelli pm2 describe 0 Afficher toutes les informations concernant un spécifique pm2 monit Surveiller tous les processus Logs Commandes Description pm2 logs [--raw] Afficher tous les journaux de processus en streaming pm2 flush Vider tous les fichiers logs pm2 reloadLogs Recharger tous les logs Actions Commandes Description pm2 stop all Arrêter tous les processus pm2 restart all Redémarrer tous les processus pm2 reload all Rechargement des temps d’arrêt 0s (pour les applications NETWORKED) pm2 stop 0 Arrêt d’un id de processus spécifique pm2 restart 0 Redémarrer un id de processus spécifique pm2 delete 0 Supprimer le processus de la liste pm2 delete all Supprimer tous les processus de la liste PM2 fait beaucoup de choses, dont la plupart sortent du cadre de cette brève introduction. A l’avenir, nous pourrions couvrir le mode cluster de PM2, la gestion des processus à distance et plus encore. Merci de votre lecture !","timeToRead":3,"frontmatter":{"title":"Prise en main de PM2, le gestionnaire de processus Node.js","subtitle":"PM2, ou Process Manager 2 est un gestionnaire de processus de production incroyablement polyvalent, écrit en Node.js.","userDate":"1 August 2019","date":"2019-08-01T21:00:00.000Z","tags":["PM2","Node.js"],"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB7sbJEUL/AP/EABgQAQEAAwAAAAAAAAAAAAAAAAEAEBIh/9oACAEBAAEFAltmOmf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAXEAADAQAAAAAAAAAAAAAAAAAAIDEy/9oACAEBAAY/AoZX/8QAGRABAAIDAAAAAAAAAAAAAAAAAQARICEx/9oACAEBAAE/IUHpid7xtiVh/9oADAMBAAIAAwAAABAUD//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/ECf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAEBAAIDAAAAAAAAAAAAAAABEQBBIFHh/9oACAEBAAE/EFQSFpvAquOmid+YIS3Tw//Z","aspectRatio":1.7777777777777777,"src":"/static/73813d7b6a5ab8956ab1d3105c143941/c108b/pm2.jpg","srcSet":"/static/73813d7b6a5ab8956ab1d3105c143941/f8f18/pm2.jpg 930w,\n/static/73813d7b6a5ab8956ab1d3105c143941/c108b/pm2.jpg 1280w","sizes":"(max-width: 1280px) 100vw, 1280px"}}},"author":{"id":"ludo","name":"Wyffels Ludovic","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAABMUlEQVQ4y2MwsXf5T03MMGogGBvbOYNpUwdXOIbJwdgwNQQNhCk0snX6r2thC8Y6QGxg7QCWA/FBcrgMxepCkAZrV6//EYmpYBydkvHfMzjiv5mj2//whJT/Nm7ecEMJGgjykp6V/f+AqLj/O/Ye+L8diA8dO/m/pbv/v72n3/+tu/f9D45N/K9naYcSFESFoRXQlSCX2rh7g/kgr1u5epIWhiAMCi/3wLD/fVNn/u+fNgtMT5g+6//kmXOB/Jn/PYLCwWrINnDijDlAPBvKJ8NAZC+DIgCkGYRBbJAYSV5GjpTte/b/PwiMkLj0nP8xqVn/Dxw9AY6kwOh40iIFlmzCgUkmKjnjvx0wdu08fMFskJi1mxfxyQY9YetAEzJyQic5YaNnPeTgIDnrjZaHJGMACtTMXoVAJ6sAAAAASUVORK5CYII=","width":400,"height":400,"src":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png","srcSet":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png 1x"}}]}}}},"relatedPosts":{"totalCount":1,"edges":[{"node":{"id":"315a8678-a5b5-5ad1-a4b2-c05961f13af9","timeToRead":3,"excerpt":"Utilisations de PM2 PM2 a beaucoup d’utilisations, jetons un coup d’oeil à quelques-unes d’entre elles: Redémarrage après un crash: PM2 nous permet de maintenir les processus en cours d’exécution Suivi et gestion des processus à distance: un portail web vous permet de garder un oeil sur les precessus distants et de les gérer. Il ne se contente pas d’exécuter des applications Node: PM2 n’est pas limité aux seuls processus Node.js, c’est vrai, vous pouvez même l’utiliser pour garder votre serveur Minecraft en ligne. PM2 peut mémoriser tous vos processus et les redémarrer après un redémarrage du système. Et bien plus encore. Pour commencer La première chose que nous devons faire est d’installer PM2 globalement sur votre machine : Commandes de base Venons-en aux principe de base de son utilisation. Pour démarrer un processus sous PM2, il suffit de lancer pm2 start <app>. App étant le nom du fihier que vous exécutez. PM2 produira quelque chose comme ceci Faites attention à ce qu’il dis sous id. Si vous oubliez, lancez pm2 list. Si vous voulez ajouter un nom au processus lorsque vous le lancez, vous pouvez utiliser le paramètre --name (pm2 start app.js --name my-api). Votre application fonctionne maintenant sous PM2, si elle plante, PM2 la redémarrera. Redémarrage en cas de modification de fichier Une autre fonctionnalité impressionnante que PM2 a est de redémarrer quand un fichier dans le répertoire de travail change. Pour que PM2 regarde notre répertoire et redémmarre les changements de fichier, incluez --watch lorsque vous démarrez votre application. Persistance jusqu’au redémarrage PM2 nous permet également de démarrer nos processus lorsque notre serveur (re)démarre. Commencez tout ce que vous voulez avoir en cours d’exécution tout le temps à travers pm2 start et puis exécutez pm2 save. Maintenant, quand notre système redémarre, PM2 démarrera tous les processus que nous avions en cours d’exécution lorsque nous avons lancé pm2 save. PM2 fait beaucoup de choses, je vais vous laisser découvrir le reste par vous même d’autres fonctions Le mode cluster Commandes Description pm2 start app.js -i 0 Démarre un maximum de processus avec LB en fonction des CPU disponibles. Listen Commandes Description pm2 list Afficher l’état de tous les processus pm2 jlist Impression de la liste des processus en JSON brut pm2 prettylist Impression de la liste des processus en JSON embelli pm2 describe 0 Afficher toutes les informations concernant un spécifique pm2 monit Surveiller tous les processus Logs Commandes Description pm2 logs [--raw] Afficher tous les journaux de processus en streaming pm2 flush Vider tous les fichiers logs pm2 reloadLogs Recharger tous les logs Actions Commandes Description pm2 stop all Arrêter tous les processus pm2 restart all Redémarrer tous les processus pm2 reload all Rechargement des temps d’arrêt 0s (pour les applications NETWORKED) pm2 stop 0 Arrêt d’un id de processus spécifique pm2 restart 0 Redémarrer un id de processus spécifique pm2 delete 0 Supprimer le processus de la liste pm2 delete all Supprimer tous les processus de la liste PM2 fait beaucoup de choses, dont la plupart sortent du cadre de cette brève introduction. A l’avenir, nous pourrions couvrir le mode cluster de PM2, la gestion des processus à distance et plus encore. Merci de votre lecture !","frontmatter":{"title":"Prise en main de PM2, le gestionnaire de processus Node.js","subtitle":"PM2, ou Process Manager 2 est un gestionnaire de processus de production incroyablement polyvalent, écrit en Node.js."},"fields":{"slug":"/node-pm2/"}}}]}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/node-pm2/","prev":{"excerpt":"Introduction Presque toutes les applications Web ont besoin de conserver des données sous une forme ou une autre. LoopBack a toujours abstrait le moteur de base de données de l’application en nous fournissant plusieurs connecteurs à utiliser, tels que : MySQL, Postgres et In-memory. LoopBack 4 utilise les mêmes bibliothèques sous-jacentes que LoopBack 3 pour passer la configuration aux moteurs. Cependant, les structures du projet sont légèrement différentes, comme indiqué ci-dessous. Configuration de LoopBack 3 Dans LoopBack 3, vous définiriez un ensemble d’objets JSON à l’intérieur d’un fichier datasources.json stocké dans le dossier serveur, ce qui permettrait à l’application de récupérer la configuration. Le fichier ressemblerait à ceci : Ce fichier définit une nouvelle source de données appelée “db”, qui est configurée pour utiliser le connecteur de base de données en mémoire. Dans la plupart des applications, c’est une excellente source de données par défaut pour les modèles, car elle élimine le besoin de configurer un serveur de base de données lors du premier démarrage avec un prototype. Vous pouvez simplement configurer les modèles pour utiliser la source de données “db” et continuer avec le code. Le fichier model-config.json, dans le même dossier, relierait un modèle à une source de données et ressemblerait à ceci : Une fois que vous avez la base de votre application en place et en cours d’exécution par rapport à la configuration de la base de données en mémoire, vous pouvez vous concentrer sur la configuration d’un serveur de base de données, tel que MySQL ou Postgres, installer le bon connecteur et simplement modifier la configuration datasources.json comme suit : C’est excellent pour le développement local. Mais, lorsque vous travaillez au sein d’une équipe plus importante ou avec plusieurs environnements, un seul fichier de configuration JSON ne va pas le couper. LoopBack 3 a résolu la configuration spécifique à l’environnement en nous permettant de créer des fichiers de sources de données spécifiques à l’environnement. Le nom du fichier de source de données spécifique à l’environnement devait être dans une certaine structure : datasources.<environment>.js. Un projet avec 3 environnements aurait les fichiers suivants : datasources.json (une configuration de serveur de base de données locale) datasources.test.js (une configuration de serveur de base de données de test) datasources.production.js (une configuration de serveur de base de données de production) La version JavaScript du fichier de configuration nous a donné une flexibilité supplémentaire, car nous avons pu déterminer la configuration à l’aide de code. Le fichier de configuration le plus courant utilise les variables d’environnement système. Un exemple de fichier de configuration d’une source de données de production serait le suivant : C’est génial, car cela élimine le besoin de stocker les références de production dans notre code. Nous pourrions livrer ces fichiers de configuration et configurer la configuration sur le serveur, en toute sécurité. Par défaut, le framework utiliserait la variable d’environnement système NODE_ENV pour choisir le fichier source à utiliser. Un serveur de production aurait les variables d’environnement suivantes : NODE_ENV=production DB_HOST=aws-rds-mysql-host.example.com DB_PORT=3306 DB_USER=super-secret-user DB_PASSWORD=super-secret-password DBDATABASE=appdatabase Configuration LoopBack 4 LoopBack 4 ne lit plus automatiquement les fichiers de configuration des sources de données. Au lieu de cela, le framework nous laisse décider comment nous voulons configurer notre application. Pour l’instant, il ne semble pas qu’il existe de meilleures pratiques documentées pour la mise en place d’un tel système. Une approche est suggérée ci-dessous. Dépendance Injection Avant de nous plonger dans la configuration de la base de données, nous devons comprendre l’un des concepts clés de LoopBack 4 : Injection de dépendance. Essentiellement, l’application peut enregistrer des valeurs sur une liste de clés uniques. Ces valeurs peuvent contenir des variables normales ou des définitions de classes, que l’application peut ensuite utiliser pour gérer la création de ces objets pour nous, en reprenant les dépendances requises. Par exemple, on peut enregistrer une valeur,‘bar’ sur une clé ‘foo’. Maintenant l’application sait que la clé ‘foo’, contient la valeur ‘bar’. Nous pouvons demander cette valeur à partir de l’application n’importe où dans notre code. À titre d’exemple : En plus de lier une valeur à une clé, nous pouvons lier une classe à une clé et laisser l’application calculer récursivement ses dépendances lors de l’instanciation de l’objet sur demande. Quand nous demandons une instance de la classe Foo, comme suit: Le conteneur d’application verra que la classe Foo dépend de la valeur de la barre. Il le recherchera dans le conteneur de dépendances, le trouvera (s’il est lié) et l’injectera ensuite dans la classe. D’où l’injection de dépendance. Créer un nouveau projet On peut utiliser la CLI pour créer un nouveau projet en appelant la commande suivante : LoopBack 4 ajoute un dossier datasources au projet. Initialement, on supposerait que ce dossier est configuré pour être lu de la même manière que les fichiers JSON des sources de données LoopBack 3. Cependant, c’est juste le dossier par défaut utilisé par le CLI pour y déposer les nouveaux fichiers. Ajout d’une source de données à l’aide de l’interface CLI Utilisez le CLI pour créer une nouvelle source de données en exécutant la commande suivante : La première chose que vous remarquerez est que le fichier db.datasource.json est exactement le même que le fichier LoopBack 3 datasources.json. Dans l’assistant CLI, j’ai choisi le connecteur en mémoire, qui est l’un des nombreux connecteurs disponibles dans LoopBack 3 et LoopBack 4. Le nouvel ajout à la famille de fichiers de source de données LoopBack est le fichier datasource.ts. La classe étend un type juggler.DataSource, qui est le même type que celui utilisé dans LoopBack 3 (sauf que c’est la version de définition TypeScript). Il nécessite la même structure de configuration JSON que LoopBack 3. Dans cette version, nous devons passer la configuration à la super méthode du constructeur. Le fichier importe la configuration par défaut du fichier db.datasource.json et l’inclut comme valeur par défaut dans le paramètre dsConfig du constructeur. Cela signifie que nous n’aurons jamais besoin de passer quoi que ce soit dans le constructeur de la classe DbDataSource lors de l’instanciation d’une instance de l’objet, à moins de l’écraser… peut-être pour un environnement différent (nous y reviendrons). L’autre décorateur d’injection peu familier permet au framework d’injecter la valeur du paramètre depuis le conteneur d’injection de dépendance (s’il est lié). Dans cette optique, il existe de nombreuses façons d’instancier cette nouvelle classe DataSource : Nous avons maintenant une instance de notre dbDataSource. Mais, comment l’utilise-t-on réellement ? Comment notre nouvelle application connaît-elle notre source de données ? De la même manière que nous pouvons enregistrer (ou lier) des valeurs (ou classes) contre les applications Dependency Container, nous pouvons lier l’instance de la source de données à une clé du conteneur. Dans notre fichier application.ts, nous pouvons utiliser la fonction de liaison des applications dans le constructeur pour lier notre instance à l’application : En outre, LoopBack 4 a une fonction spéciale appelée source de données : Il existe une dernière méthode pour lier notre source de données à l’application: L’extrait de code ci-dessus lie d’abord la configuration à la clé de dépendance ’\ndatasources.config.db. Cette clé de dépendance est référencée dans le constructeur de la classe DbDataSource via le décorateur inject. En liant la clé datasources.db à la définition de classe “DbDataSource”, le conteneur de dépendances va rechercher toutes ses dépendances et les instancier pour nous. Maintenant que le conteneur de dépendances de l’application connaît notre source de données, nous pouvons la lier à un référentiel et un modèle. Note : vous devez d’abord générer un modèle avant de générer un référentiel. Pour ce faire, utilisez la commande modèle lb4 : Après avoir créé un modèle, relions-le à un nouveau référentiel. Utilisez la commande lb4 repository : Une fois que vous avez utilisé le modèle lb4 et la commande lb4 repository, vous devriez vous retrouver avec un référentiel lié à un modèle qui injecte la classe DbDataSource : Notez que le constructeur PersonRepository utilise à nouveau le décorateur inject mais cette fois-ci il fait référence à la clé datasources.db que nous avons définie précédemment. Le référentiel est responsable de la connexion du modèle à la source de données et fournit les fonctions CRUD (Create, Read, Update and Delete), grâce à la classe DefaultCrudRepository dont nous héritons. De la même manière que nous avons lié la source de données à l’application, nous devons lier le référentiel à l’application : Une fois enregistré, nous pouvons utiliser la commande contrôleur lb4 pour créer un nouveau contrôleur REST pour nous, qui utilise notre nouveau modèle de configuration, source de données et référentiel : Vous pouvez enregistrer le contrôleur contre l’application de la même manière que nous avons la source de données et le référentiel. En plus d’utiliser les fonctions de référentiel et de contrôleur pour lier nos classes à notre application, LoopBack les lie automatiquement pour nous. Ceci peut être configuré dans le constructeur de classe d’application : Ceci indique à notre application de regarder à l’intérieur du dossier Contollers pour tous nos contrôleurs et appelle automatiquement this.controller pour nous. Vous pouvez également configurer la valeur du référentiel bootOptions pour faire de même avec les référentiels. Nous n’analyserons pas ici l’ensemble du fichier du contrôleur pour gagner de la place. Les sections importantes seront soulignées : Le décorateur du référentiel s’enroule autour du décorateur d’injection. C’est la même chose que de faire ce qui suit : Nous pouvons maintenant utiliser le référentiel pour accéder à nos données de modèle dans notre source de données configurée. Conclusion Cet article compare les différences entre la configuration d’une source de données de base de données et une application LoopBack 3 et LoopBack 4. En plus de comprendre comment configurer une source de données, nous avons examiné comment configurer la configuration en fonction de divers environnements en permettant aux données de configuration d’être définies par les variables d’environnement système, auxquelles nous accédons par process.env.ENV_VARIABLE.","timeToRead":11,"frontmatter":{"title":"Loopback 4 - Configuration de la base de données","subtitle":"Cet article va décrire quelques façons de configurer une application LoopBack 4 par rapport à une base de données à travers plusieurs environnements de développement (dev, test et production).","tags":["LoopBack","Node.js"],"category":["Node.js"],"date":"2019-06-29T21:00:00.000Z","draft":false,"image":{"childImageSharp":{"fluid":{"aspectRatio":1,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIDBQH/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAgP/2gAMAwEAAhADEAAAAd2qFGs6KLKpA6D/xAAaEAACAwEBAAAAAAAAAAAAAAABAgADERAS/9oACAEBAAEFAmYKBaNltZY+S8UYvf/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABcRAQADAAAAAAAAAAAAAAAAAAIBESD/2gAIAQIBAT8Bgmsf/8QAIBAAAgEBCQAAAAAAAAAAAAAAAREAAhASICExQVFhcf/aAAgBAQAGPwJmIg0+2MLTeZPu8IBxg//EABsQAAICAwEAAAAAAAAAAAAAAAERACEQIDGx/9oACAEBAAE/IWZQhjIPFTxZdwoB1CpF5SyGi0//2gAMAwEAAgADAAAAEGfvAP/EABYRAQEBAAAAAAAAAAAAAAAAAAERIP/aAAgBAwEBPxBW4//EABgRAQADAQAAAAAAAAAAAAAAAAEAEBHh/9oACAECAQE/EGaXkb//xAAeEAEBAAEEAwEAAAAAAAAAAAABESEAMUFhECBxwf/aAAgBAQABPxBSMi50HycxA+/j4mbfQaZtJz1qYZEiAUiAeB2k71ltDTzCen//2Q==","sizes":"(max-width: 2000px) 100vw, 2000px","src":"/static/9611cacec962506545385f22b26d913d/883ab/loopback.jpg","srcSet":"/static/9611cacec962506545385f22b26d913d/f8f18/loopback.jpg 930w,\n/static/9611cacec962506545385f22b26d913d/0e6ff/loopback.jpg 1860w,\n/static/9611cacec962506545385f22b26d913d/883ab/loopback.jpg 2000w"}}},"author":{"id":"ludo","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"fixed":{"src":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png"}}]}}},"fields":{"layout":"post","slug":"/node-loopback-database/"}},"next":{"excerpt":"Une application Node raisonnablement grande aura des centaines de dépendances. Les garder tous à jour est une chose qu’un développeur doit réaliser à un moment ou à un autre. Soit vous ignorez les mises à jour des dépendances jusqu’à ce que vous soyez coincé avec un très ancien ensemble de dépendances qui entravent votre progression avec les vulnérabilités de sécurité ou vous passez votre précieux temps de développement d’application à tester manuellement les mises à jour sur une cadence raisonnable. Voyons comment automatiser ce processus dans un environnement d’entreprise en supposant que vous ayez un environnement CI/CD et un repo GitHub privé. Ingrédients Tests unitaires solides pour votre code. Points bonus si vous avez des tests de e2e et des tests snapshot pour les composants de l’interface utilisateur. next-update Un paquet npm qui teste si vos dépendances peuvent être mises à jour sans casser les tests. hub CLI Il s’agit d’une application en ligne de commande de Git “Hub” qui peut interagir avec votre GitHub repo. hub est exactement similaire à git CLI et constitue un remplacement immédiat, mais dispose des fonctionnalités supplémentaires pour interagir avec GitHub. Pratique pour ouvrir une Pull Request après l’opération de mise à jour. Recette npm install next-update --save-dev\nInstallez next-update en tant que dev-dependency. Configurez un script npm dep:update dans votre section de scripts du fichier package.json npm run dep:update\nExécutez le script. next-update ira de l’avant et trouvera tous les nouveaux paquets. Les met à jour en séquence et conserve la mise à jour si vos tests réussissent. Téléchargez et installez le hub cli Configurez hub Demander au bot d’ouvrir une Pull Request Raccordez ce script dans votre environnement CI/CD pour qu’il s’exécute quotidiennement","timeToRead":2,"frontmatter":{"title":"Automatisez les mises à jour des dépendances","subtitle":"Voyons comment automatiser ce processus dans un environnement d'entreprise en supposant que vous ayez un environnement CI/CD et un repo GitHub privé.","tags":["Node.js"],"category":["Node.js"],"date":"2019-08-10T14:00:00.000Z","draft":false,"image":{"childImageSharp":{"fluid":{"aspectRatio":1.5005861664712778,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAQFA//EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAABqyn8s1EcD//EABoQAQACAwEAAAAAAAAAAAAAAAEAAgMREiL/2gAIAQEAAQUCt6Lruc6jUTJU7//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/AYf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPwGn/8QAGhAAAgMBAQAAAAAAAAAAAAAAAAECESFBcf/aAAgBAQAGPwJoblu0cFWEvRn/xAAdEAACAgIDAQAAAAAAAAAAAAAAAREhMWFBUYGR/9oACAEBAAE/Iai1LQ5jEVYJ38MVHkrSkQ8d/aKQoP/aAAwDAQACAAMAAAAQbz//xAAXEQEAAwAAAAAAAAAAAAAAAAAAARFh/9oACAEDAQE/EIKx/8QAFxEBAAMAAAAAAAAAAAAAAAAAAAERYf/aAAgBAgEBPxCS9f/EABwQAQEBAQACAwAAAAAAAAAAAAERIQAxQVFhgf/aAAgBAQABPxAAqoN+Hsvt1wWQJ9POkMmdE3+hB5KT9nMSBAi5GuDMprM3v//Z","sizes":"(max-width: 1280px) 100vw, 1280px","src":"/static/8756b203d47a4deaf400dbe6dbdbc9ba/c108b/board-game-challenge.jpg","srcSet":"/static/8756b203d47a4deaf400dbe6dbdbc9ba/f8f18/board-game-challenge.jpg 930w,\n/static/8756b203d47a4deaf400dbe6dbdbc9ba/c108b/board-game-challenge.jpg 1280w"}}},"author":{"id":"ludo","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"fixed":{"src":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png"}}]}}},"fields":{"layout":"post","slug":"/node-automate-dependency-updates/"}},"primaryTag":"PM2","primaryCategory":"Node.js"}}}