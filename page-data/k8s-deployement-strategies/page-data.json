{"componentChunkName":"component---src-templates-post-tsx","path":"/k8s-deployement-strategies/","result":{"data":{"logo":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABFUlEQVQY023PvUrDUBTA8ZuCtoMoOLQ4dWhN14x2kEKXFkGoohQ/QBexOHRycAidKkgHHRq69APRoTjFJYODIA6+gSBYfYMmfYLE/5VT6NALP845NyeHc9UoCHZRQvonCLKKE4ZhAXYURTsYoE9dIy5iCzfUJnEdV+RF4iu6ikFH2EPxazzOcJmg4Rnn5C8ysIEOHqTe5/sT3qXOwYOtRr5/wLAqzpCTDXu4p2ETtyjgGJ/cX+se8jeU9fa4RBt5vWENpjzdkoGPcGg4RQsbOMEFmnBRRwVDHEK/yFXfvr/CoPjvZLKcdByDyzWGeajigzorGy0oOeRJiUtITe/pX1XzDk3buIMltSFR/zTtic3060X+8z8PsEUt8G3LVQAAAABJRU5ErkJggg==","width":400,"height":128,"src":"/static/2b5eaa0de166a8b5faebad4955c2200c/c0bbd/ghost-logo.png","srcSet":"/static/2b5eaa0de166a8b5faebad4955c2200c/c0bbd/ghost-logo.png 1x"}}},"markdownRemark":{"html":"<p>Dans Kubernetes, il existe plusieurs façons de publier une application. Il est donc nécessaire de choisir la bonne stratégie pour rendre votre infrastructure fiable lors de la mise à jour d’une application.</p>\n<p>Le choix de la procédure de déploiement appropriée dépend des besoins. Nous avons énuméré ci-dessous certaines des stratégies possibles à adopter:</p>\n<ul>\n<li><a href=\"#recreate\">Recreate</a></li>\n<li><a href=\"#rollingupdate\">RollingUpdate</a></li>\n<li><a href=\"#bluegreen\">Blue/Green</a></li>\n<li><a href=\"#canary\">Canary</a></li>\n<li><a href=\"#abtesting\">A/B testing</a></li>\n</ul>\n<p>Vous pouvez expérimenter chacune de ces stratégies avec Minikube, les manifestes et les étapes à suivre sont expliqués dans ce <a href=\"https://github.com/ludovicwyffels/k8s-deployment-demo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">github</a></p>\n<p>Examinons chaque stratégie et voyons quel type d’application vous conviendrez le mieux.</p>\n<p><a name=\"recreate\"></a></p>\n<h2>Recreate - idéal pour l’environnement de développement</h2>\n<p>Un déploiement défini avec une stratégie de type <strong>recreate</strong> mettra fin à toutes les instances en cours d’exécution, puis les recréera avec la version la plus récente.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f27c880058cf7fa455879ae4b9ba03ab/6ca50/recreate.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABF0lEQVQY01WRPU8CQRCG+Yla+D80FvaWJhZaWNlAggmBqMWduUI99aIGEBqjNBoUbYhcDtmF/ZrZdfc+kJtsJps3+8ybd7ZiikJEBWiMNiulFAKAKZcEgejESorZBk1PVpuWRK1Nduyg2sHHjffjbk5xkhBiy19rjy4drEFxEiPMH3syarspboBigsQK2N3FeND7TVkDnAiaMMar/b33+NXBs+HD88km58l5APVT+0ZZddJvvJztco2No88omGTw9/X+W3hMhd4JNrpfYepsXUgixey+K6LO0pkvSMI5Cb3x4Cl11gbEgtEppfN/5yIztnxZa+WZs5C21Q+Ht34ps1Ry21/vjK5yuNhwRi63nYva4MqmS3/xB4u5hgWcC5SXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/f27c880058cf7fa455879ae4b9ba03ab/14b47/recreate.webp 293w,\n/static/f27c880058cf7fa455879ae4b9ba03ab/91928/recreate.webp 585w,\n/static/f27c880058cf7fa455879ae4b9ba03ab/384f8/recreate.webp 1170w,\n/static/f27c880058cf7fa455879ae4b9ba03ab/68fc1/recreate.webp 1200w\"\n          sizes=\"(max-width: 1170px) 100vw, 1170px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/f27c880058cf7fa455879ae4b9ba03ab/b6dd9/recreate.png 293w,\n/static/f27c880058cf7fa455879ae4b9ba03ab/037e5/recreate.png 585w,\n/static/f27c880058cf7fa455879ae4b9ba03ab/0f291/recreate.png 1170w,\n/static/f27c880058cf7fa455879ae4b9ba03ab/6ca50/recreate.png 1200w\"\n          sizes=\"(max-width: 1170px) 100vw, 1170px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/f27c880058cf7fa455879ae4b9ba03ab/0f291/recreate.png\"\n          alt=\"recreate\"\n          title=\"recreate\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yml line-numbers\"><code class=\"language-yml\"><span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span>\n  <span class=\"token key atrule\">strategy</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> Recreate</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p>Vous trouverez un exemple complet et les étapes de déploiement à l’adresse <a href=\"https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/recreate\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/recreate</a></p>\n</blockquote>\n<p>Avantage</p>\n<ul>\n<li>État d’application entièrement renouvelé</li>\n</ul>\n<p>Inconvénients</p>\n<ul>\n<li>Temps d’arrêt qui dépend à la fois de la durée d’arrêt et du démarrage de l’application</li>\n</ul>\n<p><a name=\"rollingupdate\"></a></p>\n<h2>RollingUpdate - déploiement lent</h2>\n<p>Ce déploiement met à jour les pods de façon progressive. Un <strong>ReplicaSet</strong> secondaire est créé avec la nouvelle version de l’application, puis le nombre de répliques de l’ancienne version est réduit et la nouvelle version est augmentée jusqu’à ce que le nombre correct de répliques soit atteint.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1d809290f395c4681a3991173760108e/6ca50/ramped.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.583333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB5klEQVQoz5VS227TQBD1X/KA4I1voK0AiXcKFaoUJNSHigS1EhJRK0MrJ6Q0oTEBp0raNEoapS4Rwc3VTROv9zK7jO1eHN4YeY93d+aMZs6spgKTUgopIUQBgChV3AKHkEooBfEADSDwbm7LD7pa21BGXq2sqcFIhJQbrlLry+fZz5eJlNrJqcQ7vICQLID1a0XT+Vn1981pqTzc3Zt4REb1IAKdXXYqBcNu1Ce5b9Pij36hRKKkGqdeO71w5VRBMsEmhLgA3m21CN5Fs/VxgfkzLJh4I/usoSS9Jt+Eyfke77bBAvnceFTqfME98X2BXYfdRmQJgJ8KEQVR83IFqZPlV/WLQ3RwIRgTcfJ/2V1mLRLl2HJPrPFhYdhqeF+/y9ksrrYEwc1c//TItQrj0+OJlR9FKTQZjmo79UvfcDbf4DxGL97CYMjjnQsh1lfaOX3wftXOpP+kVs+uyZwSe2tx6jSDKJA9x3HdQVw30mu2t5YE9TGeUdrrdm9Lx0fCye+aeaKXz839xqdqq0wJj/SIYoR/NbatbC1d71b26nr+KHPQzkReDdXF/+viYqL0bMm4f9DZwSPj7B+JHu/eS1ZePs0+TFaXnxgPYnOWQBnlApePNOxwbux4APAZwXtELjhlfuT5CyyL0zs2zLkzAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/1d809290f395c4681a3991173760108e/14b47/ramped.webp 293w,\n/static/1d809290f395c4681a3991173760108e/91928/ramped.webp 585w,\n/static/1d809290f395c4681a3991173760108e/384f8/ramped.webp 1170w,\n/static/1d809290f395c4681a3991173760108e/68fc1/ramped.webp 1200w\"\n          sizes=\"(max-width: 1170px) 100vw, 1170px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/1d809290f395c4681a3991173760108e/b6dd9/ramped.png 293w,\n/static/1d809290f395c4681a3991173760108e/037e5/ramped.png 585w,\n/static/1d809290f395c4681a3991173760108e/0f291/ramped.png 1170w,\n/static/1d809290f395c4681a3991173760108e/6ca50/ramped.png 1200w\"\n          sizes=\"(max-width: 1170px) 100vw, 1170px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/1d809290f395c4681a3991173760108e/0f291/ramped.png\"\n          alt=\"ramped\"\n          title=\"ramped\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yml line-numbers\"><code class=\"language-yml\"><span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span>\n  <span class=\"token key atrule\">strategy</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> RollingUpdate\n    <span class=\"token key atrule\">rollingUpdate</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">maxSurge</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2        </span><span class=\"token comment\"># how many pods we can add at a time</span>\n      <span class=\"token key atrule\">maxUnavailable</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0  </span><span class=\"token comment\"># maxUnavailable define how many pods can be unavailable during the rolling update</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p>Vous trouverez un exemple complet et les étapes de déploiement à l’adresse <a href=\"https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/ramped\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/ramped</a></p>\n</blockquote>\n<p>Lors de la configuration avec la mise à l’ échelle automatique du pod horizontal, il peut être pratique d’utiliser une valeur en pourcentage au lieu d’un nombre pour maxSurge et maxUnavailable .</p>\n<ul>\n<li><code>maxSurge</code> permet d’indiquez combien de Pod il peut créer en plus du nombre de répliqua actuellement configurer</li>\n<li><code>maxUnavailable</code> permet d’indiquer combien de Pod peuvent être “non disponible” pendant la mise à jour, toujours en fonction du nombre de répliqua configuré</li>\n</ul>\n<p>Si vous déclenchez un déploiement alors qu’un déploiement existant est en cours, le déploiement mettra le déploiement en pause et passera à une nouvelle version en remplaçant le déploiement.</p>\n<p>Avantages</p>\n<ul>\n<li>la version est lentement publiée sur toutes les instances</li>\n<li>pratique pour les applications avec état pouvant gérer le rééquilibrage des données</li>\n</ul>\n<p>Inconvénients</p>\n<ul>\n<li>le déploiement/la restauration peut prendre du temps</li>\n<li>la prise en charge de plusieurs API est difficile</li>\n<li>aucun contrôle sur le trafic</li>\n</ul>\n<p><a name=\"bluegreen\"></a></p>\n<h2>Blue/Green - mieux éviter les problèmes de versioning de l’API</h2>\n<p>Un déploiement blue/green diffère d’un déploiement parce que la version “green” de l’application est déployée en parallèle de la version “blue”. Après avoir vérifié que la nouvelle version réponde aux exigences, nous mettons à jour l’objet Kubernetes Service qui joue le rôle d’équilibreur de charge pour envoyer du trafic vers la nouvelle version en remplaçant l’étiquette de version dans le champ <code>selector</code></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/403f058c1985c38bd1357cea1f175a03/6ca50/bluegreen.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.583333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB90lEQVQoz41Sz08TQRTeP9GbJz15NyEmIpGLN6KisSoaNGgsAkJSwawtNLXt0thtSNtsKW5coF1/bApsEd1u98fMvBlndqUsnHyZ+TLvzXwz731vJCaMUkoohQgJAEfKEsbdKHjxgAQgtpc+0BWZvVxk+U324AXr/yIR55TMWOoVy5XY87TAmTc8ABGZALJ3quphvRWUPzu1en+jNPB8Gj/IEULX+dnKFe32Vy9XshXVKqmD+FIJh17n/bjT04Aif3i8v6cPXXuULgfv0NjLjOPQFWvHsUyTAf5Hjs4AwiJPAtTzfMQdQthZyoy7U+Xrq/rcXWVssfn0nnIjSaYIEYyBDwDKMUGOLgB420xVutl32kzFzC5rz87I542y/zYpqos027ilQ60Bxj4oKrjDpNoUCFaLtrF9slU53t3+vaXYp2oLpAuraFmmswtELoT3Z9GFVvEqXj/sFOX+fKq7kbHSj7txglxt31ybcA8M0RWEj6weDsKk2v6R0VmbIGEg1q5/8MMaVcZfxr61U/0iN76pZf2jouVz2oqPvFGfSTA4MeuFdkbvaXkt86mRreyuR9pQCajI8FH11pPa7TvFa0vt1Fj2Uu/P9xE51vDm+uW0Nj1ZuDrfmp7MX0moTSFEISZ8Bgjz6Z/729HP5kFeOUdMcIiCeOcvi/zJygjaGccAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/403f058c1985c38bd1357cea1f175a03/14b47/bluegreen.webp 293w,\n/static/403f058c1985c38bd1357cea1f175a03/91928/bluegreen.webp 585w,\n/static/403f058c1985c38bd1357cea1f175a03/384f8/bluegreen.webp 1170w,\n/static/403f058c1985c38bd1357cea1f175a03/68fc1/bluegreen.webp 1200w\"\n          sizes=\"(max-width: 1170px) 100vw, 1170px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/403f058c1985c38bd1357cea1f175a03/b6dd9/bluegreen.png 293w,\n/static/403f058c1985c38bd1357cea1f175a03/037e5/bluegreen.png 585w,\n/static/403f058c1985c38bd1357cea1f175a03/0f291/bluegreen.png 1170w,\n/static/403f058c1985c38bd1357cea1f175a03/6ca50/bluegreen.png 1200w\"\n          sizes=\"(max-width: 1170px) 100vw, 1170px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/403f058c1985c38bd1357cea1f175a03/0f291/bluegreen.png\"\n          alt=\"bluegreen\"\n          title=\"bluegreen\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yml line-numbers\"><code class=\"language-yml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>app\n <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n   <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>app\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> NodePort\n <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> http\n   <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">8080</span>\n   <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">8080</span>\n \n <span class=\"token comment\"># Note here that we match both the app and the version.</span>\n <span class=\"token comment\"># When switching traffic, we update the label “version” with</span>\n <span class=\"token comment\"># the appropriate value, ie: v2.0.0</span>\n <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n   <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>app\n   <span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> v1.0.0</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p>Vous trouverez un exemple complet et les étapes de déploiement à l’adresse <a href=\"https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/blue-green\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/blue-green</a></p>\n</blockquote>\n<p>Avantages</p>\n<ul>\n<li>déploiement instantané</li>\n<li>éviter le problème de versioning, changer l’état du cluster en une fois</li>\n</ul>\n<p>Inconvénients</p>\n<ul>\n<li>nécessite le double des ressources</li>\n<li>le bon test de toute la plate-forme doit être effectué avant la mise en production</li>\n<li>la gestion des applications avec état peut être difficile</li>\n</ul>\n<p><a name=\"canary\"></a></p>\n<h2>Canary - laissez le consommateur faire le test</h2>\n<p>Le déploiement <strong>Canary</strong> consiste à router un sous-ensemble d’utilisateurs vers une nouvelle fonctionnalité. Dans Kubernetes, un déploiement canary peut être effectué en utilisant deux déploiements avec des étiquettes de pods communes. Une réplique de la nouvelle version est publiée à côté de l’ancienne version. Ensuite, après un certain temps et si aucune erreur n’est détectée, augmentez le nombre de répliques de la nouvelle version et supprimez l’ancien déploiement.</p>\n<p>L’utilisation de cette technique <strong>ReplicaSet</strong> nécessite de faire tourner autant de pod que nécessaire pour obtenir le bon pourcentage de trafic. Cela dit, si vous voulez envoyer 1% du trafic vers la version B, vous devez avoir un pod fonctionnant avec la version B et 99 pods fonctionnant avec la version A. Cela peut être assez peu pratique à gérer donc si vous recherchez une meilleure répartition du trafic, regarder les équilibreurs de charge tels que <a href=\"http://www.haproxy.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">HAProxy</a> ou les mailles de service comme <a href=\"https://linkerd.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Linkerd</a>, qui offrent un meilleur contrôle du trafic.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/eb6ae0806d639a4d47f11a6eb498ddde/6ca50/canary.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 84.83333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsTAAALEwEAmpwYAAACY0lEQVQ4y41S32/SUBTu3+iD2YvPPvtifJjxZQ8mmvhgXGY0M8a5aTaQOMbvFRgYEMavwRjQMrAyNpCfbWlvb++99bZFVjZNvGlvbr+e73znnu8whnMRQjdFJfIM04/lX+YrShhCvMCYW1y0uw+3PTQCE+LEDQC0p69QpW7mtRFmkRYBcXSeAeokkYGJ72ROtqLUQWsslEVZcfmwcHGDbEcMW7Uvq7I8DMawNzInE2IW2S+4ePa1pOI3HxF3flPZWR7ws5qfNZbKtnZZnr3dQXwb/Y1MEWwKZoo4dUycZMPSRwgFo6R79Q9lUw5TjrnowdFpM1ZHcC25ctI7sqrCS2QabF2S6Dqmj518Dhr2GYcb7u5UsMiI3Fa2Kjf+E2TsLuk6OoiQemucAycLh6iAN4xr/LQIKxqGFEVYp0V8Lq2XhOQxrM+VRUne2jOKzUlESeI/OgAo73dR8Wwa09Iq0mxQA3A99Tj1IxzW8kw/u81HN0TVeLdt5M6GB90ApY7K+1zkpQrx5hbJFsf+qzDVnZz6a75nsma8SD741vJ5OlFG7fO9dn44lTx+UmkOvd0QJWsjodfOTRXpE1spcS3/ZRQYGI473Xp6MlE+5J8XOkfun4eM1Ub913i8sWlkykPvZRAhuwu6OJOexFaiDXfgIgWIZnsmS/Iaez/e9LiFKGPPD9BBrMFyI/5Qyi4cNr3h9rhBNa4UAJ7fGWow0nBxg9MgyDK2hypUH4XuxJtfk6CCMFoMx8PAXbbuSmtVBakLk1ZD90LVnQSuXPuMEB0NNIWS00w6VTSXCGVyPasU1Ck4geJvNkiziLji4QYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/eb6ae0806d639a4d47f11a6eb498ddde/14b47/canary.webp 293w,\n/static/eb6ae0806d639a4d47f11a6eb498ddde/91928/canary.webp 585w,\n/static/eb6ae0806d639a4d47f11a6eb498ddde/384f8/canary.webp 1170w,\n/static/eb6ae0806d639a4d47f11a6eb498ddde/68fc1/canary.webp 1200w\"\n          sizes=\"(max-width: 1170px) 100vw, 1170px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/eb6ae0806d639a4d47f11a6eb498ddde/b6dd9/canary.png 293w,\n/static/eb6ae0806d639a4d47f11a6eb498ddde/037e5/canary.png 585w,\n/static/eb6ae0806d639a4d47f11a6eb498ddde/0f291/canary.png 1170w,\n/static/eb6ae0806d639a4d47f11a6eb498ddde/6ca50/canary.png 1200w\"\n          sizes=\"(max-width: 1170px) 100vw, 1170px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/eb6ae0806d639a4d47f11a6eb498ddde/0f291/canary.png\"\n          alt=\"canary\"\n          title=\"canary\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>Dans l’exemple suivant, nous utilisons deux ReplicaSets côte à côte, la version A avec trois répliques (75% du trafic), la version B avec un répliqua (25% du trafic).</p>\n<p>Manifeste de déploiement tronqué version A:</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yml line-numbers\"><code class=\"language-yml\"><span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Manifeste de déploiement tronqué version B, notez que ous ne démarrons qu’un seul répliqua de l’application:</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yml line-numbers\"><code class=\"language-yml\"><span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<blockquote>\n<p>Vous trouverez un exemple complet et les étapes de déploiement à l’adresse <a href=\"https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/canary\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/canary</a></p>\n</blockquote>\n<p>Avantages</p>\n<ul>\n<li>version publiée pour un sous-ensemble d’utilisateurs</li>\n<li>pratique pour la surveillance du taux d’erreur et des performances</li>\n<li>rollback rapide</li>\n</ul>\n<p>Inconvénients</p>\n<ul>\n<li>déploiement lent</li>\n<li>la répartition du trafic ajustée peut être coûteuse (99% A / 1% B = 99 pod A, 1 pod B)</li>\n</ul>\n<p>La procédure utilisée ci-dessus est native de Kubernetes, nous ajustons le nombre de répliques gérées par un ReplicaSet pour distribuer le trafic entre les versions.</p>\n<p>Si vous n’êtes pas sûr de l’impact que la sortie d’une nouvelle fonctionnalité pourrait avoir sur la stabilité de la plate-forme, une stratégie de sortie canari est suggérée.</p>\n<p><a name=\"abtesting\"></a></p>\n<h2>A/B testing - idéal pour testes les fonctionnalités sur un sous-ensemble d’utilisateurs</h2>\n<p>Le test A/B est en fait une technique permettant de prendre des décisions d’affaires basées sur des statistiques, plutôt qu’une stratégie de déploiement. Cependant, il est apparenté et peut être mis en oeuvre à l’aide d’un déploiement canari, c’est pourquoi nous en parlerons brièvement ici.</p>\n<p>En plus de répartir le trafic entre les versions en fonction du poids, vous pouvez cibler précisément un groupe donné d’utilisateurs en fonction de quelques paramètres (cookie, user agent, etc.). Cette technique est largement utilisée pour tester la conversion d’une fonctionnalité donnée et ne déployer que la version qui convient le plus.</p>\n<p><a href=\"https://istio.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Istio</a>, comme les autres maillages de service, fournis un moyen plus fin de subdiviser les instances de service avec un routage dynamique des requêtes basé sur des poids et/ou des en-têtes HTTP.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/159c113c9cbb5b8dadfdfd540f888ee9/6ca50/abtesting.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABUElEQVQY041Qy07CQBTtz7n0W9z7E27cQYgJgcQYiDERcWciD6HQUgoIWoQU28qk0gJtp495OEMBXXqTmdx7cs65Z0agaZE4U4jrImEdxnts6wUXWaLN2UwIYYfzlFGQyVHJHXajV8G3BqZ4E4SwXEnkAeNhxllrz1b/YeOjQhnrBjdDmCzFomONJ7OkfEdFoDbtnuAZ6qJ1zcSlSiKpXMyoztuT0btn4nxpL8YYmy95YKiTGSrd0vZSadiycIydLcaNzi42+Y19mSPTQ2zK8UgeeVd52jLlOugKHOevJGMNWwCnFAaxCyFcU4DtQoYkCTKNz83aWQC303d67mtnOzxs5h6IZSPpt+wswjg4q54oVo31MITtduv7y23qj+fVU8npS+HkKKYJwuj40Qe/+erdj7x00hf6VPtwfcdwZna4AvFKoP8rFiqKIggh/rPgBx1Yu9spDOmqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/159c113c9cbb5b8dadfdfd540f888ee9/14b47/abtesting.webp 293w,\n/static/159c113c9cbb5b8dadfdfd540f888ee9/91928/abtesting.webp 585w,\n/static/159c113c9cbb5b8dadfdfd540f888ee9/384f8/abtesting.webp 1170w,\n/static/159c113c9cbb5b8dadfdfd540f888ee9/68fc1/abtesting.webp 1200w\"\n          sizes=\"(max-width: 1170px) 100vw, 1170px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/159c113c9cbb5b8dadfdfd540f888ee9/b6dd9/abtesting.png 293w,\n/static/159c113c9cbb5b8dadfdfd540f888ee9/037e5/abtesting.png 585w,\n/static/159c113c9cbb5b8dadfdfd540f888ee9/0f291/abtesting.png 1170w,\n/static/159c113c9cbb5b8dadfdfd540f888ee9/6ca50/abtesting.png 1200w\"\n          sizes=\"(max-width: 1170px) 100vw, 1170px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/159c113c9cbb5b8dadfdfd540f888ee9/0f291/abtesting.png\"\n          alt=\"abtesting\"\n          title=\"abtesting\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>Vous trouverez ci-dessous un exemple d’installation de règles à l’aide d’Istio.</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yml line-numbers\"><code class=\"language-yml\"><span class=\"token key atrule\">route</span><span class=\"token punctuation\">:</span>\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">tags</span><span class=\"token punctuation\">:</span>\n  version<span class=\"token punctuation\">:</span> v1.0.0\n  weight<span class=\"token punctuation\">:</span> <span class=\"token number\">90</span>\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">tags</span><span class=\"token punctuation\">:</span>\n  version<span class=\"token punctuation\">:</span> v2.0.0\n  weight<span class=\"token punctuation\">:</span> <span class=\"token number\">10</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Vous trouverez un exemple complet et les étapes de déploiement à l’adresse <a href=\"https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/ab-testing\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/ab-testing</a></p>\n<p>D’autres outils comme <a href=\"https://linkerd.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Linkerd</a>, <a href=\"https://traefik.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Traefik</a>, <a href=\"https://www.nginx.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NGINX</a>, <a href=\"http://www.haproxy.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">HAProxy</a>, vous permettent également de le faire.</p>\n<p>Avantages</p>\n<ul>\n<li>nécessite un équilibreur de charge intelligent</li>\n<li>plusieurs versions en parallèle</li>\n<li>un contrôle total sur la répartition du trafic</li>\n</ul>\n<p>Inconvénients</p>\n<ul>\n<li>les erreurs difficiles à dépanner pour une session donnée, le traçage distribué deviennent obligatoires</li>\n<li>pas simple, vous devez configurer des outils supplémentaires</li>\n</ul>\n<p><a name=\"summary\"></a></p>\n<h3>En résumé</h3>\n<p>Il y a différentes façons de déployer une application, lors de la mise en production dans un <strong>environnement de développement/staging</strong>, un déploiement <a href=\"#bigbang\">big bang</a> ou <a href=\"#rolling\">progressif</a> est généralement un bon choix. Lorsqu’il s’agit de <strong>production</strong>, un déploiement <a href=\"#rolling\">progressif</a> ou en <a href=\"#bluegreen\">blue/green</a> est généralement un bon choix, mais un test approprié de la nouvelle plate-forme est nécessaire. Si vous n’êtes pas sûr de la stabilité de la plate-forme et de l’impact que pourrait avoir la sortie d’une nouvelle version de logiciel, alors une version <a href=\"#canary\">canari</a> devrait être la bonne solution. Ce faisant, vous laissez le consommateur tester l’application et son intégration à la plate-forme. Enfin, si votre entreprise a besoin de tester une nouvelle fonctionnalité parmi un groupe spécifique d’utilisateurs, par exemple, tous les utilisateurs accédant à l’application à l’aide d’un téléphone mobile sont envoyés à la version A, tous les utilisateurs accédant via un ordinateur passent à la version B. Vous pouvez alors utiliser la technique de <a href=\"#abtesting\">test A/B</a> qui en utilisant un réseau de services Kubernetes ou une configuration serveur personnalisée vous permet de déterminer où un utilisateur doit être dirigé en fonction de certains paramètres.</p>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Dans Kubernetes, il existe plusieurs façons de publier une application. Il est donc nécessaire de choisir la bonne stratégie pour rendre votre infrastructure fiable lors de la mise à jour d’une application."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Le choix de la procédure de déploiement appropriée dépend des besoins. Nous avons énuméré ci-dessous certaines des stratégies possibles à adopter:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#recreate"},"children":[{"type":"text","value":"Recreate"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#rollingupdate"},"children":[{"type":"text","value":"RollingUpdate"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#bluegreen"},"children":[{"type":"text","value":"Blue/Green"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#canary"},"children":[{"type":"text","value":"Canary"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#abtesting"},"children":[{"type":"text","value":"A/B testing"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Vous pouvez expérimenter chacune de ces stratégies avec Minikube, les manifestes et les étapes à suivre sont expliqués dans ce "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/ludovicwyffels/k8s-deployment-demo","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"github"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Examinons chaque stratégie et voyons quel type d’application vous conviendrez le mieux."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"name":"recreate"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Recreate - idéal pour l’environnement de développement"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Un déploiement défini avec une stratégie de type "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"recreate"}]},{"type":"text","value":" mettra fin à toutes les instances en cours d’exécution, puis les recréera avec la version la plus récente."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/f27c880058cf7fa455879ae4b9ba03ab/6ca50/recreate.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABF0lEQVQY01WRPU8CQRCG+Yla+D80FvaWJhZaWNlAggmBqMWduUI99aIGEBqjNBoUbYhcDtmF/ZrZdfc+kJtsJps3+8ybd7ZiikJEBWiMNiulFAKAKZcEgejESorZBk1PVpuWRK1Nduyg2sHHjffjbk5xkhBiy19rjy4drEFxEiPMH3syarspboBigsQK2N3FeND7TVkDnAiaMMar/b33+NXBs+HD88km58l5APVT+0ZZddJvvJztco2No88omGTw9/X+W3hMhd4JNrpfYepsXUgixey+K6LO0pkvSMI5Cb3x4Cl11gbEgtEppfN/5yIztnxZa+WZs5C21Q+Ht34ps1Ry21/vjK5yuNhwRi63nYva4MqmS3/xB4u5hgWcC5SXAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"picture","properties":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/f27c880058cf7fa455879ae4b9ba03ab/14b47/recreate.webp 293w","/static/f27c880058cf7fa455879ae4b9ba03ab/91928/recreate.webp 585w","/static/f27c880058cf7fa455879ae4b9ba03ab/384f8/recreate.webp 1170w","/static/f27c880058cf7fa455879ae4b9ba03ab/68fc1/recreate.webp 1200w"],"sizes":["(max-width:","1170px)","100vw,","1170px"],"type":"image/webp"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/f27c880058cf7fa455879ae4b9ba03ab/b6dd9/recreate.png 293w","/static/f27c880058cf7fa455879ae4b9ba03ab/037e5/recreate.png 585w","/static/f27c880058cf7fa455879ae4b9ba03ab/0f291/recreate.png 1170w","/static/f27c880058cf7fa455879ae4b9ba03ab/6ca50/recreate.png 1200w"],"sizes":["(max-width:","1170px)","100vw,","1170px"],"type":"image/png"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"src":"/static/f27c880058cf7fa455879ae4b9ba03ab/0f291/recreate.png","alt":"recreate","title":"recreate","loading":"lazy"},"children":[]},{"type":"text","value":"\n      "}]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yml"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-yml","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"replicas"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"strategy"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"type"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Recreate"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Vous trouverez un exemple complet et les étapes de déploiement à l’adresse "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/recreate","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/recreate"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Avantage"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"État d’application entièrement renouvelé"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Inconvénients"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Temps d’arrêt qui dépend à la fois de la durée d’arrêt et du démarrage de l’application"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"name":"rollingupdate"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"RollingUpdate - déploiement lent"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Ce déploiement met à jour les pods de façon progressive. Un "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"ReplicaSet"}]},{"type":"text","value":" secondaire est créé avec la nouvelle version de l’application, puis le nombre de répliques de l’ancienne version est réduit et la nouvelle version est augmentée jusqu’à ce que le nombre correct de répliques soit atteint."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/1d809290f395c4681a3991173760108e/6ca50/ramped.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 62.583333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB5klEQVQoz5VS227TQBD1X/KA4I1voK0AiXcKFaoUJNSHigS1EhJRK0MrJ6Q0oTEBp0raNEoapS4Rwc3VTROv9zK7jO1eHN4YeY93d+aMZs6spgKTUgopIUQBgChV3AKHkEooBfEADSDwbm7LD7pa21BGXq2sqcFIhJQbrlLry+fZz5eJlNrJqcQ7vICQLID1a0XT+Vn1981pqTzc3Zt4REb1IAKdXXYqBcNu1Ce5b9Pij36hRKKkGqdeO71w5VRBMsEmhLgA3m21CN5Fs/VxgfkzLJh4I/usoSS9Jt+Eyfke77bBAvnceFTqfME98X2BXYfdRmQJgJ8KEQVR83IFqZPlV/WLQ3RwIRgTcfJ/2V1mLRLl2HJPrPFhYdhqeF+/y9ksrrYEwc1c//TItQrj0+OJlR9FKTQZjmo79UvfcDbf4DxGL97CYMjjnQsh1lfaOX3wftXOpP+kVs+uyZwSe2tx6jSDKJA9x3HdQVw30mu2t5YE9TGeUdrrdm9Lx0fCye+aeaKXz839xqdqq0wJj/SIYoR/NbatbC1d71b26nr+KHPQzkReDdXF/+viYqL0bMm4f9DZwSPj7B+JHu/eS1ZePs0+TFaXnxgPYnOWQBnlApePNOxwbux4APAZwXtELjhlfuT5CyyL0zs2zLkzAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"picture","properties":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/1d809290f395c4681a3991173760108e/14b47/ramped.webp 293w","/static/1d809290f395c4681a3991173760108e/91928/ramped.webp 585w","/static/1d809290f395c4681a3991173760108e/384f8/ramped.webp 1170w","/static/1d809290f395c4681a3991173760108e/68fc1/ramped.webp 1200w"],"sizes":["(max-width:","1170px)","100vw,","1170px"],"type":"image/webp"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/1d809290f395c4681a3991173760108e/b6dd9/ramped.png 293w","/static/1d809290f395c4681a3991173760108e/037e5/ramped.png 585w","/static/1d809290f395c4681a3991173760108e/0f291/ramped.png 1170w","/static/1d809290f395c4681a3991173760108e/6ca50/ramped.png 1200w"],"sizes":["(max-width:","1170px)","100vw,","1170px"],"type":"image/png"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"src":"/static/1d809290f395c4681a3991173760108e/0f291/ramped.png","alt":"ramped","title":"ramped","loading":"lazy"},"children":[]},{"type":"text","value":"\n      "}]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yml"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-yml","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"replicas"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"strategy"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"type"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" RollingUpdate\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"rollingUpdate"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"maxSurge"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"2        "}]},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# how many pods we can add at a time"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"maxUnavailable"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0  "}]},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# maxUnavailable define how many pods can be unavailable during the rolling update"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Vous trouverez un exemple complet et les étapes de déploiement à l’adresse "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/ramped","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/ramped"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Lors de la configuration avec la mise à l’ échelle automatique du pod horizontal, il peut être pratique d’utiliser une valeur en pourcentage au lieu d’un nombre pour maxSurge et maxUnavailable ."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"maxSurge"}]},{"type":"text","value":" permet d’indiquez combien de Pod il peut créer en plus du nombre de répliqua actuellement configurer"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"maxUnavailable"}]},{"type":"text","value":" permet d’indiquer combien de Pod peuvent être “non disponible” pendant la mise à jour, toujours en fonction du nombre de répliqua configuré"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Si vous déclenchez un déploiement alors qu’un déploiement existant est en cours, le déploiement mettra le déploiement en pause et passera à une nouvelle version en remplaçant le déploiement."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Avantages"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"la version est lentement publiée sur toutes les instances"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"pratique pour les applications avec état pouvant gérer le rééquilibrage des données"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Inconvénients"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"le déploiement/la restauration peut prendre du temps"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"la prise en charge de plusieurs API est difficile"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"aucun contrôle sur le trafic"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"name":"bluegreen"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Blue/Green - mieux éviter les problèmes de versioning de l’API"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Un déploiement blue/green diffère d’un déploiement parce que la version “green” de l’application est déployée en parallèle de la version “blue”. Après avoir vérifié que la nouvelle version réponde aux exigences, nous mettons à jour l’objet Kubernetes Service qui joue le rôle d’équilibreur de charge pour envoyer du trafic vers la nouvelle version en remplaçant l’étiquette de version dans le champ "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"selector"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/403f058c1985c38bd1357cea1f175a03/6ca50/bluegreen.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 62.583333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB90lEQVQoz41Sz08TQRTeP9GbJz15NyEmIpGLN6KisSoaNGgsAkJSwawtNLXt0thtSNtsKW5coF1/bApsEd1u98fMvBlndqUsnHyZ+TLvzXwz731vJCaMUkoohQgJAEfKEsbdKHjxgAQgtpc+0BWZvVxk+U324AXr/yIR55TMWOoVy5XY87TAmTc8ABGZALJ3quphvRWUPzu1en+jNPB8Gj/IEULX+dnKFe32Vy9XshXVKqmD+FIJh17n/bjT04Aif3i8v6cPXXuULgfv0NjLjOPQFWvHsUyTAf5Hjs4AwiJPAtTzfMQdQthZyoy7U+Xrq/rcXWVssfn0nnIjSaYIEYyBDwDKMUGOLgB420xVutl32kzFzC5rz87I542y/zYpqos027ilQ60Bxj4oKrjDpNoUCFaLtrF9slU53t3+vaXYp2oLpAuraFmmswtELoT3Z9GFVvEqXj/sFOX+fKq7kbHSj7txglxt31ybcA8M0RWEj6weDsKk2v6R0VmbIGEg1q5/8MMaVcZfxr61U/0iN76pZf2jouVz2oqPvFGfSTA4MeuFdkbvaXkt86mRreyuR9pQCajI8FH11pPa7TvFa0vt1Fj2Uu/P9xE51vDm+uW0Nj1ZuDrfmp7MX0moTSFEISZ8Bgjz6Z/729HP5kFeOUdMcIiCeOcvi/zJygjaGccAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"picture","properties":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/403f058c1985c38bd1357cea1f175a03/14b47/bluegreen.webp 293w","/static/403f058c1985c38bd1357cea1f175a03/91928/bluegreen.webp 585w","/static/403f058c1985c38bd1357cea1f175a03/384f8/bluegreen.webp 1170w","/static/403f058c1985c38bd1357cea1f175a03/68fc1/bluegreen.webp 1200w"],"sizes":["(max-width:","1170px)","100vw,","1170px"],"type":"image/webp"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/403f058c1985c38bd1357cea1f175a03/b6dd9/bluegreen.png 293w","/static/403f058c1985c38bd1357cea1f175a03/037e5/bluegreen.png 585w","/static/403f058c1985c38bd1357cea1f175a03/0f291/bluegreen.png 1170w","/static/403f058c1985c38bd1357cea1f175a03/6ca50/bluegreen.png 1200w"],"sizes":["(max-width:","1170px)","100vw,","1170px"],"type":"image/png"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"src":"/static/403f058c1985c38bd1357cea1f175a03/0f291/bluegreen.png","alt":"bluegreen","title":"bluegreen","loading":"lazy"},"children":[]},{"type":"text","value":"\n      "}]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yml"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-yml","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"apiVersion"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" v1\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"kind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Service\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" my"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"app\n "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"labels"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n   "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" my"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"app\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"type"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" NodePort\n "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"ports"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" http\n   "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"port"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"8080"}]},{"type":"text","value":"\n   "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"targetPort"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"8080"}]},{"type":"text","value":"\n \n "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Note here that we match both the app and the version."}]},{"type":"text","value":"\n "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# When switching traffic, we update the label “version” with"}]},{"type":"text","value":"\n "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# the appropriate value, ie: v2.0.0"}]},{"type":"text","value":"\n "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"selector"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n   "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" my"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"app\n   "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"version"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" v1.0.0"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Vous trouverez un exemple complet et les étapes de déploiement à l’adresse "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/blue-green","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/blue-green"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Avantages"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"déploiement instantané"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"éviter le problème de versioning, changer l’état du cluster en une fois"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Inconvénients"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"nécessite le double des ressources"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"le bon test de toute la plate-forme doit être effectué avant la mise en production"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"la gestion des applications avec état peut être difficile"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"name":"canary"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Canary - laissez le consommateur faire le test"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Le déploiement "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Canary"}]},{"type":"text","value":" consiste à router un sous-ensemble d’utilisateurs vers une nouvelle fonctionnalité. Dans Kubernetes, un déploiement canary peut être effectué en utilisant deux déploiements avec des étiquettes de pods communes. Une réplique de la nouvelle version est publiée à côté de l’ancienne version. Ensuite, après un certain temps et si aucune erreur n’est détectée, augmentez le nombre de répliques de la nouvelle version et supprimez l’ancien déploiement."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"L’utilisation de cette technique "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"ReplicaSet"}]},{"type":"text","value":" nécessite de faire tourner autant de pod que nécessaire pour obtenir le bon pourcentage de trafic. Cela dit, si vous voulez envoyer 1% du trafic vers la version B, vous devez avoir un pod fonctionnant avec la version B et 99 pods fonctionnant avec la version A. Cela peut être assez peu pratique à gérer donc si vous recherchez une meilleure répartition du trafic, regarder les équilibreurs de charge tels que "},{"type":"element","tagName":"a","properties":{"href":"http://www.haproxy.org/","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"HAProxy"}]},{"type":"text","value":" ou les mailles de service comme "},{"type":"element","tagName":"a","properties":{"href":"https://linkerd.io/","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"Linkerd"}]},{"type":"text","value":", qui offrent un meilleur contrôle du trafic."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/eb6ae0806d639a4d47f11a6eb498ddde/6ca50/canary.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 84.83333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsTAAALEwEAmpwYAAACY0lEQVQ4y41S32/SUBTu3+iD2YvPPvtifJjxZQ8mmvhgXGY0M8a5aTaQOMbvFRgYEMavwRjQMrAyNpCfbWlvb++99bZFVjZNvGlvbr+e73znnu8whnMRQjdFJfIM04/lX+YrShhCvMCYW1y0uw+3PTQCE+LEDQC0p69QpW7mtRFmkRYBcXSeAeokkYGJ72ROtqLUQWsslEVZcfmwcHGDbEcMW7Uvq7I8DMawNzInE2IW2S+4ePa1pOI3HxF3flPZWR7ws5qfNZbKtnZZnr3dQXwb/Y1MEWwKZoo4dUycZMPSRwgFo6R79Q9lUw5TjrnowdFpM1ZHcC25ctI7sqrCS2QabF2S6Dqmj518Dhr2GYcb7u5UsMiI3Fa2Kjf+E2TsLuk6OoiQemucAycLh6iAN4xr/LQIKxqGFEVYp0V8Lq2XhOQxrM+VRUne2jOKzUlESeI/OgAo73dR8Wwa09Iq0mxQA3A99Tj1IxzW8kw/u81HN0TVeLdt5M6GB90ApY7K+1zkpQrx5hbJFsf+qzDVnZz6a75nsma8SD741vJ5OlFG7fO9dn44lTx+UmkOvd0QJWsjodfOTRXpE1spcS3/ZRQYGI473Xp6MlE+5J8XOkfun4eM1Ub913i8sWlkykPvZRAhuwu6OJOexFaiDXfgIgWIZnsmS/Iaez/e9LiFKGPPD9BBrMFyI/5Qyi4cNr3h9rhBNa4UAJ7fGWow0nBxg9MgyDK2hypUH4XuxJtfk6CCMFoMx8PAXbbuSmtVBakLk1ZD90LVnQSuXPuMEB0NNIWS00w6VTSXCGVyPasU1Ck4geJvNkiziLji4QYAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"picture","properties":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/eb6ae0806d639a4d47f11a6eb498ddde/14b47/canary.webp 293w","/static/eb6ae0806d639a4d47f11a6eb498ddde/91928/canary.webp 585w","/static/eb6ae0806d639a4d47f11a6eb498ddde/384f8/canary.webp 1170w","/static/eb6ae0806d639a4d47f11a6eb498ddde/68fc1/canary.webp 1200w"],"sizes":["(max-width:","1170px)","100vw,","1170px"],"type":"image/webp"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/eb6ae0806d639a4d47f11a6eb498ddde/b6dd9/canary.png 293w","/static/eb6ae0806d639a4d47f11a6eb498ddde/037e5/canary.png 585w","/static/eb6ae0806d639a4d47f11a6eb498ddde/0f291/canary.png 1170w","/static/eb6ae0806d639a4d47f11a6eb498ddde/6ca50/canary.png 1200w"],"sizes":["(max-width:","1170px)","100vw,","1170px"],"type":"image/png"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"src":"/static/eb6ae0806d639a4d47f11a6eb498ddde/0f291/canary.png","alt":"canary","title":"canary","loading":"lazy"},"children":[]},{"type":"text","value":"\n      "}]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Dans l’exemple suivant, nous utilisons deux ReplicaSets côte à côte, la version A avec trois répliques (75% du trafic), la version B avec un répliqua (25% du trafic)."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Manifeste de déploiement tronqué version A:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yml"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-yml","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"replicas"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Manifeste de déploiement tronqué version B, notez que ous ne démarrons qu’un seul répliqua de l’application:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yml"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-yml","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"replicas"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Vous trouverez un exemple complet et les étapes de déploiement à l’adresse "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/canary","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/canary"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Avantages"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"version publiée pour un sous-ensemble d’utilisateurs"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"pratique pour la surveillance du taux d’erreur et des performances"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"rollback rapide"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Inconvénients"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"déploiement lent"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"la répartition du trafic ajustée peut être coûteuse (99% A / 1% B = 99 pod A, 1 pod B)"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"La procédure utilisée ci-dessus est native de Kubernetes, nous ajustons le nombre de répliques gérées par un ReplicaSet pour distribuer le trafic entre les versions."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Si vous n’êtes pas sûr de l’impact que la sortie d’une nouvelle fonctionnalité pourrait avoir sur la stabilité de la plate-forme, une stratégie de sortie canari est suggérée."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"name":"abtesting"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"A/B testing - idéal pour testes les fonctionnalités sur un sous-ensemble d’utilisateurs"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Le test A/B est en fait une technique permettant de prendre des décisions d’affaires basées sur des statistiques, plutôt qu’une stratégie de déploiement. Cependant, il est apparenté et peut être mis en oeuvre à l’aide d’un déploiement canari, c’est pourquoi nous en parlerons brièvement ici."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"En plus de répartir le trafic entre les versions en fonction du poids, vous pouvez cibler précisément un groupe donné d’utilisateurs en fonction de quelques paramètres (cookie, user agent, etc.). Cette technique est largement utilisée pour tester la conversion d’une fonctionnalité donnée et ne déployer que la version qui convient le plus."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://istio.io/","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"Istio"}]},{"type":"text","value":", comme les autres maillages de service, fournis un moyen plus fin de subdiviser les instances de service avec un routage dynamique des requêtes basé sur des poids et/ou des en-têtes HTTP."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/159c113c9cbb5b8dadfdfd540f888ee9/6ca50/abtesting.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABUElEQVQY041Qy07CQBTtz7n0W9z7E27cQYgJgcQYiDERcWciD6HQUgoIWoQU28qk0gJtp495OEMBXXqTmdx7cs65Z0agaZE4U4jrImEdxnts6wUXWaLN2UwIYYfzlFGQyVHJHXajV8G3BqZ4E4SwXEnkAeNhxllrz1b/YeOjQhnrBjdDmCzFomONJ7OkfEdFoDbtnuAZ6qJ1zcSlSiKpXMyoztuT0btn4nxpL8YYmy95YKiTGSrd0vZSadiycIydLcaNzi42+Y19mSPTQ2zK8UgeeVd52jLlOugKHOevJGMNWwCnFAaxCyFcU4DtQoYkCTKNz83aWQC303d67mtnOzxs5h6IZSPpt+wswjg4q54oVo31MITtduv7y23qj+fVU8npS+HkKKYJwuj40Qe/+erdj7x00hf6VPtwfcdwZna4AvFKoP8rFiqKIggh/rPgBx1Yu9spDOmqAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"picture","properties":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/159c113c9cbb5b8dadfdfd540f888ee9/14b47/abtesting.webp 293w","/static/159c113c9cbb5b8dadfdfd540f888ee9/91928/abtesting.webp 585w","/static/159c113c9cbb5b8dadfdfd540f888ee9/384f8/abtesting.webp 1170w","/static/159c113c9cbb5b8dadfdfd540f888ee9/68fc1/abtesting.webp 1200w"],"sizes":["(max-width:","1170px)","100vw,","1170px"],"type":"image/webp"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/159c113c9cbb5b8dadfdfd540f888ee9/b6dd9/abtesting.png 293w","/static/159c113c9cbb5b8dadfdfd540f888ee9/037e5/abtesting.png 585w","/static/159c113c9cbb5b8dadfdfd540f888ee9/0f291/abtesting.png 1170w","/static/159c113c9cbb5b8dadfdfd540f888ee9/6ca50/abtesting.png 1200w"],"sizes":["(max-width:","1170px)","100vw,","1170px"],"type":"image/png"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"src":"/static/159c113c9cbb5b8dadfdfd540f888ee9/0f291/abtesting.png","alt":"abtesting","title":"abtesting","loading":"lazy"},"children":[]},{"type":"text","value":"\n      "}]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Vous trouverez ci-dessous un exemple d’installation de règles à l’aide d’Istio."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yml"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-yml","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"route"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"tags"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  version"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" v1.0.0\n  weight"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"90"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"tags"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  version"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" v2.0.0\n  weight"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"10"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Vous trouverez un exemple complet et les étapes de déploiement à l’adresse "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/ab-testing","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"https://github.com/ludovicwyffels/k8s-deployment-demo/tree/master/ab-testing"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"D’autres outils comme "},{"type":"element","tagName":"a","properties":{"href":"https://linkerd.io/","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"Linkerd"}]},{"type":"text","value":", "},{"type":"element","tagName":"a","properties":{"href":"https://traefik.io/","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"Traefik"}]},{"type":"text","value":", "},{"type":"element","tagName":"a","properties":{"href":"https://www.nginx.com/","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"NGINX"}]},{"type":"text","value":", "},{"type":"element","tagName":"a","properties":{"href":"http://www.haproxy.org/","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"HAProxy"}]},{"type":"text","value":", vous permettent également de le faire."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Avantages"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"nécessite un équilibreur de charge intelligent"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"plusieurs versions en parallèle"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"un contrôle total sur la répartition du trafic"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Inconvénients"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"les erreurs difficiles à dépanner pour une session donnée, le traçage distribué deviennent obligatoires"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"pas simple, vous devez configurer des outils supplémentaires"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"name":"summary"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"En résumé"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Il y a différentes façons de déployer une application, lors de la mise en production dans un "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"environnement de développement/staging"}]},{"type":"text","value":", un déploiement "},{"type":"element","tagName":"a","properties":{"href":"#bigbang"},"children":[{"type":"text","value":"big bang"}]},{"type":"text","value":" ou "},{"type":"element","tagName":"a","properties":{"href":"#rolling"},"children":[{"type":"text","value":"progressif"}]},{"type":"text","value":" est généralement un bon choix. Lorsqu’il s’agit de "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"production"}]},{"type":"text","value":", un déploiement "},{"type":"element","tagName":"a","properties":{"href":"#rolling"},"children":[{"type":"text","value":"progressif"}]},{"type":"text","value":" ou en "},{"type":"element","tagName":"a","properties":{"href":"#bluegreen"},"children":[{"type":"text","value":"blue/green"}]},{"type":"text","value":" est généralement un bon choix, mais un test approprié de la nouvelle plate-forme est nécessaire. Si vous n’êtes pas sûr de la stabilité de la plate-forme et de l’impact que pourrait avoir la sortie d’une nouvelle version de logiciel, alors une version "},{"type":"element","tagName":"a","properties":{"href":"#canary"},"children":[{"type":"text","value":"canari"}]},{"type":"text","value":" devrait être la bonne solution. Ce faisant, vous laissez le consommateur tester l’application et son intégration à la plate-forme. Enfin, si votre entreprise a besoin de tester une nouvelle fonctionnalité parmi un groupe spécifique d’utilisateurs, par exemple, tous les utilisateurs accédant à l’application à l’aide d’un téléphone mobile sont envoyés à la version A, tous les utilisateurs accédant via un ordinateur passent à la version B. Vous pouvez alors utiliser la technique de "},{"type":"element","tagName":"a","properties":{"href":"#abtesting"},"children":[{"type":"text","value":"test A/B"}]},{"type":"text","value":" qui en utilisant un réseau de services Kubernetes ou une configuration serveur personnalisée vous permet de déterminer où un utilisateur doit être dirigé en fonction de certains paramètres."}]}],"data":{"quirksMode":false}},"excerpt":"Dans Kubernetes, il existe plusieurs façons de publier une application. Il est donc nécessaire de choisir la bonne stratégie pour rendre…","timeToRead":8,"frontmatter":{"title":"Stratégie de déploiement de Kubernetes","subtitle":"Dans Kubernetes, il y a plusieurs façons de publier une application, il est nécessaire de choisir la bonne stratégie pour rendre votre infrastructure fiable pendant la mise à jour d'une application.","userDate":"25 May 2019","date":"2019-05-25T08:00:00.000Z","tags":["Kubernetes","DevOps"],"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgT/xAAVAQEBAAAAAAAAAAAAAAAAAAABAP/aAAwDAQACEAMQAAABzC2jBYj/xAAaEAACAgMAAAAAAAAAAAAAAAABAgARITFC/9oACAEBAAEFAu8hQtzZANss/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8BR//EABkQAAMAAwAAAAAAAAAAAAAAAAABERAxQf/aAAgBAQAGPwJXREcEs//EABgQAQEBAQEAAAAAAAAAAAAAAAERADFh/9oACAEBAAE/IRsrGWEVe4jVD66plnHI7Z2ZqM6Xf//aAAwDAQACAAMAAAAQwP8A/8QAFxEBAAMAAAAAAAAAAAAAAAAAAAERMf/aAAgBAwEBPxDZU//EABcRAAMBAAAAAAAAAAAAAAAAAAABESH/2gAIAQIBAT8QxIg//8QAHhABAAICAgMBAAAAAAAAAAAAAQAhEUExYXGBkaH/2gAIAQEAAT8QZGFr56O45sQgzWiXtrCEP6wYQCWcsZ1Hgda+xT8AxY17n//Z","aspectRatio":1.33422281521014,"src":"/static/cc32bd959fba19866af4a1302ca23593/7ac0b/interchange.jpg","srcSet":"/static/cc32bd959fba19866af4a1302ca23593/1f72c/interchange.jpg 930w,\n/static/cc32bd959fba19866af4a1302ca23593/d7cf8/interchange.jpg 1860w,\n/static/cc32bd959fba19866af4a1302ca23593/7ac0b/interchange.jpg 2000w","sizes":"(max-width: 2000px) 100vw, 2000px"}}},"author":{"id":"ludo","name":"Wyffels Ludovic","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAABMUlEQVQ4y2MwsXf5T03MMGogGBvbOYNpUwdXOIbJwdgwNQQNhCk0snX6r2thC8Y6QGxg7QCWA/FBcrgMxepCkAZrV6//EYmpYBydkvHfMzjiv5mj2//whJT/Nm7ecEMJGgjykp6V/f+AqLj/O/Ye+L8diA8dO/m/pbv/v72n3/+tu/f9D45N/K9naYcSFESFoRXQlSCX2rh7g/kgr1u5epIWhiAMCi/3wLD/fVNn/u+fNgtMT5g+6//kmXOB/Jn/PYLCwWrINnDijDlAPBvKJ8NAZC+DIgCkGYRBbJAYSV5GjpTte/b/PwiMkLj0nP8xqVn/Dxw9AY6kwOh40iIFlmzCgUkmKjnjvx0wdu08fMFskJi1mxfxyQY9YetAEzJyQic5YaNnPeTgIDnrjZaHJGMACtTMXoVAJ6sAAAAASUVORK5CYII=","width":400,"height":400,"src":"/static/5f2c129e42248a92c87b13b4293950cf/c684e/ghost.png","srcSet":"/static/5f2c129e42248a92c87b13b4293950cf/c684e/ghost.png 1x"}}]}}}},"relatedPosts":{"totalCount":3,"edges":[{"node":{"id":"b7646ada-6f35-5115-83e5-3a326c8cd1ea","timeToRead":16,"excerpt":"J’ai installé Docker Swarm et Kubernetes sur deux machines virtuelles. J’ai trouvé que Docker Swarm est très facile à installer et à…","frontmatter":{"title":"Docker Swarm vs Kubernetes","subtitle":"J'ai trouvé que Docker Swarm est très facile à installer et à configurer, alors que Kubernetes est un peu plus difficile à installer mais reste simple à utiliser."},"fields":{"slug":"/dockerSwarm-vs-kubernetes/"}}},{"node":{"id":"42e1acee-95a7-5a43-8321-5c9d4e0d19ec","timeToRead":8,"excerpt":"Dans Kubernetes, il existe plusieurs façons de publier une application. Il est donc nécessaire de choisir la bonne stratégie pour rendre…","frontmatter":{"title":"Stratégie de déploiement de Kubernetes","subtitle":"Dans Kubernetes, il y a plusieurs façons de publier une application, il est nécessaire de choisir la bonne stratégie pour rendre votre infrastructure fiable pendant la mise à jour d'une application."},"fields":{"slug":"/k8s-deployement-strategies/"}}},{"node":{"id":"c6aa09b0-1bea-52f2-9d19-126b12c5cc10","timeToRead":4,"excerpt":"Minikube est un outil idéal pour configuer localement Kubernetes afin de tester et d’expérimenter vos déploiements. Dans ce guide, je vais…","frontmatter":{"title":"Configuration locale de Kubernetes avec minikube sur MacOS X","subtitle":""},"fields":{"slug":"/k8s-minikube/"}}}]}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/k8s-deployement-strategies/","prev":{"excerpt":"Minikube est un outil idéal pour configuer localement Kubernetes afin de tester et d’expérimenter vos déploiements. Dans ce guide, je vais…","timeToRead":4,"frontmatter":{"title":"Configuration locale de Kubernetes avec minikube sur MacOS X","subtitle":"","tags":["Kubernetes","DevOps"],"category":["Kubernetes","DevOps"],"date":"2019-05-23T08:00:00.000Z","draft":false,"image":{"childImageSharp":{"fluid":{"aspectRatio":1.7809439002671417,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIFA//EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHN5DxbJYf/xAAaEAACAgMAAAAAAAAAAAAAAAAAAQIDEBET/9oACAEBAAEFAlaRsOmEbZ//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAYEAACAwAAAAAAAAAAAAAAAAAAMgEgMf/aAAgBAQAGPwJhpNp//8QAGhAAAwEAAwAAAAAAAAAAAAAAAAERITFhgf/aAAgBAQABPyHSUvSOU7FgtjtClyf/2gAMAwEAAgADAAAAEGQv/8QAFhEBAQEAAAAAAAAAAAAAAAAAABFB/9oACAEDAQE/EMV//8QAFREBAQAAAAAAAAAAAAAAAAAAEEH/2gAIAQIBAT8Qp//EABoQAQEAAwEBAAAAAAAAAAAAAAEAESExUZH/2gAIAQEAAT8QTFAXqtS5LFXZken2T1hAFInS/9k=","sizes":"(max-width: 2000px) 100vw, 2000px","src":"/static/aac12d8124ce6730c0247f5495bff894/7ac0b/ship.jpg","srcSet":"/static/aac12d8124ce6730c0247f5495bff894/1f72c/ship.jpg 930w,\n/static/aac12d8124ce6730c0247f5495bff894/d7cf8/ship.jpg 1860w,\n/static/aac12d8124ce6730c0247f5495bff894/7ac0b/ship.jpg 2000w"}}},"author":{"id":"ludo","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"fixed":{"src":"/static/5f2c129e42248a92c87b13b4293950cf/c684e/ghost.png"}}]}}},"fields":{"layout":"post","slug":"/k8s-minikube/"}},"next":{"excerpt":"Si vous travaillez dans le terminal, vous utilisez probablement Vim fréquemment. Beaucoup de gens ont une relation d’amour/haine avec Vim…","timeToRead":6,"frontmatter":{"title":"Vim est vulnérable - Mise à jour de Vim sur macOS","subtitle":"Mettez à jour Vim avec la dernière version en quelques minutes.","tags":["Vim","Mac"],"category":["Vim"],"date":"2019-06-23T19:00:00.000Z","draft":false,"image":{"childImageSharp":{"fluid":{"aspectRatio":1,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAMEAQX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABnPJRfYRJ3eAH/8QAHBAAAgICAwAAAAAAAAAAAAAAAQIDEgAEEBMh/9oACAEBAAEFAr+d1Wj3LA4kTSYuqAIoUYcf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAHRAAAgEEAwAAAAAAAAAAAAAAAAEhAhEigRASUf/aAAgBAQAGPwLGndUCqv2a0jKC7Zio9JZdrn//xAAeEAEAAgIBBQAAAAAAAAAAAAABABEhMXEQQWGRof/aAAgBAQABPyHF3pxvUElc2AUQ1SO9Eu7XLPvxqV1b8TNfXZ1Koo6f/9oADAMBAAIAAwAAABCDLzz/xAAWEQEBAQAAAAAAAAAAAAAAAAABESD/2gAIAQMBAT8QVSLj/8QAFxEBAAMAAAAAAAAAAAAAAAAAAREgIf/aAAgBAgEBPxANmn//xAAfEAEBAAIBBAMAAAAAAAAAAAABEQAhMUFRcaEQ4fD/2gAIAQEAAT8QTY2F4eBtwaGwenXlylUwS6h95VQu9P3rN0jXLMAV+uQPeSBaA2V3nVwAAAcAQPj/2Q==","sizes":"(max-width: 1800px) 100vw, 1800px","src":"/static/368261693a41f4548bf3cc82019ebe1a/9882a/vim.jpg","srcSet":"/static/368261693a41f4548bf3cc82019ebe1a/1f72c/vim.jpg 930w,\n/static/368261693a41f4548bf3cc82019ebe1a/9882a/vim.jpg 1800w"}}},"author":{"id":"ludo","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"fixed":{"src":"/static/5f2c129e42248a92c87b13b4293950cf/c684e/ghost.png"}}]}}},"fields":{"layout":"post","slug":"/vim-modelines-vulnerable/"}},"primaryTag":"Kubernetes","primaryCategory":"DevOps"}}}