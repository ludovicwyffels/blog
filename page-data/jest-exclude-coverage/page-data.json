{"componentChunkName":"component---src-templates-post-tsx","path":"/jest-exclude-coverage/","webpackCompilationHash":"28b74a5dec589e4586df","result":{"data":{"logo":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABFUlEQVQY023PvUrDUBTA8ZuCtoMoOLQ4dWhN14x2kEKXFkGoohQ/QBexOHRycAidKkgHHRq69APRoTjFJYODIA6+gSBYfYMmfYLE/5VT6NALP845NyeHc9UoCHZRQvonCLKKE4ZhAXYURTsYoE9dIy5iCzfUJnEdV+RF4iu6ikFH2EPxazzOcJmg4Rnn5C8ysIEOHqTe5/sT3qXOwYOtRr5/wLAqzpCTDXu4p2ETtyjgGJ/cX+se8jeU9fa4RBt5vWENpjzdkoGPcGg4RQsbOMEFmnBRRwVDHEK/yFXfvr/CoPjvZLKcdByDyzWGeajigzorGy0oOeRJiUtITe/pX1XzDk3buIMltSFR/zTtic3060X+8z8PsEUt8G3LVQAAAABJRU5ErkJggg==","width":400,"height":128,"src":"/static/2b5eaa0de166a8b5faebad4955c2200c/647de/ghost-logo.png","srcSet":"/static/2b5eaa0de166a8b5faebad4955c2200c/647de/ghost-logo.png 1x"}}},"markdownRemark":{"html":"<blockquote>\n<p>En génie logiciel, la couverture de code est une mesure utilisée pour décrire le taux de code source exécuté d’un programme quand une suite de test est lancée. Un programme avec une haute couverture de code, mesurée en pourcentage, a davantage de code exécuté durant les tests ce qui laisse à penser qu’il a moins de chance de contenir de bugs logiciels non détectés, comparativement à un programme avec une faible couverture de code1,2. Différentes métriques peuvent être utilisées pour calculer la couverture de code ; les plus basiques sont le pourcentage de sous routine et le pourcentage d’instructions appelées durant l’exécution de la suite de test.</p>\n<p><a href=\"https://fr.wikipedia.org/wiki/Couverture_de_code\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Couverture de code - Wikipedia</a></p>\n</blockquote>\n<p>La couverture de code est généralement utilisée comme mesure de qualité pour les logiciels, par exemple: ‘Notre code doit avoir une couverture de tests de 80% et plus.” La collection de la couverture de test avec Jest est aussi simple que l’utilisation de l’indicateur <code>--coverage</code> sur l’invocation.</p>\n<p>Cet article explique comment ignorer les fichiers, fonctions, lignes et déclarations de la couverture dans Jest en utilisant la configuration ou istanbul pragmas. Ainsi que les raisons et les limites du pourquoi/comment vous feriez une telle chose.</p>\n<h2>Comment Jest calcule-t-il la couverture ?</h2>\n<p>Jest utilise istanbul sous le capot pour calculer la couverture. La plupart du temps, Jest fait abstraction de cela pour l’utilisateur final, tout ce que vous avez à faire dans votre application est d’appeler <code>jest --coverage</code> (et configurer les champs de configuration de couverture appropriés). Le fait qu’istanbul soit utilisé en interne montre, par exemple, que la <a href=\"https://jestjs.io/docs/en/configuration.html#coveragereporters-array-string\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">documentation pour coverageReporters</a> mentionne que “tout <a href=\"https://github.com/istanbuljs/istanbuljs/tree/master/packages/istanbul-reports/lib\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">reporter d’istanbul</a> peut être utilisé”, ce sont en fait les données de couverture collectées et produites qui sont présentées dans les rapports.</p>\n<h2>Pourquoi voudrais-je exclure ou ignorer des fichiers ou lignes de la couverture ?</h2>\n<p>Comme l’ont déclaré les responsables et les auteurs de la bibliothèque de couverture d’istanbul :</p>\n<blockquote>\n<p>Some branches in JS code are typically hard, if not impossible to test. Examples are a hasOwnProperty check, UMD wrappers and so on. Istanbul now has a facility by which coverage can be excluded for certain sections of code.</p>\n<p><a href=\"https://github.com/gotwarlost/istanbul/blob/master/ignoring-code-for-coverage.md#ignoring-code-for-coverage-purposes\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Istanbul - Ignore code for coverage purposes</a></p>\n</blockquote>\n<p>De plus, une couverture à 100 % n’est pas nécessaire ou même raisonnable dans la plupart des cas. Certains fichiers ne contiennent pas de logique (métier). Ou ils contiennent une logique qui échouerait d’une manière très évidente (par exemple, un crash au démarrage).</p>\n<p>Par exemple, le script qui démarrerait une application pourrait se lier à un port, ce qui la rend difficile à tester. Le fichier qui importe toutes les différentes dépendances et <code>app.use()</code> dans un paramètre Express serait un autre candidat pour peut-être éviter l’enfer du test unitaire/du mock de dépendance.</p>\n<p>Une autre classe de fichiers/fonctions que vous pourriez vouloir ignorer à des fins de couverture sont les ‘helpers’ spécifiques aux tests. Peu importe que certains d’entre eux ne soient pas exécutés dans le cadre de tests, car ce n’est pas le code à tester.</p>\n<p>Comme pour beaucoup de choses dans les logiciels, il s’agit de compromis.</p>\n<h2>Exclure/ignorer le(s) fichier(s) de la couverture Jest en n’exécutant pas les tests pertinents à l’aide de la configuration</h2>\n<p>Il y a une option de configuration Jest option <code>testPathIgnorePatterns</code> (<a href=\"https://jestjs.io/docs/en/configuration.html#testpathignorepatterns-array-string\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">voir la documentation pour testPathIgnorePatterns</a>)</p>\n<p>La façon la plus simple de configurer ceci est de le faire via le fichier <code>package.json</code> :</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"jest\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"testPathIgnorePatterns\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">\"&lt;rootDir>/ignore/this/path/\"</span> \n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>Exclure/ignorer le(s) fichier(s) de la couverture en ne l’incluant pas dans la configuration de la collection de couvertures</h2>\n<p>Comme alternative ou augmentation à ne pas exécuter de tests (comme vu précédemment) de la couverture de Jest en ne l’incluant pas dans les rapports de couverture, cela est contrôlé par l’option de configuration <code>collectCoverageFrom</code> Jest (<a href=\"https://jestjs.io/docs/en/configuration.html#collectcoveragefrom-array\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">voir les documents pour Jest collectCoverageFrom</a>).</p>\n<p>Utilisez quelque chose comme ce qui suit :</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"jest\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"collectCoverageFrom\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">\"src/**/{!(ignore-me),}.js\"</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>Important</strong>: assurez-vous d’entourer le nom du fichier ignoré avec ().</p>\n<h2>Exclure/ignorer un fichier de la couverture Jest au niveau du fichier</h2>\n<p>Nous pouvons utiliser istanbul pragmas pour ignorer les fichiers en utilisant le commentaire suivant en haut de chaque fichier :</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">/* istanbul ignore file */</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2>Exclure/ignorer la fonction de la couverture Jest</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">/* istanbul ignore next */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">myFunc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"Not covered but won't appear on coverage reports as such\"</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>Exclure/ignorer une ou plusieurs lignes de la couverture Jest</h2>\n<p><strong>Évitez ceci si vous le pouvez, si vous testez du code, vous devriez probablement tester tout ce code.</strong></p>\n<p><code>istanbul ignore next</code> fonctionne également à ignorer les déclarations, définitions et expressions de JS, ce qui équivaut à ignorer/exclure la ligne de la couverture :</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// this function will appear as uncovered</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">ignoreLine</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/* istanbul ignore next */</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'This line won\\'t appear as uncovered'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>Exclure/ignorer l’énoncé ou la clause de la couverture Jest</h2>\n<p><strong>Évitez ceci si vous le pouvez, si vous testez du code, vous devriez probablement tester tout ce code.</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">myFunc</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/* istanbul ignore else */</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// do some work</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// do some other work</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>Lectures complémentaires</h2>\n<p>Consultez la <a href=\"https://github.com/gotwarlost/istanbul/blob/master/ignoring-code-for-coverage.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">documentation originale d’istanbul sur ignorer du code pour la couverture</a> pour un examen plus approfondi de la façon de procéder dans différentes situations.</p>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"En génie logiciel, la couverture de code est une mesure utilisée pour décrire le taux de code source exécuté d’un programme quand une suite de test est lancée. Un programme avec une haute couverture de code, mesurée en pourcentage, a davantage de code exécuté durant les tests ce qui laisse à penser qu’il a moins de chance de contenir de bugs logiciels non détectés, comparativement à un programme avec une faible couverture de code1,2. Différentes métriques peuvent être utilisées pour calculer la couverture de code ; les plus basiques sont le pourcentage de sous routine et le pourcentage d’instructions appelées durant l’exécution de la suite de test."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://fr.wikipedia.org/wiki/Couverture_de_code","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"Couverture de code - Wikipedia"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"La couverture de code est généralement utilisée comme mesure de qualité pour les logiciels, par exemple: ‘Notre code doit avoir une couverture de tests de 80% et plus.” La collection de la couverture de test avec Jest est aussi simple que l’utilisation de l’indicateur "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"--coverage"}]},{"type":"text","value":" sur l’invocation."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Cet article explique comment ignorer les fichiers, fonctions, lignes et déclarations de la couverture dans Jest en utilisant la configuration ou istanbul pragmas. Ainsi que les raisons et les limites du pourquoi/comment vous feriez une telle chose."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Comment Jest calcule-t-il la couverture ?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Jest utilise istanbul sous le capot pour calculer la couverture. La plupart du temps, Jest fait abstraction de cela pour l’utilisateur final, tout ce que vous avez à faire dans votre application est d’appeler "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"jest --coverage"}]},{"type":"text","value":" (et configurer les champs de configuration de couverture appropriés). Le fait qu’istanbul soit utilisé en interne montre, par exemple, que la "},{"type":"element","tagName":"a","properties":{"href":"https://jestjs.io/docs/en/configuration.html#coveragereporters-array-string","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"documentation pour coverageReporters"}]},{"type":"text","value":" mentionne que “tout "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/istanbuljs/istanbuljs/tree/master/packages/istanbul-reports/lib","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"reporter d’istanbul"}]},{"type":"text","value":" peut être utilisé”, ce sont en fait les données de couverture collectées et produites qui sont présentées dans les rapports."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Pourquoi voudrais-je exclure ou ignorer des fichiers ou lignes de la couverture ?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Comme l’ont déclaré les responsables et les auteurs de la bibliothèque de couverture d’istanbul :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Some branches in JS code are typically hard, if not impossible to test. Examples are a hasOwnProperty check, UMD wrappers and so on. Istanbul now has a facility by which coverage can be excluded for certain sections of code."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://github.com/gotwarlost/istanbul/blob/master/ignoring-code-for-coverage.md#ignoring-code-for-coverage-purposes","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"Istanbul - Ignore code for coverage purposes"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"De plus, une couverture à 100 % n’est pas nécessaire ou même raisonnable dans la plupart des cas. Certains fichiers ne contiennent pas de logique (métier). Ou ils contiennent une logique qui échouerait d’une manière très évidente (par exemple, un crash au démarrage)."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Par exemple, le script qui démarrerait une application pourrait se lier à un port, ce qui la rend difficile à tester. Le fichier qui importe toutes les différentes dépendances et "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"app.use()"}]},{"type":"text","value":" dans un paramètre Express serait un autre candidat pour peut-être éviter l’enfer du test unitaire/du mock de dépendance."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Une autre classe de fichiers/fonctions que vous pourriez vouloir ignorer à des fins de couverture sont les ‘helpers’ spécifiques aux tests. Peu importe que certains d’entre eux ne soient pas exécutés dans le cadre de tests, car ce n’est pas le code à tester."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Comme pour beaucoup de choses dans les logiciels, il s’agit de compromis."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Exclure/ignorer le(s) fichier(s) de la couverture Jest en n’exécutant pas les tests pertinents à l’aide de la configuration"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Il y a une option de configuration Jest option "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"testPathIgnorePatterns"}]},{"type":"text","value":" ("},{"type":"element","tagName":"a","properties":{"href":"https://jestjs.io/docs/en/configuration.html#testpathignorepatterns-array-string","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"voir la documentation pour testPathIgnorePatterns"}]},{"type":"text","value":")"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"La façon la plus simple de configurer ceci est de le faire via le fichier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"package.json"}]},{"type":"text","value":" :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"json"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-json","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-json"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"jest\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"testPathIgnorePatterns\""}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"<rootDir>/ignore/this/path/\""}]},{"type":"text","value":" \n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Exclure/ignorer le(s) fichier(s) de la couverture en ne l’incluant pas dans la configuration de la collection de couvertures"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Comme alternative ou augmentation à ne pas exécuter de tests (comme vu précédemment) de la couverture de Jest en ne l’incluant pas dans les rapports de couverture, cela est contrôlé par l’option de configuration "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"collectCoverageFrom"}]},{"type":"text","value":" Jest ("},{"type":"element","tagName":"a","properties":{"href":"https://jestjs.io/docs/en/configuration.html#collectcoveragefrom-array","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"voir les documents pour Jest collectCoverageFrom"}]},{"type":"text","value":")."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Utilisez quelque chose comme ce qui suit :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"json"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-json","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-json"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"jest\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"collectCoverageFrom\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"src/**/{!(ignore-me),}.js\""}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Important"}]},{"type":"text","value":": assurez-vous d’entourer le nom du fichier ignoré avec ()."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Exclure/ignorer un fichier de la couverture Jest au niveau du fichier"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Nous pouvons utiliser istanbul pragmas pour ignorer les fichiers en utilisant le commentaire suivant en haut de chaque fichier :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"js"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-js","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-js"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"/* istanbul ignore file */"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Exclure/ignorer la fonction de la couverture Jest"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"js"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-js","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-js"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"/* istanbul ignore next */"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"function"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"myFunc"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  console"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"log"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"Not covered but won't appear on coverage reports as such\""}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Exclure/ignorer une ou plusieurs lignes de la couverture Jest"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Évitez ceci si vous le pouvez, si vous testez du code, vous devriez probablement tester tout ce code."}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"istanbul ignore next"}]},{"type":"text","value":" fonctionne également à ignorer les déclarations, définitions et expressions de JS, ce qui équivaut à ignorer/exclure la ligne de la couverture :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"js"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-js","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-js"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// this function will appear as uncovered"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"function"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"ignoreLine"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"/* istanbul ignore next */"}]},{"type":"text","value":"\n  console"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"log"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'This line won\\'t appear as uncovered'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Exclure/ignorer l’énoncé ou la clause de la couverture Jest"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Évitez ceci si vous le pouvez, si vous testez du code, vous devriez probablement tester tout ce code."}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"js"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-js","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-js"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"function"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"myFunc"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","parameter"]},"children":[{"type":"text","value":"a"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"/* istanbul ignore else */"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"if"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"a"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// do some work"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"else"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// do some other work"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Lectures complémentaires"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Consultez la "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/gotwarlost/istanbul/blob/master/ignoring-code-for-coverage.md","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"documentation originale d’istanbul sur ignorer du code pour la couverture"}]},{"type":"text","value":" pour un examen plus approfondi de la façon de procéder dans différentes situations."}]}],"data":{"quirksMode":false}},"excerpt":"En génie logiciel, la couverture de code est une mesure utilisée pour décrire le taux de code source exécuté d’un programme quand une suite de test est lancée. Un programme avec une haute couverture de code, mesurée en pourcentage, a davantage de code exécuté durant les tests ce qui laisse à penser qu’il a moins de chance de contenir de bugs logiciels non détectés, comparativement à un programme avec une faible couverture de code1,2. Différentes métriques peuvent être utilisées pour calculer la couverture de code ; les plus basiques sont le pourcentage de sous routine et le pourcentage d’instructions appelées durant l’exécution de la suite de test. Couverture de code - Wikipedia La couverture de code est généralement utilisée comme mesure de qualité pour les logiciels, par exemple: ‘Notre code doit avoir une couverture de tests de 80% et plus.” La collection de la couverture de test avec Jest est aussi simple que l’utilisation de l’indicateur --coverage sur l’invocation. Cet article explique comment ignorer les fichiers, fonctions, lignes et déclarations de la couverture dans Jest en utilisant la configuration ou istanbul pragmas. Ainsi que les raisons et les limites du pourquoi/comment vous feriez une telle chose. Comment Jest calcule-t-il la couverture ? Jest utilise istanbul sous le capot pour calculer la couverture. La plupart du temps, Jest fait abstraction de cela pour l’utilisateur final, tout ce que vous avez à faire dans votre application est d’appeler jest --coverage (et configurer les champs de configuration de couverture appropriés). Le fait qu’istanbul soit utilisé en interne montre, par exemple, que la documentation pour coverageReporters mentionne que “tout reporter d’istanbul peut être utilisé”, ce sont en fait les données de couverture collectées et produites qui sont présentées dans les rapports. Pourquoi voudrais-je exclure ou ignorer des fichiers ou lignes de la couverture ? Comme l’ont déclaré les responsables et les auteurs de la bibliothèque de couverture d’istanbul : Some branches in JS code are typically hard, if not impossible to test. Examples are a hasOwnProperty check, UMD wrappers and so on. Istanbul now has a facility by which coverage can be excluded for certain sections of code. Istanbul - Ignore code for coverage purposes De plus, une couverture à 100 % n’est pas nécessaire ou même raisonnable dans la plupart des cas. Certains fichiers ne contiennent pas de logique (métier). Ou ils contiennent une logique qui échouerait d’une manière très évidente (par exemple, un crash au démarrage). Par exemple, le script qui démarrerait une application pourrait se lier à un port, ce qui la rend difficile à tester. Le fichier qui importe toutes les différentes dépendances et app.use() dans un paramètre Express serait un autre candidat pour peut-être éviter l’enfer du test unitaire/du mock de dépendance. Une autre classe de fichiers/fonctions que vous pourriez vouloir ignorer à des fins de couverture sont les ‘helpers’ spécifiques aux tests. Peu importe que certains d’entre eux ne soient pas exécutés dans le cadre de tests, car ce n’est pas le code à tester. Comme pour beaucoup de choses dans les logiciels, il s’agit de compromis. Exclure/ignorer le(s) fichier(s) de la couverture Jest en n’exécutant pas les tests pertinents à l’aide de la configuration Il y a une option de configuration Jest option testPathIgnorePatterns (voir la documentation pour testPathIgnorePatterns) La façon la plus simple de configurer ceci est de le faire via le fichier package.json : Exclure/ignorer le(s) fichier(s) de la couverture en ne l’incluant pas dans la configuration de la collection de couvertures Comme alternative ou augmentation à ne pas exécuter de tests (comme vu précédemment) de la couverture de Jest en ne l’incluant pas dans les rapports de couverture, cela est contrôlé par l’option de configuration collectCoverageFrom Jest (voir les documents pour Jest collectCoverageFrom). Utilisez quelque chose comme ce qui suit : Important: assurez-vous d’entourer le nom du fichier ignoré avec (). Exclure/ignorer un fichier de la couverture Jest au niveau du fichier Nous pouvons utiliser istanbul pragmas pour ignorer les fichiers en utilisant le commentaire suivant en haut de chaque fichier : Exclure/ignorer la fonction de la couverture Jest Exclure/ignorer une ou plusieurs lignes de la couverture Jest Évitez ceci si vous le pouvez, si vous testez du code, vous devriez probablement tester tout ce code. istanbul ignore next fonctionne également à ignorer les déclarations, définitions et expressions de JS, ce qui équivaut à ignorer/exclure la ligne de la couverture : Exclure/ignorer l’énoncé ou la clause de la couverture Jest Évitez ceci si vous le pouvez, si vous testez du code, vous devriez probablement tester tout ce code. Lectures complémentaires Consultez la documentation originale d’istanbul sur ignorer du code pour la couverture pour un examen plus approfondi de la façon de procéder dans différentes situations.","timeToRead":4,"frontmatter":{"title":"Jest ignore ou exclut le fichier/fonction/état de la couverture de test","subtitle":"","userDate":"18 August 2019","date":"2019-08-18T09:00:00.000Z","tags":["Node.js","Jest","Javascript"],"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAMCBAH/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgP/2gAMAwEAAhADEAAAAaT9xGmEzPbygxFZ/wD/xAAcEAACAgIDAAAAAAAAAAAAAAAAAQIDERIhIjL/2gAIAQEAAQUC2J1nQfA5YbH5tEf/xAAYEQACAwAAAAAAAAAAAAAAAAAAAgEQEv/aAAgBAwEBPwFmNSPX/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQAQEf/aAAgBAgEBPwELkZ//xAAXEAEBAQEAAAAAAAAAAAAAAAAQAREh/9oACAEBAAY/AjpjKf/EABwQAAICAgMAAAAAAAAAAAAAAAABESExUUFhcf/aAAgBAQABPyHbBC7irLaMSjfODpUWIpwJMmJ6DOD/2gAMAwEAAgADAAAAEHgAwP/EABcRAQEBAQAAAAAAAAAAAAAAAAEQETH/2gAIAQMBAT8QYcl1P//EABYRAQEBAAAAAAAAAAAAAAAAABEAEP/aAAgBAgEBPxBI7//EABsQAQEBAQEAAwAAAAAAAAAAAAERACFBMWFx/9oACAEBAAE/EC2kT85qpApHKq/gG5TwKn01p9Yh9udZx5rLKnTGIciaL13/2Q==","aspectRatio":1,"src":"/static/22ad5d991b79aa0c174819e09d9f9dab/81ef8/cactus.jpg","srcSet":"/static/22ad5d991b79aa0c174819e09d9f9dab/f8f18/cactus.jpg 930w,\n/static/22ad5d991b79aa0c174819e09d9f9dab/81ef8/cactus.jpg 1200w","sizes":"(max-width: 1200px) 100vw, 1200px"}}},"author":{"id":"ludo","name":"Wyffels Ludovic","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAABMUlEQVQ4y2MwsXf5T03MMGogGBvbOYNpUwdXOIbJwdgwNQQNhCk0snX6r2thC8Y6QGxg7QCWA/FBcrgMxepCkAZrV6//EYmpYBydkvHfMzjiv5mj2//whJT/Nm7ecEMJGgjykp6V/f+AqLj/O/Ye+L8diA8dO/m/pbv/v72n3/+tu/f9D45N/K9naYcSFESFoRXQlSCX2rh7g/kgr1u5epIWhiAMCi/3wLD/fVNn/u+fNgtMT5g+6//kmXOB/Jn/PYLCwWrINnDijDlAPBvKJ8NAZC+DIgCkGYRBbJAYSV5GjpTte/b/PwiMkLj0nP8xqVn/Dxw9AY6kwOh40iIFlmzCgUkmKjnjvx0wdu08fMFskJi1mxfxyQY9YetAEzJyQic5YaNnPeTgIDnrjZaHJGMACtTMXoVAJ6sAAAAASUVORK5CYII=","width":400,"height":400,"src":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png","srcSet":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png 1x"}}]}}}},"relatedPosts":{"totalCount":27,"edges":[{"node":{"id":"5a9f4e28-76a1-5c32-9601-a4e1921c3776","timeToRead":5,"excerpt":"Bien que le titre de cet article soit un peu trompeur, car nous ne souhaitons pas vraiment communiquer directement entre les composants. Nos composants doivent être isolés et encapsulés. J’ai choisi ce titre parce que je pense que les développeurs aux prises avec ce problème le googleront de cette façon. Comment communiquer entre les composants? C’est le sujet sur lequel j’ai vu beaucoup de nouveaux développeurs angular lutter pour communiquer entre les composants. Je vais vous montrer les trois approches les plus courantes, avec des exemples qui correspondent à différents cas d’utilisation. Il y a aussi le “moyen de redux” que je pourrais couvrir dans un autre article à l’avenir.   Imaginez le cas d’utilisation de la barre latérale dans votre application. La barre latérale est ouverte ou fermée. Vous avez le composant side-bar et ensuite vous avez un composant (ou plusieurs composants) qui peuvent l’ouvrir / le fermer ou demander son état. Je décrirai trois manières de mettre en oeuvre ce comportement Passer la référence d’un composant à un autre Communication par le composant parent Communication à travers le service  1. Passer la référence d’un composant à un autre Cette solution doit être utilisée lorsque les composants ont une dépendance entre eux. Par exemple, dropdown et dropdown toggle. Ils ne peuvent généralement pas exister l’un sans l’autre.  Demo Nous allons créer le composant side-bar-toggle qui aura le composant side-bar en entrée et en cliquant sur le bouton bascule nous ouvrirons / fermerons le composant side-bar. Voici le code pertinent:  app.component.html side-bar-toggle.component.ts side-bar.component.ts 2. Communication par le composant parent Peut être utilisé lorsqu’il est facile de contrôler l’état partagé entre des composants via leur composant parent et que vous ne souhaitez pas créer de nouveau service ou créer du code standard, à cause d’une variable.  Demo La mise en oeuvre de cette approche est presque la même que la précédente, mais le composant side-bar-toggle ne reçoit pas de composant side-bar. Au lieu de cela, le composant parent contient la propriété sideBarIsOpened qui est transmise au composant side-bar. app.component.html app.component.ts side-bar-toggle.component.ts side-bar.component.ts 3. Communication à travers le service Enfin, cette option est utile et doit être utilisée lorsque vous avez un composant contrôlé ou que son état est demandé à plusieurs instances.   Nous avons maintenant plusieurs emplacements dans l’application qui devront accéder à notre composant sibe-bar. Voyons comment nous le faisons. Nous allons maintenant créer side-bar.service.ts donc nous aurons: side-bar.service.ts side-bar.component.ts side-bar.component.html  Les services de la barre latérale auront une méthode et un événement à changer pour que chaque composant qui injectera ce service puisse être averti de l’ouverture ou de la bascule d’un panneau. Dans cet exemple, aucun composant latéral ni composant latéral ne comporte de paramètres d’entrée, car ils communiquent via le service. Maintenant le code:  app.component.html side-bar-toggle.component.ts side-bar.component.ts side-bar.service.ts","frontmatter":{"title":"3 façons de communiquer entre les composants Angular","subtitle":""},"fields":{"slug":"/angular-3way-communication/"}}},{"node":{"id":"5781f9e3-7217-5de4-a788-eae72ca9f482","timeToRead":2,"excerpt":"La plupart des exemples de code couvrant le kit AWS SDK comme ci-dessous, c’est à dire qu’ils importent l’intégralité du kit AWS même s’ils utilisent seulement quelques services AWS, parfois un seul (AWS DynamoDB).  Cependant, la méthode recommandée pour initialiser divers clients de service AWS consiste à ne les importer que lorsque nécessaire, comme ci-dessous. Économise des temps de chargement et de la mémoire précieux, particulièrement utile dans les environnements à ressources de calcul comme un périphérique IoT ou dans une fonction AWS Lamba.  NB: vous pouvez toujours accéder à l’espace de noms AWS global sans chaque service AWS associé en écrivant sous le code. Cette technique est utile lorsque vous appliquez la même configuration à plusieurs services AWS individuels, par exemple pour fournir les mêmes informations d’identification à tous les services AWS. const aws = require('aws-sdk/global'); Consultez la documentation officielle d’AWS pour plus d’informations ci-dessous. https://docs.aws.amazon.com/sdk-for-javascript/v2/developer-guide/creating-and-calling-service-objects.html Bonne programmation!","frontmatter":{"title":"AWS SDK pour Node.js: Meilleures pratiques","subtitle":""},"fields":{"slug":"/aws-sdk/"}}},{"node":{"id":"f3d9e7d1-3a29-5f66-b17f-926e06970fe8","timeToRead":5,"excerpt":"Cet article explique comment utiliser Travis CI pour surveiller les modifications apportées à la branche principale de notre référentiel GitHub . Nous allons configurer Travis CI de manière à ce que lors de la mise en place d’un nouveau commit pour notre application Angular, celui-ci: Exécuter le linter Lancer nos tests unitaires Lancer nos tests E2E Construire notre application pour la production Déployé vers GitHub Pages Définitions Test continu (CT) Les tests continus consistent à exécuter des tests automatisés dans le cadre du pipeline de livraison de logiciels pour obtenir un retour immédiat sur les risques commerciaux associés à une version candidate du lociel. Intégration Continue (CI) L’intégration continue est un ensemble de pratiques utilisées en génie logiciel consistant à vérifier à chaque modification de code source que le résultat des modifications ne produit pas de régression dans l’application développée. En pratique Ok, ces définitions sont bien. Mais, en pratique, qu’est-ce qu’ils signifient vraiment? Pour les besoins de cet article, je vais utiliser des définitions similaires, mais très pragmatiques et spécifiques: CT Nos tests sont exécutés automatiquement avant chaque déploiement. Et notre code ne sera pas déployé si des tests échouent. CI Transférer des modifications dans une branche spécifique de notre repo GitHub lance un processus de déploiement automatisé. Créer une application Angular Pour commencer, créez une nouvelle application Angular en utilisant Angular CLI. Aller sur: http://localhost:4200 GitHub Créer un nouveau repo GitHub: travis-demo Nous devons maintenant ajouter le repo GitHub en tant que distant de notre repo Git local. Vous devrez peut-être d’abord vous engager si vous avez effectué des mises à jour. Assurez-vous de remplacer ludovicwyffels par votre propre identifiant GitHub. Travis CI Inscrivez-vous à Travis CI en utilisant votre compte GitHub. Accédez à votre profil pour voir la liste des repos. Si vous avez déjà un compte, vous devrez utiliser le bouton Sync account pour que votre nouveau repo apparaisse dans la liste. De plus, vous devrez peut-être utiliser le filtre pour voir réellement votre repo si vous en avez beaucoup. Vous pouvez cliquer sur le bouton Paramètres à droite du repo. Ajouter une configuration Travis CI Afin de dire à Travis CI de faire quelque chose avec notre repo, nous devons ajouter un fichier de configuration Travis CI. Créez un fichier à la racine de votre espace de travail appelé .travis.yml avec le contenu suivant: Pour le --base-ref vous devrez utiliser votre propre identifiant GitHub. Ce fichier indique à Travis CI de procéder comme suit: Utilisez Node.js Surveillez uniquement la branche principale pour connaître les modifications. Avant d’exécuter l’un des scripts, installez Angular CLI Assurez-vous que l’application respecte nos règles en matière de linting utilisant ng lint. Construisez notre application en utilisant ng build. Après avoir ajouté le fichier de configuration Travis CI, commiter et pousser. Après avoir effectué cette opération, passez au tableau de bord Travis CI pour afficher le journal Travis CI au fur et à mesure de la création de votre application. Vous devrez peut-être cliquer sur l’onglet Current pour le voir se développer. À l’extrême droite du journal, vous pouvez cliquer sur Follow log pour faciliter l’affichage du journal mis à jour. Une fois que Travis CI a terminé notre script et créé l’application, vous verrez l’icône virer au vert pour vous informer que votre script s’est terminé avec succès. Test continu Maintenant que nous avons créé nos applications, allons dans le monde des tests continus en laissant Travis CI exécuter nos tests unitaires à chaque nouveau commit. Malheureusement, nous ne pouvons pas simplement npm run test sur Travis CI. En effet, nous ne pouvons pas réellement lancer une interface graphique de navigateur. Nous allons donc utiliser Headless Chrome pour exécuter nos tests unitaires. Suivez les instructions pour créer un nouveau script npm comme celui-ci: Nous pouvons maintenant exécuter nos tests unitaires en utilisant Headless Chrome comme ceci: Maintenant, ajouter npm run test-headless à notre fichier .travis.yml dans la section script comme ceci: Commiter et push sur GitHub: Après avoir pusher, passez au tableau de bord Travis CI pour regarder votre projet exécuter les tests unitaires, puis faire le build. Intégration continue Maintenant que nous testons et buildons, nous souhaitons déployer notre application. Nous devons créer un jeton d’accès personnel GitHub. Suivez ces instructions. Dans le tableau de bord Travis CI, accédez à votre projet. En haut à droite, cliquez sur Paramètres. Faites défiler jusqu’à la section Variables d’environnement. Ajoutez une nouvelle variable d’environnement nommée: GITHUB_TOKEN Pour la valeur, collez la valeur réelle de votre jeton d’accès personnel GitHub que vous avez généré. Cliquez sur Ajouter. Déploiement sur les pages GitHub Enfin, configurons Travis CI pour le déploiement sur GitHub Pages. Ajoutez une section de déploiement à votre .travis.yml. A ce stade, votre fichier devrait resembler à ceci: Encore une fois, assurez-vous que vous utilisez votre propre identifiant GitHub au lien de ludovicwyffels. Ceci indique à Travis CI d’utiliser notre jeton GitHub à partir de la variable d’environnement: GITHUB_TOKEN En outre, il spécifie que les fichiers à déployer proviennent de notre dossier dist: dist/travis-demo Engagez-vous et appuyez sur GitHub: Nous devrions également pouvoir accéder à l’URL de nos pages GitHub et voir notre application déployée.","frontmatter":{"title":"Angular DevOps: CT/CI avec Travis CI et Github Pages","subtitle":"Utilisation de Travis CI pour implémenter les tests continus (CT) et l'intégration continue (CI) afin de déployer notre application Angular sur Github Pages"},"fields":{"slug":"/angular-travis-ctci/"}}}]}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/jest-exclude-coverage/","prev":{"excerpt":"Nous sommes tous passés par là. Qu’il s’agisse d’un calendrier serré, de corrections constantes ou simplement de la création de messages avec notre propre modèle défini; nous avons tous fait de mauvais messages de commit. Heureusement pour nous, la spécification Conventional Commits existe, et avec elle un ensemble d’outils puissants pour nous aider. Application d’une norme Pour faire respecter une norme à chaque fois que nous nous faisons un commit, nous avons husky et commitling. Husky écoute les git hooks, et nous l’utiliserons pour déclencher le commitlint lorsque nous tapons un message de commit. Maintenant, installons les paquets : Après avoir installé ces paquets, vous devez créer un fichier commitlint.config.js dans le même dossier que votre package.json : Et modifier votre package.json: Tout est prêt! Maintenant, vos messages seront linted. Nous les commitons avec commitizen Commitizen est un paquet qui facilite la création de messages de commit selon la spécification précédente. Pour ce faire, vous devez l’installer globalement et configurer votre projet. Maintenant, faites un changement, ajoutez-le et lancez git cz. Automatisation Nous avons ajouté des outils pour assurer et faciliter la validation des messages de commit selon les spécifications conventionnelles de commit. Non seulement nous avons reçu des messages standard sur l’ensemble du projet que les humains peuvent lire, mais aussi des machines. Oui, des machines. Le respect de ces normes a permis aux machines de comprendre le motif, et avec cela, de mettre à jour automatiquement la version de nos paquets et de générer des changelogs. Version bumping et CHANGELOG Pour faire les deux actions, nous n’avons besoin que d’un seul paquet, standard-version. Ce paquet le fera: Analyser vos engagements depuis votre dernière version (tag) Version bump votre paquet.json Générer ou mettre à jour un fichier CHANGELOG.md Générer un message de livraison Générer une nouvelle balise Utilisons-la donc : Mettez à jour votre paquet.json : Et maintenant vous n’avez plus qu’à lancer npm run release. Alternativement, si vous souhaitez simplement générer un fichier changelog, je vous recommande le fichier conventionnel-changelog-cli. Quelle est la prochaine étape? Après avoir gagné en lisibilité et en automatisation des tâches quotidiennes douloureuses, vous pouvez créer votre propre standard basé sur les spécifications conventionnelles de commit. La famille d’outils conventionnel-changelog vous permet et vous facilite la création de votre propre version si vous le souhaitez. J’espère que ce message vous a aidé. S’il y a quoi que ce soit, partagez de l’information qui pourrait l’améliorer et la rendre meilleure pour les autres!","timeToRead":2,"frontmatter":{"title":"Bien gérer ses textes de commit (partie 2)","subtitle":"Mettons en place l'application de la norme \"conventional-changelog\" pour un nouveau projet","tags":["Git","Node.js"],"category":["Git","Node.js"],"date":"2019-08-11T18:00:00.000Z","draft":false,"image":{"childImageSharp":{"fluid":{"aspectRatio":1.5056461731493098,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIDBf/EABYBAQEBAAAAAAAAAAAAAAAAAAACA//aAAwDAQACEAMQAAABVLywQM4t/8QAGRABAQEAAwAAAAAAAAAAAAAAAgEAAxIi/9oACAEBAAEFAjYbGa/OO5x2O//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABYRAQEBAAAAAAAAAAAAAAAAAAABEv/aAAgBAgEBPwFiP//EAB0QAAIBBAMAAAAAAAAAAAAAAAABMgIQERIhQVH/2gAIAQEABj8ClwVbPD6JCG/Lf//EABwQAAMAAgMBAAAAAAAAAAAAAAABESExQVGBkf/aAAgBAQABPyGUSNvqLg0lKYL1eiZVcsToWHs//9oADAMBAAIAAwAAABAzL//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/ECf/xAAWEQEBAQAAAAAAAAAAAAAAAAABMRD/2gAIAQIBAT8QFjMP/8QAHBABAAICAwEAAAAAAAAAAAAAAQARIUExUZFh/9oACAEBAAE/EAltBA8O42KxjwXf2Jc+6ZIoPW0uXQptIchpjqk//9k=","sizes":"(max-width: 1200px) 100vw, 1200px","src":"/static/bb024aed8b63b69834a2bfb23baa20cf/81ef8/nature.jpg","srcSet":"/static/bb024aed8b63b69834a2bfb23baa20cf/f8f18/nature.jpg 930w,\n/static/bb024aed8b63b69834a2bfb23baa20cf/81ef8/nature.jpg 1200w"}}},"author":{"id":"ludo","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"fixed":{"src":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png"}}]}}},"fields":{"layout":"post","slug":"/git-manage-commit-text-part2/"}},"next":null,"primaryTag":"Node.js","primaryCategory":"Node.js"}}}