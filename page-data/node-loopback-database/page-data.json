{"componentChunkName":"component---src-templates-post-tsx","path":"/node-loopback-database/","webpackCompilationHash":"28b74a5dec589e4586df","result":{"data":{"logo":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABFUlEQVQY023PvUrDUBTA8ZuCtoMoOLQ4dWhN14x2kEKXFkGoohQ/QBexOHRycAidKkgHHRq69APRoTjFJYODIA6+gSBYfYMmfYLE/5VT6NALP845NyeHc9UoCHZRQvonCLKKE4ZhAXYURTsYoE9dIy5iCzfUJnEdV+RF4iu6ikFH2EPxazzOcJmg4Rnn5C8ysIEOHqTe5/sT3qXOwYOtRr5/wLAqzpCTDXu4p2ETtyjgGJ/cX+se8jeU9fa4RBt5vWENpjzdkoGPcGg4RQsbOMEFmnBRRwVDHEK/yFXfvr/CoPjvZLKcdByDyzWGeajigzorGy0oOeRJiUtITe/pX1XzDk3buIMltSFR/zTtic3060X+8z8PsEUt8G3LVQAAAABJRU5ErkJggg==","width":400,"height":128,"src":"/static/2b5eaa0de166a8b5faebad4955c2200c/647de/ghost-logo.png","srcSet":"/static/2b5eaa0de166a8b5faebad4955c2200c/647de/ghost-logo.png 1x"}}},"markdownRemark":{"html":"<h2>Introduction</h2>\n<p>Presque toutes les applications Web ont besoin de conserver des données sous une forme ou une autre. LoopBack a toujours abstrait le moteur de base de données de l’application en nous fournissant plusieurs connecteurs à utiliser, tels que : MySQL, Postgres et In-memory. LoopBack 4 utilise les mêmes bibliothèques sous-jacentes que LoopBack 3 pour passer la configuration aux moteurs. Cependant, les structures du projet sont légèrement différentes, comme indiqué ci-dessous.</p>\n<h2>Configuration de LoopBack 3</h2>\n<p>Dans LoopBack 3, vous définiriez un ensemble d’objets JSON à l’intérieur d’un fichier <code>datasources.json</code> stocké dans le dossier serveur, ce qui permettrait à l’application de récupérer la configuration. Le fichier ressemblerait à ceci :</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"db\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"db\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"connector\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"memory\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Ce fichier définit une nouvelle source de données appelée “db”, qui est configurée pour utiliser le connecteur de base de données en mémoire. Dans la plupart des applications, c’est une excellente source de données par défaut pour les modèles, car elle élimine le besoin de configurer un serveur de base de données lors du premier démarrage avec un prototype. Vous pouvez simplement configurer les modèles pour utiliser la source de données “db” et continuer avec le code.</p>\n<p>Le fichier <code>model-config.json</code>, dans le même dossier, relierait un modèle à une source de données et ressemblerait à ceci :</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"_meta\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"sources\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">\"loopback/common/models\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"loopback/server/models\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"../common/models\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"./models\"</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"mixins\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">\"loopback/common/mixins\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"loopback/server/mixins\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"../common/mixins\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"./mixins\"</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Person\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"dataSource\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"db\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"public\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  ...\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Une fois que vous avez la base de votre application en place et en cours d’exécution par rapport à la configuration de la base de données en mémoire, vous pouvez vous concentrer sur la configuration d’un serveur de base de données, tel que MySQL ou Postgres, installer le bon connecteur et simplement modifier la configuration <code>datasources.json</code> comme suit :</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"db\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"db\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"connector\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"mysql\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"hostname\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">3306</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"user\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"root\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"password\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"root\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"database\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"app_database\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>C’est excellent pour le développement local. Mais, lorsque vous travaillez au sein d’une équipe plus importante ou avec plusieurs environnements, un seul fichier de configuration JSON ne va pas le couper. LoopBack 3 a résolu la configuration spécifique à l’environnement en nous permettant de créer des fichiers de sources de données spécifiques à l’environnement. Le nom du fichier de source de données spécifique à l’environnement devait être dans une certaine structure : <code>datasources.&#x3C;environment>.js</code>. Un projet avec 3 environnements aurait les fichiers suivants :</p>\n<ul>\n<li>datasources.json (une configuration de serveur de base de données locale)</li>\n<li>datasources.test.js (une configuration de serveur de base de données de test)</li>\n<li>datasources.production.js (une configuration de serveur de base de données de production)</li>\n</ul>\n<p>La version JavaScript du fichier de configuration nous a donné une flexibilité supplémentaire, car nous avons pu déterminer la configuration à l’aide de code. Le fichier de configuration le plus courant utilise les variables d’environnement système. Un exemple de fichier de configuration d’une source de données de production serait le suivant :</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  db<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token string\">'db'</span><span class=\"token punctuation\">,</span>\n    connector<span class=\"token punctuation\">:</span> <span class=\"token string\">'mysql'</span><span class=\"token punctuation\">,</span>\n    hostname<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_HOST</span><span class=\"token punctuation\">,</span>\n    port<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_PORT</span><span class=\"token punctuation\">,</span>\n    user<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_USER</span><span class=\"token punctuation\">,</span>\n    password<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_PASSWORD</span><span class=\"token punctuation\">,</span>\n    database<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_DATABASE</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>C’est génial, car cela élimine le besoin de stocker les références de production dans notre code. Nous pourrions livrer ces fichiers de configuration et configurer la configuration sur le serveur, en toute sécurité.</p>\n<p>Par défaut, le framework utiliserait la variable d’environnement système NODE_ENV pour choisir le fichier source à utiliser. Un serveur de production aurait les variables d’environnement suivantes :</p>\n<ul>\n<li>NODE_ENV=production</li>\n<li>DB_HOST=aws-rds-mysql-host.example.com</li>\n<li>DB_PORT=3306</li>\n<li>DB_USER=super-secret-user</li>\n<li>DB_PASSWORD=super-secret-password</li>\n<li>DB<em>DATABASE=app</em>database</li>\n</ul>\n<h2>Configuration LoopBack 4</h2>\n<p>LoopBack 4 ne lit plus automatiquement les fichiers de configuration des sources de données. Au lieu de cela, le framework nous laisse décider comment nous voulons configurer notre application. Pour l’instant, il ne semble pas qu’il existe de meilleures pratiques documentées pour la mise en place d’un tel système. Une approche est suggérée ci-dessous.</p>\n<h3>Dépendance Injection</h3>\n<p>Avant de nous plonger dans la configuration de la base de données, nous devons comprendre l’un des concepts clés de LoopBack 4 : <a href=\"https://loopback.io/doc/en/lb4/Dependency-injection.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Injection de dépendance</a>.</p>\n<p>Essentiellement, l’application peut enregistrer des valeurs sur une liste de clés uniques. Ces valeurs peuvent contenir des variables normales ou des définitions de classes, que l’application peut ensuite utiliser pour gérer la création de ces objets pour nous, en reprenant les dépendances requises.</p>\n<p>Par exemple, on peut enregistrer une valeur,‘bar’ sur une clé ‘foo’.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span><span class=\"token string\">'bar'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Maintenant l’application sait que la clé ‘foo’, contient la valeur ‘bar’. Nous pouvons demander cette valeur à partir de l’application n’importe où dans notre code. À titre d’exemple :</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\">@<span class=\"token function\">inject</span><span class=\"token punctuation\">(</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">private</span> foo<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>En plus de lier une valeur à une clé, nous pouvons lier une classe à une clé et laisser l’application calculer récursivement ses dépendances lors de l’instanciation de l’objet sur demande.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Foo</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span>@<span class=\"token function\">inject</span><span class=\"token punctuation\">(</span><span class=\"token string\">'bar'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">private</span> bar<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token function\">someMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bar<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">...</span>\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token string\">'bar'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Bar'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toClass</span><span class=\"token punctuation\">(</span>Foo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Quand nous demandons une instance de la classe Foo, comme suit:</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\">@<span class=\"token function\">inject</span><span class=\"token punctuation\">(</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">private</span> foo<span class=\"token punctuation\">:</span> Foo</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Le conteneur d’application verra que la classe Foo dépend de la valeur de la barre. Il le recherchera dans le conteneur de dépendances, le trouvera (s’il est lié) et l’injectera ensuite dans la classe. D’où l’<strong>injection de dépendance</strong>.</p>\n<h2>Créer un nouveau projet</h2>\n<p>On peut utiliser la CLI pour créer un nouveau projet en appelant la commande suivante :</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">lb4 app</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">? Project name: my-api\n? Project description: My API\n? Project root directory: my-api\n? Application class name: MyApiApplication\n? Select features to enable in the project Enable tslint, Enable prettier, Enable mocha, Enable loopbackBuild, Enable vscode, Enable repositories, Enable services</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> ./my-api</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>LoopBack 4 ajoute un dossier datasources au projet.</p>\n<p>Initialement, on supposerait que ce dossier est configuré pour être lu de la même manière que les fichiers JSON des sources de données LoopBack 3. Cependant, c’est juste le dossier par défaut utilisé par le CLI pour y déposer les nouveaux fichiers.</p>\n<h2>Ajout d’une source de données à l’aide de l’interface CLI</h2>\n<p>Utilisez le CLI pour créer une nouvelle source de données en exécutant la commande suivante :</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">lb4 datasource</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">? Datasource name: db\n? Select the connector for db: In-memory db (supported by StrongLoop)\n? window.localStorage key to use for persistence (browser only):\n? Full path to file for persistence (server only):\ncreate src/datasources/db.datasource.json\ncreate src/datasources/db.datasource.ts\nupdate src/datasources/index.ts\nDatasource db was created in src/datasources/</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>La première chose que vous remarquerez est que le fichier db.datasource.json est exactement le même que le fichier LoopBack 3 datasources.json. Dans l’assistant CLI, j’ai choisi le connecteur en mémoire, qui est l’un des nombreux connecteurs disponibles dans LoopBack 3 et LoopBack 4.</p>\n<p>Le nouvel ajout à la famille de fichiers de source de données LoopBack est le fichier <code>datasource.ts</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>inject<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@loopback/core'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>juggler<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@loopback/repository'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> config <span class=\"token keyword\">from</span> <span class=\"token string\">'./db.datasource.json'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">DbDataSource</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">juggler<span class=\"token punctuation\">.</span>DataSource</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">static</span> dataSourceName <span class=\"token operator\">=</span> <span class=\"token string\">'db'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span>\n    @<span class=\"token function\">inject</span><span class=\"token punctuation\">(</span><span class=\"token string\">'datasources.config.db'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>optional<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    dsConfig<span class=\"token punctuation\">:</span> object <span class=\"token operator\">=</span> config<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>dsConfig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>La classe étend un type <code>juggler.DataSource</code>, qui est le même type que celui utilisé dans LoopBack 3 (sauf que c’est la version de définition TypeScript). Il nécessite la même structure de configuration JSON que LoopBack 3. Dans cette version, nous devons passer la configuration à la super méthode du constructeur.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> config <span class=\"token keyword\">from</span> <span class=\"token string\">'./db.datasource.json'</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">...</span>\n<span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span>\n  @<span class=\"token function\">inject</span><span class=\"token punctuation\">(</span><span class=\"token string\">'datasources.config.db'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>optional<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  dsConfig<span class=\"token punctuation\">:</span> object <span class=\"token operator\">=</span> config\n<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">...</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Le fichier importe la configuration par défaut du fichier <code>db.datasource.json</code> et l’inclut comme valeur par défaut dans le paramètre <code>dsConfig</code> du constructeur. Cela signifie que nous n’aurons jamais besoin de passer quoi que ce soit dans le constructeur de la classe DbDataSource lors de l’instanciation d’une instance de l’objet, à moins de l’écraser… peut-être pour un environnement différent (nous y reviendrons).</p>\n<p>L’autre décorateur d’injection peu familier permet au framework d’injecter la valeur du paramètre depuis le conteneur d’injection de dépendance (s’il est lié).</p>\n<p>Dans cette optique, il existe de nombreuses façons d’instancier cette nouvelle classe DataSource :</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token comment\">// 1. With the default configuration from db.datasource.json</span>\n<span class=\"token keyword\">let</span> dbDataSource <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DbDataSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 2. Overwriting the default configuration</span>\n<span class=\"token keyword\">let</span> dbDataSource <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DbDataSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  name<span class=\"token punctuation\">:</span> <span class=\"token string\">'db'</span><span class=\"token punctuation\">,</span>\n  connector<span class=\"token punctuation\">:</span> <span class=\"token string\">'mysql'</span><span class=\"token punctuation\">,</span>\n  hostname<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_HOST</span><span class=\"token punctuation\">,</span>\n  port<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_PORT</span><span class=\"token punctuation\">,</span>\n  user<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_USER</span><span class=\"token punctuation\">,</span>\n  password<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_PASSWORD</span><span class=\"token punctuation\">,</span>\n  database<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_DATABASE</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Nous avons maintenant une instance de notre dbDataSource. Mais, comment l’utilise-t-on réellement ? Comment notre nouvelle application connaît-elle notre source de données ?</p>\n<p>De la même manière que nous pouvons enregistrer (ou lier) des valeurs (ou classes) contre les applications Dependency Container, nous pouvons lier l’instance de la source de données à une clé du conteneur.</p>\n<p>Dans notre fichier <code>application.ts</code>, nous pouvons utiliser la fonction de liaison des applications dans le constructeur pour lier notre instance à l’application :</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token string\">'datasources.db'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">DbDataSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>En outre, LoopBack 4 a une fonction spéciale appelée source de données :</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">dataSource</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">DbDataSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Il existe une dernière méthode pour lier notre source de données à l’application:</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token string\">'datasources.config.db'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  name<span class=\"token punctuation\">:</span> <span class=\"token string\">'db'</span><span class=\"token punctuation\">,</span>\n  connector<span class=\"token punctuation\">:</span> <span class=\"token string\">'mysql'</span><span class=\"token punctuation\">,</span>\n  hostname<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_HOST</span><span class=\"token punctuation\">,</span>\n  port<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_PORT</span><span class=\"token punctuation\">,</span>\n  user<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_USER</span><span class=\"token punctuation\">,</span>\n  password<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_PASSWORD</span><span class=\"token punctuation\">,</span>\n  database<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_DATABASE</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token string\">'datasources.db'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toClass</span><span class=\"token punctuation\">(</span>DbDataSource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>L’extrait de code ci-dessus lie d’abord la configuration à la clé de dépendance ’\n<code>datasources.config.db</code>. Cette clé de dépendance est référencée dans le constructeur de la classe DbDataSource via le décorateur inject. En liant la clé <code>datasources.db</code> à la définition de classe “DbDataSource”, le conteneur de dépendances va rechercher toutes ses dépendances et les instancier pour nous.</p>\n<p>Maintenant que le conteneur de dépendances de l’application connaît notre source de données, nous pouvons la lier à un référentiel et un modèle.</p>\n<p>Note : vous devez d’abord générer un modèle avant de générer un référentiel. Pour ce faire, utilisez la commande modèle lb4 :</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">lb4 model</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">? Model class name: Person\n? Please select the model base class Entity\nLet&#39;s add a property to Person\nEnter an empty property name when done\n? Enter the property name: id\n? Property type: number\n? Is id the ID property? Yes\n? Is it required?: Yes\n? Default value [leave blank for none]:\nLet&#39;s add another property to Person\nEnter an empty property name when done\n? Enter the property name:\ncreate src/models/person.model.ts\nupdate src/models/index.ts\nModel Person was created in src/models/</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Après avoir créé un modèle, relions-le à un nouveau référentiel. Utilisez la commande lb4 repository :</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">lb4 repository</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">? Please select the datasource DbDatasource\n? Select the model(s) you want to generate a repository Person\n? Please enter the name of the ID property for Person: id\ncreate src/repositories/person.repository.ts\nupdate src/repositories/index.ts\nRepository Person was created in src/repositories/</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Une fois que vous avez utilisé le modèle lb4 et la commande lb4 repository, vous devriez vous retrouver avec un référentiel lié à un modèle qui injecte la classe DbDataSource :</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PersonRepository</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">DefaultCrudRepository</span><span class=\"token operator\">&lt;</span>\n  Person<span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">typeof</span> <span class=\"token class-name\">Person</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span>id\n<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n  \n  <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span>\n    @<span class=\"token function\">inject</span><span class=\"token punctuation\">(</span><span class=\"token string\">'datasources.db'</span><span class=\"token punctuation\">)</span> dataSource<span class=\"token punctuation\">:</span> DbDataSource<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>Person<span class=\"token punctuation\">,</span> dataSource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Notez que le constructeur PersonRepository utilise à nouveau le décorateur inject mais cette fois-ci il fait référence à la clé <code>datasources.db</code> que nous avons définie précédemment. Le référentiel est responsable de la connexion du modèle à la source de données et fournit les fonctions CRUD (Create, Read, Update and Delete), grâce à la classe <code>DefaultCrudRepository</code> dont nous héritons.</p>\n<p>De la même manière que nous avons lié la source de données à l’application, nous devons lier le référentiel à l’application :</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">repository</span><span class=\"token punctuation\">(</span>PersonRepository<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Une fois enregistré, nous pouvons utiliser la commande contrôleur lb4 pour créer un nouveau contrôleur REST pour nous, qui utilise notre nouveau modèle de configuration, source de données et référentiel :</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">lb4 controller</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">? Controller class name: People\n? What kind of controller would you like to generate? REST Controller with CRUD functions\n? What is the name of the model to use with this CRUD repository? Person\n? What is the name of your CRUD repository? PersonRepository\n? What is the type of your ID? number\n? What is the base HTTP path name of the CRUD operations? /people\ncreate src/controllers/people.controller.ts\nupdate src/controllers/index.ts\nController People was created in src/controllers/</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Vous pouvez enregistrer le contrôleur contre l’application de la même manière que nous avons la source de données et le référentiel. En plus d’utiliser les fonctions de référentiel et de contrôleur pour lier nos classes à notre application, LoopBack les lie automatiquement pour nous. Ceci peut être configuré dans le constructeur de classe d’application :</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bootOptions <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  controllers<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Customize ControllerBooter Conventions here</span>\n    dirs<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'controllers'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    extensions<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'.controller.js'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    nested<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Ceci indique à notre application de regarder à l’intérieur du dossier Contollers pour tous nos contrôleurs et appelle automatiquement this.controller pour nous. Vous pouvez également configurer la valeur du référentiel bootOptions pour faire de même avec les référentiels.</p>\n<p>Nous n’analyserons pas ici l’ensemble du fichier du contrôleur pour gagner de la place. Les sections importantes seront soulignées :</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span>\n  <span class=\"token parameter\">@<span class=\"token function\">repository</span><span class=\"token punctuation\">(</span>PersonRepository<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">public</span> personRepository <span class=\"token punctuation\">:</span> PersonRepository<span class=\"token punctuation\">,</span></span>\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Le décorateur du référentiel s’enroule autour du décorateur d’injection. C’est la même chose que de faire ce qui suit :</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span>\n  @<span class=\"token function\">inject</span><span class=\"token punctuation\">(</span><span class=\"token string\">'repositories.PersonRepository'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">public</span> personRepository <span class=\"token punctuation\">:</span> PersonRepository<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Nous pouvons maintenant utiliser le référentiel pour accéder à nos données de modèle dans notre source de données configurée.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\">@<span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/people'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  responses<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">'200'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      description<span class=\"token punctuation\">:</span> <span class=\"token string\">'Person model instance'</span><span class=\"token punctuation\">,</span>\n      content<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'application/json'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'x-ts-type'</span><span class=\"token punctuation\">:</span> Person<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">async</span> <span class=\"token function\">create</span><span class=\"token punctuation\">(</span>@<span class=\"token function\">requestBody</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> person<span class=\"token punctuation\">:</span> Person<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>Person<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>personRepository<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>person<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>Conclusion</h2>\n<p>Cet article compare les différences entre la configuration d’une source de données de base de données et une application LoopBack 3 et LoopBack 4. En plus de comprendre comment configurer une source de données, nous avons examiné comment configurer la configuration en fonction de divers environnements en permettant aux données de configuration d’être définies par les variables d’environnement système, auxquelles nous accédons par <code>process.env.ENV_VARIABLE</code>.</p>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Introduction"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Presque toutes les applications Web ont besoin de conserver des données sous une forme ou une autre. LoopBack a toujours abstrait le moteur de base de données de l’application en nous fournissant plusieurs connecteurs à utiliser, tels que : MySQL, Postgres et In-memory. LoopBack 4 utilise les mêmes bibliothèques sous-jacentes que LoopBack 3 pour passer la configuration aux moteurs. Cependant, les structures du projet sont légèrement différentes, comme indiqué ci-dessous."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Configuration de LoopBack 3"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Dans LoopBack 3, vous définiriez un ensemble d’objets JSON à l’intérieur d’un fichier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"datasources.json"}]},{"type":"text","value":" stocké dans le dossier serveur, ce qui permettrait à l’application de récupérer la configuration. Le fichier ressemblerait à ceci :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"json"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-json","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-json"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"db\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"name\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"db\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"connector\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"memory\""}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Ce fichier définit une nouvelle source de données appelée “db”, qui est configurée pour utiliser le connecteur de base de données en mémoire. Dans la plupart des applications, c’est une excellente source de données par défaut pour les modèles, car elle élimine le besoin de configurer un serveur de base de données lors du premier démarrage avec un prototype. Vous pouvez simplement configurer les modèles pour utiliser la source de données “db” et continuer avec le code."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Le fichier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"model-config.json"}]},{"type":"text","value":", dans le même dossier, relierait un modèle à une source de données et ressemblerait à ceci :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"json"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-json","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-json"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"_meta\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"sources\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"loopback/common/models\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"loopback/server/models\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"../common/models\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"./models\""}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"mixins\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"loopback/common/mixins\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"loopback/server/mixins\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"../common/mixins\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"./mixins\""}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"Person\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"dataSource\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"db\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"public\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","boolean"]},"children":[{"type":"text","value":"false"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  ...\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Une fois que vous avez la base de votre application en place et en cours d’exécution par rapport à la configuration de la base de données en mémoire, vous pouvez vous concentrer sur la configuration d’un serveur de base de données, tel que MySQL ou Postgres, installer le bon connecteur et simplement modifier la configuration "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"datasources.json"}]},{"type":"text","value":" comme suit :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"json"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-json","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-json"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"db\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"name\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"db\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"connector\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"mysql\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"hostname\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"localhost\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"port\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"3306"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"user\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"root\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"password\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"root\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"database\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"app_database\""}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"C’est excellent pour le développement local. Mais, lorsque vous travaillez au sein d’une équipe plus importante ou avec plusieurs environnements, un seul fichier de configuration JSON ne va pas le couper. LoopBack 3 a résolu la configuration spécifique à l’environnement en nous permettant de créer des fichiers de sources de données spécifiques à l’environnement. Le nom du fichier de source de données spécifique à l’environnement devait être dans une certaine structure : "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"datasources.<environment>.js"}]},{"type":"text","value":". Un projet avec 3 environnements aurait les fichiers suivants :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"datasources.json (une configuration de serveur de base de données locale)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"datasources.test.js (une configuration de serveur de base de données de test)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"datasources.production.js (une configuration de serveur de base de données de production)"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"La version JavaScript du fichier de configuration nous a donné une flexibilité supplémentaire, car nous avons pu déterminer la configuration à l’aide de code. Le fichier de configuration le plus courant utilise les variables d’environnement système. Un exemple de fichier de configuration d’une source de données de production serait le suivant :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"js"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-js","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-js"]},"children":[{"type":"text","value":"module"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"exports "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  db"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    name"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'db'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    connector"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'mysql'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    hostname"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" process"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"env"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"DB_HOST"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    port"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" process"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"env"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"DB_PORT"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    user"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" process"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"env"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"DB_USER"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    password"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" process"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"env"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"DB_PASSWORD"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    database"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" process"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"env"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"DB_DATABASE"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"C’est génial, car cela élimine le besoin de stocker les références de production dans notre code. Nous pourrions livrer ces fichiers de configuration et configurer la configuration sur le serveur, en toute sécurité."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Par défaut, le framework utiliserait la variable d’environnement système NODE_ENV pour choisir le fichier source à utiliser. Un serveur de production aurait les variables d’environnement suivantes :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"NODE_ENV=production"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"DB_HOST=aws-rds-mysql-host.example.com"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"DB_PORT=3306"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"DB_USER=super-secret-user"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"DB_PASSWORD=super-secret-password"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"DB"},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"DATABASE=app"}]},{"type":"text","value":"database"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Configuration LoopBack 4"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"LoopBack 4 ne lit plus automatiquement les fichiers de configuration des sources de données. Au lieu de cela, le framework nous laisse décider comment nous voulons configurer notre application. Pour l’instant, il ne semble pas qu’il existe de meilleures pratiques documentées pour la mise en place d’un tel système. Une approche est suggérée ci-dessous."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Dépendance Injection"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Avant de nous plonger dans la configuration de la base de données, nous devons comprendre l’un des concepts clés de LoopBack 4 : "},{"type":"element","tagName":"a","properties":{"href":"https://loopback.io/doc/en/lb4/Dependency-injection.html","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"Injection de dépendance"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Essentiellement, l’application peut enregistrer des valeurs sur une liste de clés uniques. Ces valeurs peuvent contenir des variables normales ou des définitions de classes, que l’application peut ensuite utiliser pour gérer la création de ces objets pour nous, en reprenant les dépendances requises."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Par exemple, on peut enregistrer une valeur,‘bar’ sur une clé ‘foo’."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"bind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'foo'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"to"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'bar'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Maintenant l’application sait que la clé ‘foo’, contient la valeur ‘bar’. Nous pouvons demander cette valeur à partir de l’application n’importe où dans notre code. À titre d’exemple :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"text","value":"@"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"inject"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'foo'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" foo"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","builtin"]},"children":[{"type":"text","value":"string"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"En plus de lier une valeur à une clé, nous pouvons lier une classe à une clé et laisser l’application calculer récursivement ses dépendances lors de l’instanciation de l’objet sur demande."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Foo"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"constructor"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"@"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"inject"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'bar'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" bar"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","builtin"]},"children":[{"type":"text","value":"string"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"someMethod"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"return"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"bar"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"..."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"bind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'bar'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"to"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'Bar'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"bind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'foo'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"toClass"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"Foo"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Quand nous demandons une instance de la classe Foo, comme suit:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"text","value":"@"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"inject"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'foo'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"private"}]},{"type":"text","value":" foo"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Foo"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Le conteneur d’application verra que la classe Foo dépend de la valeur de la barre. Il le recherchera dans le conteneur de dépendances, le trouvera (s’il est lié) et l’injectera ensuite dans la classe. D’où l’"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"injection de dépendance"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Créer un nouveau projet"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"On peut utiliser la CLI pour créer un nouveau projet en appelant la commande suivante :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-bash","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"lb4 app"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-text","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"? Project name: my-api\n? Project description: My API\n? Project root directory: my-api\n? Application class name: MyApiApplication\n? Select features to enable in the project Enable tslint, Enable prettier, Enable mocha, Enable loopbackBuild, Enable vscode, Enable repositories, Enable services"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-bash","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","builtin","class-name"]},"children":[{"type":"text","value":"cd"}]},{"type":"text","value":" ./my-api"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"LoopBack 4 ajoute un dossier datasources au projet."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Initialement, on supposerait que ce dossier est configuré pour être lu de la même manière que les fichiers JSON des sources de données LoopBack 3. Cependant, c’est juste le dossier par défaut utilisé par le CLI pour y déposer les nouveaux fichiers."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Ajout d’une source de données à l’aide de l’interface CLI"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Utilisez le CLI pour créer une nouvelle source de données en exécutant la commande suivante :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-bash","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"lb4 datasource"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-text","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"? Datasource name: db\n? Select the connector for db: In-memory db (supported by StrongLoop)\n? window.localStorage key to use for persistence (browser only):\n? Full path to file for persistence (server only):\ncreate src/datasources/db.datasource.json\ncreate src/datasources/db.datasource.ts\nupdate src/datasources/index.ts\nDatasource db was created in src/datasources/"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"La première chose que vous remarquerez est que le fichier db.datasource.json est exactement le même que le fichier LoopBack 3 datasources.json. Dans l’assistant CLI, j’ai choisi le connecteur en mémoire, qui est l’un des nombreux connecteurs disponibles dans LoopBack 3 et LoopBack 4."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Le nouvel ajout à la famille de fichiers de source de données LoopBack est le fichier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"datasource.ts"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"inject"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'@loopback/core'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"juggler"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'@loopback/repository'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"*"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"as"}]},{"type":"text","value":" config "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'./db.datasource.json'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"DbDataSource"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"extends"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"juggler"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"DataSource"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"static"}]},{"type":"text","value":" dataSourceName "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'db'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"constructor"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"\n    @"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"inject"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'datasources.config.db'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"optional"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","boolean"]},"children":[{"type":"text","value":"true"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n    dsConfig"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" object "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" config"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"super"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"dsConfig"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"La classe étend un type "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"juggler.DataSource"}]},{"type":"text","value":", qui est le même type que celui utilisé dans LoopBack 3 (sauf que c’est la version de définition TypeScript). Il nécessite la même structure de configuration JSON que LoopBack 3. Dans cette version, nous devons passer la configuration à la super méthode du constructeur."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"*"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"as"}]},{"type":"text","value":" config "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'./db.datasource.json'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"..."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"constructor"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"\n  @"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"inject"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'datasources.config.db'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"optional"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","boolean"]},"children":[{"type":"text","value":"true"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n  dsConfig"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" object "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" config\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"..."}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Le fichier importe la configuration par défaut du fichier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"db.datasource.json"}]},{"type":"text","value":" et l’inclut comme valeur par défaut dans le paramètre "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"dsConfig"}]},{"type":"text","value":" du constructeur. Cela signifie que nous n’aurons jamais besoin de passer quoi que ce soit dans le constructeur de la classe DbDataSource lors de l’instanciation d’une instance de l’objet, à moins de l’écraser… peut-être pour un environnement différent (nous y reviendrons)."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"L’autre décorateur d’injection peu familier permet au framework d’injecter la valeur du paramètre depuis le conteneur d’injection de dépendance (s’il est lié)."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Dans cette optique, il existe de nombreuses façons d’instancier cette nouvelle classe DataSource :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// 1. With the default configuration from db.datasource.json"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"let"}]},{"type":"text","value":" dbDataSource "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"new"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"DbDataSource"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// 2. Overwriting the default configuration"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"let"}]},{"type":"text","value":" dbDataSource "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"new"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"DbDataSource"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  name"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'db'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  connector"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'mysql'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  hostname"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" process"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"env"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"DB_HOST"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  port"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" process"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"env"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"DB_PORT"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  user"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" process"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"env"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"DB_USER"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  password"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" process"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"env"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"DB_PASSWORD"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  database"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" process"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"env"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"DB_DATABASE"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Nous avons maintenant une instance de notre dbDataSource. Mais, comment l’utilise-t-on réellement ? Comment notre nouvelle application connaît-elle notre source de données ?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"De la même manière que nous pouvons enregistrer (ou lier) des valeurs (ou classes) contre les applications Dependency Container, nous pouvons lier l’instance de la source de données à une clé du conteneur."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Dans notre fichier "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"application.ts"}]},{"type":"text","value":", nous pouvons utiliser la fonction de liaison des applications dans le constructeur pour lier notre instance à l’application :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"bind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'datasources.db'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"to"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"new"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"DbDataSource"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"En outre, LoopBack 4 a une fonction spéciale appelée source de données :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"dataSource"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"new"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"DbDataSource"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Il existe une dernière méthode pour lier notre source de données à l’application:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"bind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'datasources.config.db'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"to"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  name"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'db'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  connector"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'mysql'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  hostname"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" process"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"env"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"DB_HOST"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  port"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" process"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"env"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"DB_PORT"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  user"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" process"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"env"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"DB_USER"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  password"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" process"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"env"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"DB_PASSWORD"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  database"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" process"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"env"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","constant"]},"children":[{"type":"text","value":"DB_DATABASE"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"bind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'datasources.db'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"toClass"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"DbDataSource"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"L’extrait de code ci-dessus lie d’abord la configuration à la clé de dépendance ’\n"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"datasources.config.db"}]},{"type":"text","value":". Cette clé de dépendance est référencée dans le constructeur de la classe DbDataSource via le décorateur inject. En liant la clé "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"datasources.db"}]},{"type":"text","value":" à la définition de classe “DbDataSource”, le conteneur de dépendances va rechercher toutes ses dépendances et les instancier pour nous."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Maintenant que le conteneur de dépendances de l’application connaît notre source de données, nous pouvons la lier à un référentiel et un modèle."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Note : vous devez d’abord générer un modèle avant de générer un référentiel. Pour ce faire, utilisez la commande modèle lb4 :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-bash","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"lb4 model"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-text","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"? Model class name: Person\n? Please select the model base class Entity\nLet's add a property to Person\nEnter an empty property name when done\n? Enter the property name: id\n? Property type: number\n? Is id the ID property? Yes\n? Is it required?: Yes\n? Default value [leave blank for none]:\nLet's add another property to Person\nEnter an empty property name when done\n? Enter the property name:\ncreate src/models/person.model.ts\nupdate src/models/index.ts\nModel Person was created in src/models/"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Après avoir créé un modèle, relions-le à un nouveau référentiel. Utilisez la commande lb4 repository :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-bash","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"lb4 repository"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-text","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"? Please select the datasource DbDatasource\n? Select the model(s) you want to generate a repository Person\n? Please enter the name of the ID property for Person: id\ncreate src/repositories/person.repository.ts\nupdate src/repositories/index.ts\nRepository Person was created in src/repositories/"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Une fois que vous avez utilisé le modèle lb4 et la commande lb4 repository, vous devriez vous retrouver avec un référentiel lié à un modèle qui injecte la classe DbDataSource :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"PersonRepository"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"extends"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"DefaultCrudRepository"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"\n  Person"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"typeof"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Person"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"prototype"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"id\n"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  \n  "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"constructor"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"\n    @"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"inject"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'datasources.db'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" dataSource"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" DbDataSource"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"super"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"Person"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" dataSource"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Notez que le constructeur PersonRepository utilise à nouveau le décorateur inject mais cette fois-ci il fait référence à la clé "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"datasources.db"}]},{"type":"text","value":" que nous avons définie précédemment. Le référentiel est responsable de la connexion du modèle à la source de données et fournit les fonctions CRUD (Create, Read, Update and Delete), grâce à la classe "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"DefaultCrudRepository"}]},{"type":"text","value":" dont nous héritons."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"De la même manière que nous avons lié la source de données à l’application, nous devons lier le référentiel à l’application :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"repository"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"PersonRepository"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Une fois enregistré, nous pouvons utiliser la commande contrôleur lb4 pour créer un nouveau contrôleur REST pour nous, qui utilise notre nouveau modèle de configuration, source de données et référentiel :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-bash","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"lb4 controller"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-text","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"? Controller class name: People\n? What kind of controller would you like to generate? REST Controller with CRUD functions\n? What is the name of the model to use with this CRUD repository? Person\n? What is the name of your CRUD repository? PersonRepository\n? What is the type of your ID? number\n? What is the base HTTP path name of the CRUD operations? /people\ncreate src/controllers/people.controller.ts\nupdate src/controllers/index.ts\nController People was created in src/controllers/"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Vous pouvez enregistrer le contrôleur contre l’application de la même manière que nous avons la source de données et le référentiel. En plus d’utiliser les fonctions de référentiel et de contrôleur pour lier nos classes à notre application, LoopBack les lie automatiquement pour nous. Ceci peut être configuré dans le constructeur de classe d’application :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"bootOptions "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  controllers"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// Customize ControllerBooter Conventions here"}]},{"type":"text","value":"\n    dirs"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'controllers'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    extensions"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'.controller.js'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    nested"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","boolean"]},"children":[{"type":"text","value":"true"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Ceci indique à notre application de regarder à l’intérieur du dossier Contollers pour tous nos contrôleurs et appelle automatiquement this.controller pour nous. Vous pouvez également configurer la valeur du référentiel bootOptions pour faire de même avec les référentiels."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Nous n’analyserons pas ici l’ensemble du fichier du contrôleur pour gagner de la place. Les sections importantes seront soulignées :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"constructor"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","parameter"]},"children":[{"type":"text","value":"@"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"repository"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"PersonRepository"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" personRepository "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" PersonRepository"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Le décorateur du référentiel s’enroule autour du décorateur d’injection. C’est la même chose que de faire ce qui suit :"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"constructor"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"\n  @"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"inject"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'repositories.PersonRepository'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"public"}]},{"type":"text","value":" personRepository "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" PersonRepository"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Nous pouvons maintenant utiliser le référentiel pour accéder à nos données de modèle dans notre source de données configurée."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-ts","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"text","value":"@"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"post"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'/people'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  responses"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'200'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n      description"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'Person model instance'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      content"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'application/json'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'x-ts-type'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Person"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"async"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"create"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"@"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"requestBody"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" person"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Person"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","builtin"]},"children":[{"type":"text","value":"Promise"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"Person"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"return"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"await"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"personRepository"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"create"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"person"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Conclusion"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Cet article compare les différences entre la configuration d’une source de données de base de données et une application LoopBack 3 et LoopBack 4. En plus de comprendre comment configurer une source de données, nous avons examiné comment configurer la configuration en fonction de divers environnements en permettant aux données de configuration d’être définies par les variables d’environnement système, auxquelles nous accédons par "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"process.env.ENV_VARIABLE"}]},{"type":"text","value":"."}]}],"data":{"quirksMode":false}},"excerpt":"Introduction Presque toutes les applications Web ont besoin de conserver des données sous une forme ou une autre. LoopBack a toujours abstrait le moteur de base de données de l’application en nous fournissant plusieurs connecteurs à utiliser, tels que : MySQL, Postgres et In-memory. LoopBack 4 utilise les mêmes bibliothèques sous-jacentes que LoopBack 3 pour passer la configuration aux moteurs. Cependant, les structures du projet sont légèrement différentes, comme indiqué ci-dessous. Configuration de LoopBack 3 Dans LoopBack 3, vous définiriez un ensemble d’objets JSON à l’intérieur d’un fichier datasources.json stocké dans le dossier serveur, ce qui permettrait à l’application de récupérer la configuration. Le fichier ressemblerait à ceci : Ce fichier définit une nouvelle source de données appelée “db”, qui est configurée pour utiliser le connecteur de base de données en mémoire. Dans la plupart des applications, c’est une excellente source de données par défaut pour les modèles, car elle élimine le besoin de configurer un serveur de base de données lors du premier démarrage avec un prototype. Vous pouvez simplement configurer les modèles pour utiliser la source de données “db” et continuer avec le code. Le fichier model-config.json, dans le même dossier, relierait un modèle à une source de données et ressemblerait à ceci : Une fois que vous avez la base de votre application en place et en cours d’exécution par rapport à la configuration de la base de données en mémoire, vous pouvez vous concentrer sur la configuration d’un serveur de base de données, tel que MySQL ou Postgres, installer le bon connecteur et simplement modifier la configuration datasources.json comme suit : C’est excellent pour le développement local. Mais, lorsque vous travaillez au sein d’une équipe plus importante ou avec plusieurs environnements, un seul fichier de configuration JSON ne va pas le couper. LoopBack 3 a résolu la configuration spécifique à l’environnement en nous permettant de créer des fichiers de sources de données spécifiques à l’environnement. Le nom du fichier de source de données spécifique à l’environnement devait être dans une certaine structure : datasources.<environment>.js. Un projet avec 3 environnements aurait les fichiers suivants : datasources.json (une configuration de serveur de base de données locale) datasources.test.js (une configuration de serveur de base de données de test) datasources.production.js (une configuration de serveur de base de données de production) La version JavaScript du fichier de configuration nous a donné une flexibilité supplémentaire, car nous avons pu déterminer la configuration à l’aide de code. Le fichier de configuration le plus courant utilise les variables d’environnement système. Un exemple de fichier de configuration d’une source de données de production serait le suivant : C’est génial, car cela élimine le besoin de stocker les références de production dans notre code. Nous pourrions livrer ces fichiers de configuration et configurer la configuration sur le serveur, en toute sécurité. Par défaut, le framework utiliserait la variable d’environnement système NODE_ENV pour choisir le fichier source à utiliser. Un serveur de production aurait les variables d’environnement suivantes : NODE_ENV=production DB_HOST=aws-rds-mysql-host.example.com DB_PORT=3306 DB_USER=super-secret-user DB_PASSWORD=super-secret-password DBDATABASE=appdatabase Configuration LoopBack 4 LoopBack 4 ne lit plus automatiquement les fichiers de configuration des sources de données. Au lieu de cela, le framework nous laisse décider comment nous voulons configurer notre application. Pour l’instant, il ne semble pas qu’il existe de meilleures pratiques documentées pour la mise en place d’un tel système. Une approche est suggérée ci-dessous. Dépendance Injection Avant de nous plonger dans la configuration de la base de données, nous devons comprendre l’un des concepts clés de LoopBack 4 : Injection de dépendance. Essentiellement, l’application peut enregistrer des valeurs sur une liste de clés uniques. Ces valeurs peuvent contenir des variables normales ou des définitions de classes, que l’application peut ensuite utiliser pour gérer la création de ces objets pour nous, en reprenant les dépendances requises. Par exemple, on peut enregistrer une valeur,‘bar’ sur une clé ‘foo’. Maintenant l’application sait que la clé ‘foo’, contient la valeur ‘bar’. Nous pouvons demander cette valeur à partir de l’application n’importe où dans notre code. À titre d’exemple : En plus de lier une valeur à une clé, nous pouvons lier une classe à une clé et laisser l’application calculer récursivement ses dépendances lors de l’instanciation de l’objet sur demande. Quand nous demandons une instance de la classe Foo, comme suit: Le conteneur d’application verra que la classe Foo dépend de la valeur de la barre. Il le recherchera dans le conteneur de dépendances, le trouvera (s’il est lié) et l’injectera ensuite dans la classe. D’où l’injection de dépendance. Créer un nouveau projet On peut utiliser la CLI pour créer un nouveau projet en appelant la commande suivante : LoopBack 4 ajoute un dossier datasources au projet. Initialement, on supposerait que ce dossier est configuré pour être lu de la même manière que les fichiers JSON des sources de données LoopBack 3. Cependant, c’est juste le dossier par défaut utilisé par le CLI pour y déposer les nouveaux fichiers. Ajout d’une source de données à l’aide de l’interface CLI Utilisez le CLI pour créer une nouvelle source de données en exécutant la commande suivante : La première chose que vous remarquerez est que le fichier db.datasource.json est exactement le même que le fichier LoopBack 3 datasources.json. Dans l’assistant CLI, j’ai choisi le connecteur en mémoire, qui est l’un des nombreux connecteurs disponibles dans LoopBack 3 et LoopBack 4. Le nouvel ajout à la famille de fichiers de source de données LoopBack est le fichier datasource.ts. La classe étend un type juggler.DataSource, qui est le même type que celui utilisé dans LoopBack 3 (sauf que c’est la version de définition TypeScript). Il nécessite la même structure de configuration JSON que LoopBack 3. Dans cette version, nous devons passer la configuration à la super méthode du constructeur. Le fichier importe la configuration par défaut du fichier db.datasource.json et l’inclut comme valeur par défaut dans le paramètre dsConfig du constructeur. Cela signifie que nous n’aurons jamais besoin de passer quoi que ce soit dans le constructeur de la classe DbDataSource lors de l’instanciation d’une instance de l’objet, à moins de l’écraser… peut-être pour un environnement différent (nous y reviendrons). L’autre décorateur d’injection peu familier permet au framework d’injecter la valeur du paramètre depuis le conteneur d’injection de dépendance (s’il est lié). Dans cette optique, il existe de nombreuses façons d’instancier cette nouvelle classe DataSource : Nous avons maintenant une instance de notre dbDataSource. Mais, comment l’utilise-t-on réellement ? Comment notre nouvelle application connaît-elle notre source de données ? De la même manière que nous pouvons enregistrer (ou lier) des valeurs (ou classes) contre les applications Dependency Container, nous pouvons lier l’instance de la source de données à une clé du conteneur. Dans notre fichier application.ts, nous pouvons utiliser la fonction de liaison des applications dans le constructeur pour lier notre instance à l’application : En outre, LoopBack 4 a une fonction spéciale appelée source de données : Il existe une dernière méthode pour lier notre source de données à l’application: L’extrait de code ci-dessus lie d’abord la configuration à la clé de dépendance ’\ndatasources.config.db. Cette clé de dépendance est référencée dans le constructeur de la classe DbDataSource via le décorateur inject. En liant la clé datasources.db à la définition de classe “DbDataSource”, le conteneur de dépendances va rechercher toutes ses dépendances et les instancier pour nous. Maintenant que le conteneur de dépendances de l’application connaît notre source de données, nous pouvons la lier à un référentiel et un modèle. Note : vous devez d’abord générer un modèle avant de générer un référentiel. Pour ce faire, utilisez la commande modèle lb4 : Après avoir créé un modèle, relions-le à un nouveau référentiel. Utilisez la commande lb4 repository : Une fois que vous avez utilisé le modèle lb4 et la commande lb4 repository, vous devriez vous retrouver avec un référentiel lié à un modèle qui injecte la classe DbDataSource : Notez que le constructeur PersonRepository utilise à nouveau le décorateur inject mais cette fois-ci il fait référence à la clé datasources.db que nous avons définie précédemment. Le référentiel est responsable de la connexion du modèle à la source de données et fournit les fonctions CRUD (Create, Read, Update and Delete), grâce à la classe DefaultCrudRepository dont nous héritons. De la même manière que nous avons lié la source de données à l’application, nous devons lier le référentiel à l’application : Une fois enregistré, nous pouvons utiliser la commande contrôleur lb4 pour créer un nouveau contrôleur REST pour nous, qui utilise notre nouveau modèle de configuration, source de données et référentiel : Vous pouvez enregistrer le contrôleur contre l’application de la même manière que nous avons la source de données et le référentiel. En plus d’utiliser les fonctions de référentiel et de contrôleur pour lier nos classes à notre application, LoopBack les lie automatiquement pour nous. Ceci peut être configuré dans le constructeur de classe d’application : Ceci indique à notre application de regarder à l’intérieur du dossier Contollers pour tous nos contrôleurs et appelle automatiquement this.controller pour nous. Vous pouvez également configurer la valeur du référentiel bootOptions pour faire de même avec les référentiels. Nous n’analyserons pas ici l’ensemble du fichier du contrôleur pour gagner de la place. Les sections importantes seront soulignées : Le décorateur du référentiel s’enroule autour du décorateur d’injection. C’est la même chose que de faire ce qui suit : Nous pouvons maintenant utiliser le référentiel pour accéder à nos données de modèle dans notre source de données configurée. Conclusion Cet article compare les différences entre la configuration d’une source de données de base de données et une application LoopBack 3 et LoopBack 4. En plus de comprendre comment configurer une source de données, nous avons examiné comment configurer la configuration en fonction de divers environnements en permettant aux données de configuration d’être définies par les variables d’environnement système, auxquelles nous accédons par process.env.ENV_VARIABLE.","timeToRead":11,"frontmatter":{"title":"Loopback 4 - Configuration de la base de données","subtitle":"Cet article va décrire quelques façons de configurer une application LoopBack 4 par rapport à une base de données à travers plusieurs environnements de développement (dev, test et production).","userDate":"29 June 2019","date":"2019-06-29T21:00:00.000Z","tags":["LoopBack","Node.js"],"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIDBQH/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAgP/2gAMAwEAAhADEAAAAd2qFGs6KLKpA6D/xAAaEAACAwEBAAAAAAAAAAAAAAABAgADERAS/9oACAEBAAEFAmYKBaNltZY+S8UYvf/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABcRAQADAAAAAAAAAAAAAAAAAAIBESD/2gAIAQIBAT8Bgmsf/8QAIBAAAgEBCQAAAAAAAAAAAAAAAREAAhASICExQVFhcf/aAAgBAQAGPwJmIg0+2MLTeZPu8IBxg//EABsQAAICAwEAAAAAAAAAAAAAAAERACEQIDGx/9oACAEBAAE/IWZQhjIPFTxZdwoB1CpF5SyGi0//2gAMAwEAAgADAAAAEGfvAP/EABYRAQEBAAAAAAAAAAAAAAAAAAERIP/aAAgBAwEBPxBW4//EABgRAQADAQAAAAAAAAAAAAAAAAEAEBHh/9oACAECAQE/EGaXkb//xAAeEAEBAAEEAwEAAAAAAAAAAAABESEAMUFhECBxwf/aAAgBAQABPxBSMi50HycxA+/j4mbfQaZtJz1qYZEiAUiAeB2k71ltDTzCen//2Q==","aspectRatio":1,"src":"/static/9611cacec962506545385f22b26d913d/883ab/loopback.jpg","srcSet":"/static/9611cacec962506545385f22b26d913d/f8f18/loopback.jpg 930w,\n/static/9611cacec962506545385f22b26d913d/0e6ff/loopback.jpg 1860w,\n/static/9611cacec962506545385f22b26d913d/883ab/loopback.jpg 2000w","sizes":"(max-width: 2000px) 100vw, 2000px"}}},"author":{"id":"ludo","name":"Wyffels Ludovic","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAABMUlEQVQ4y2MwsXf5T03MMGogGBvbOYNpUwdXOIbJwdgwNQQNhCk0snX6r2thC8Y6QGxg7QCWA/FBcrgMxepCkAZrV6//EYmpYBydkvHfMzjiv5mj2//whJT/Nm7ecEMJGgjykp6V/f+AqLj/O/Ye+L8diA8dO/m/pbv/v72n3/+tu/f9D45N/K9naYcSFESFoRXQlSCX2rh7g/kgr1u5epIWhiAMCi/3wLD/fVNn/u+fNgtMT5g+6//kmXOB/Jn/PYLCwWrINnDijDlAPBvKJ8NAZC+DIgCkGYRBbJAYSV5GjpTte/b/PwiMkLj0nP8xqVn/Dxw9AY6kwOh40iIFlmzCgUkmKjnjvx0wdu08fMFskJi1mxfxyQY9YetAEzJyQic5YaNnPeTgIDnrjZaHJGMACtTMXoVAJ6sAAAAASUVORK5CYII=","width":400,"height":400,"src":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png","srcSet":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png 1x"}}]}}}},"relatedPosts":{"totalCount":2,"edges":[{"node":{"id":"c1ba20f7-8208-596e-94fa-0f678722da77","timeToRead":11,"excerpt":"Introduction Presque toutes les applications Web ont besoin de conserver des données sous une forme ou une autre. LoopBack a toujours abstrait le moteur de base de données de l’application en nous fournissant plusieurs connecteurs à utiliser, tels que : MySQL, Postgres et In-memory. LoopBack 4 utilise les mêmes bibliothèques sous-jacentes que LoopBack 3 pour passer la configuration aux moteurs. Cependant, les structures du projet sont légèrement différentes, comme indiqué ci-dessous. Configuration de LoopBack 3 Dans LoopBack 3, vous définiriez un ensemble d’objets JSON à l’intérieur d’un fichier datasources.json stocké dans le dossier serveur, ce qui permettrait à l’application de récupérer la configuration. Le fichier ressemblerait à ceci : Ce fichier définit une nouvelle source de données appelée “db”, qui est configurée pour utiliser le connecteur de base de données en mémoire. Dans la plupart des applications, c’est une excellente source de données par défaut pour les modèles, car elle élimine le besoin de configurer un serveur de base de données lors du premier démarrage avec un prototype. Vous pouvez simplement configurer les modèles pour utiliser la source de données “db” et continuer avec le code. Le fichier model-config.json, dans le même dossier, relierait un modèle à une source de données et ressemblerait à ceci : Une fois que vous avez la base de votre application en place et en cours d’exécution par rapport à la configuration de la base de données en mémoire, vous pouvez vous concentrer sur la configuration d’un serveur de base de données, tel que MySQL ou Postgres, installer le bon connecteur et simplement modifier la configuration datasources.json comme suit : C’est excellent pour le développement local. Mais, lorsque vous travaillez au sein d’une équipe plus importante ou avec plusieurs environnements, un seul fichier de configuration JSON ne va pas le couper. LoopBack 3 a résolu la configuration spécifique à l’environnement en nous permettant de créer des fichiers de sources de données spécifiques à l’environnement. Le nom du fichier de source de données spécifique à l’environnement devait être dans une certaine structure : datasources.<environment>.js. Un projet avec 3 environnements aurait les fichiers suivants : datasources.json (une configuration de serveur de base de données locale) datasources.test.js (une configuration de serveur de base de données de test) datasources.production.js (une configuration de serveur de base de données de production) La version JavaScript du fichier de configuration nous a donné une flexibilité supplémentaire, car nous avons pu déterminer la configuration à l’aide de code. Le fichier de configuration le plus courant utilise les variables d’environnement système. Un exemple de fichier de configuration d’une source de données de production serait le suivant : C’est génial, car cela élimine le besoin de stocker les références de production dans notre code. Nous pourrions livrer ces fichiers de configuration et configurer la configuration sur le serveur, en toute sécurité. Par défaut, le framework utiliserait la variable d’environnement système NODE_ENV pour choisir le fichier source à utiliser. Un serveur de production aurait les variables d’environnement suivantes : NODE_ENV=production DB_HOST=aws-rds-mysql-host.example.com DB_PORT=3306 DB_USER=super-secret-user DB_PASSWORD=super-secret-password DBDATABASE=appdatabase Configuration LoopBack 4 LoopBack 4 ne lit plus automatiquement les fichiers de configuration des sources de données. Au lieu de cela, le framework nous laisse décider comment nous voulons configurer notre application. Pour l’instant, il ne semble pas qu’il existe de meilleures pratiques documentées pour la mise en place d’un tel système. Une approche est suggérée ci-dessous. Dépendance Injection Avant de nous plonger dans la configuration de la base de données, nous devons comprendre l’un des concepts clés de LoopBack 4 : Injection de dépendance. Essentiellement, l’application peut enregistrer des valeurs sur une liste de clés uniques. Ces valeurs peuvent contenir des variables normales ou des définitions de classes, que l’application peut ensuite utiliser pour gérer la création de ces objets pour nous, en reprenant les dépendances requises. Par exemple, on peut enregistrer une valeur,‘bar’ sur une clé ‘foo’. Maintenant l’application sait que la clé ‘foo’, contient la valeur ‘bar’. Nous pouvons demander cette valeur à partir de l’application n’importe où dans notre code. À titre d’exemple : En plus de lier une valeur à une clé, nous pouvons lier une classe à une clé et laisser l’application calculer récursivement ses dépendances lors de l’instanciation de l’objet sur demande. Quand nous demandons une instance de la classe Foo, comme suit: Le conteneur d’application verra que la classe Foo dépend de la valeur de la barre. Il le recherchera dans le conteneur de dépendances, le trouvera (s’il est lié) et l’injectera ensuite dans la classe. D’où l’injection de dépendance. Créer un nouveau projet On peut utiliser la CLI pour créer un nouveau projet en appelant la commande suivante : LoopBack 4 ajoute un dossier datasources au projet. Initialement, on supposerait que ce dossier est configuré pour être lu de la même manière que les fichiers JSON des sources de données LoopBack 3. Cependant, c’est juste le dossier par défaut utilisé par le CLI pour y déposer les nouveaux fichiers. Ajout d’une source de données à l’aide de l’interface CLI Utilisez le CLI pour créer une nouvelle source de données en exécutant la commande suivante : La première chose que vous remarquerez est que le fichier db.datasource.json est exactement le même que le fichier LoopBack 3 datasources.json. Dans l’assistant CLI, j’ai choisi le connecteur en mémoire, qui est l’un des nombreux connecteurs disponibles dans LoopBack 3 et LoopBack 4. Le nouvel ajout à la famille de fichiers de source de données LoopBack est le fichier datasource.ts. La classe étend un type juggler.DataSource, qui est le même type que celui utilisé dans LoopBack 3 (sauf que c’est la version de définition TypeScript). Il nécessite la même structure de configuration JSON que LoopBack 3. Dans cette version, nous devons passer la configuration à la super méthode du constructeur. Le fichier importe la configuration par défaut du fichier db.datasource.json et l’inclut comme valeur par défaut dans le paramètre dsConfig du constructeur. Cela signifie que nous n’aurons jamais besoin de passer quoi que ce soit dans le constructeur de la classe DbDataSource lors de l’instanciation d’une instance de l’objet, à moins de l’écraser… peut-être pour un environnement différent (nous y reviendrons). L’autre décorateur d’injection peu familier permet au framework d’injecter la valeur du paramètre depuis le conteneur d’injection de dépendance (s’il est lié). Dans cette optique, il existe de nombreuses façons d’instancier cette nouvelle classe DataSource : Nous avons maintenant une instance de notre dbDataSource. Mais, comment l’utilise-t-on réellement ? Comment notre nouvelle application connaît-elle notre source de données ? De la même manière que nous pouvons enregistrer (ou lier) des valeurs (ou classes) contre les applications Dependency Container, nous pouvons lier l’instance de la source de données à une clé du conteneur. Dans notre fichier application.ts, nous pouvons utiliser la fonction de liaison des applications dans le constructeur pour lier notre instance à l’application : En outre, LoopBack 4 a une fonction spéciale appelée source de données : Il existe une dernière méthode pour lier notre source de données à l’application: L’extrait de code ci-dessus lie d’abord la configuration à la clé de dépendance ’\ndatasources.config.db. Cette clé de dépendance est référencée dans le constructeur de la classe DbDataSource via le décorateur inject. En liant la clé datasources.db à la définition de classe “DbDataSource”, le conteneur de dépendances va rechercher toutes ses dépendances et les instancier pour nous. Maintenant que le conteneur de dépendances de l’application connaît notre source de données, nous pouvons la lier à un référentiel et un modèle. Note : vous devez d’abord générer un modèle avant de générer un référentiel. Pour ce faire, utilisez la commande modèle lb4 : Après avoir créé un modèle, relions-le à un nouveau référentiel. Utilisez la commande lb4 repository : Une fois que vous avez utilisé le modèle lb4 et la commande lb4 repository, vous devriez vous retrouver avec un référentiel lié à un modèle qui injecte la classe DbDataSource : Notez que le constructeur PersonRepository utilise à nouveau le décorateur inject mais cette fois-ci il fait référence à la clé datasources.db que nous avons définie précédemment. Le référentiel est responsable de la connexion du modèle à la source de données et fournit les fonctions CRUD (Create, Read, Update and Delete), grâce à la classe DefaultCrudRepository dont nous héritons. De la même manière que nous avons lié la source de données à l’application, nous devons lier le référentiel à l’application : Une fois enregistré, nous pouvons utiliser la commande contrôleur lb4 pour créer un nouveau contrôleur REST pour nous, qui utilise notre nouveau modèle de configuration, source de données et référentiel : Vous pouvez enregistrer le contrôleur contre l’application de la même manière que nous avons la source de données et le référentiel. En plus d’utiliser les fonctions de référentiel et de contrôleur pour lier nos classes à notre application, LoopBack les lie automatiquement pour nous. Ceci peut être configuré dans le constructeur de classe d’application : Ceci indique à notre application de regarder à l’intérieur du dossier Contollers pour tous nos contrôleurs et appelle automatiquement this.controller pour nous. Vous pouvez également configurer la valeur du référentiel bootOptions pour faire de même avec les référentiels. Nous n’analyserons pas ici l’ensemble du fichier du contrôleur pour gagner de la place. Les sections importantes seront soulignées : Le décorateur du référentiel s’enroule autour du décorateur d’injection. C’est la même chose que de faire ce qui suit : Nous pouvons maintenant utiliser le référentiel pour accéder à nos données de modèle dans notre source de données configurée. Conclusion Cet article compare les différences entre la configuration d’une source de données de base de données et une application LoopBack 3 et LoopBack 4. En plus de comprendre comment configurer une source de données, nous avons examiné comment configurer la configuration en fonction de divers environnements en permettant aux données de configuration d’être définies par les variables d’environnement système, auxquelles nous accédons par process.env.ENV_VARIABLE.","frontmatter":{"title":"Loopback 4 - Configuration de la base de données","subtitle":"Cet article va décrire quelques façons de configurer une application LoopBack 4 par rapport à une base de données à travers plusieurs environnements de développement (dev, test et production)."},"fields":{"slug":"/node-loopback-database/"}}},{"node":{"id":"5954b4ef-50d2-5959-ab6c-62e8c85df77f","timeToRead":7,"excerpt":"LoopBack 4 est un framework d’API open-source pour Node.js. La dernière version a adopté les dernières fonctionnalités de ES2016/2017/2018, supporte TypeScript et intègre de nouveaux standards tels que OpenAPI Spec et GraphQL, parmi d’autres. Cet article a pour but de guider les débutants à travers la documentation et d’expliquer les points cruciaux nécessaires pour commencer à construire un projet d’API LoopBack 4 maintenable. Installation Assurez-vous d’avoir Node.js version 8+ installé sur votre machine. Le monorepo LoopBack inclut un package CLI, qui nous aidera dans l’échafaudage de notre application LoopBack 4. Pour l’installer, exécutez la commande suivante sur votre terminal : Créer un nouveau projet Une fois que l’outil LoopBack 4 CLI a été installé en global sur notre machine locale, nous pouvons échafauder notre application en utilisant la commande suivante : Le terminal présentera les demandes d’entrée suivantes, que j’ai remplies ci-dessous et qui formeront la base de notre exemple d’API pour l’avenir. Après avoir parcouru l’assistant CLI ci-dessus, il créera un tas de répertoires et de fichiers boilerplate ainsi que lancera npm install à notre place. Nous pouvons alors naviguer dans notre répertoire nouvellement créé et démarrer l’application. Si tout s’est bien déroulé, vous devriez voir le résultat suivant : Le projet expose un simple endpoint GET /ping. Ce qui n’est pas clair dans la sortie du terminal, ou dans la documentation de démarrage, c’est que l’application LoopBack 4 expose également un endpoint qui rendra la documentation OpenAPI Spec. Pour y accéder, il vous suffit d’ouvrir votre navigateur et d’aller à l’url suivante : http://localhost:3000/swagger-ui. LoopBack 4 OpenAPI Cette fonctionnalité permet aux développeurs d’API de documenter facilement leurs services Web au fur et à mesure que le code est écrit et de tester les endpoints d’une manière conviviale. Exploration de l’expression standard Le LoopBack CLI crée beaucoup de fichiers et de dossiers pour nous. Réduisons le bruit et concentrons-nous sur les éléments dont nous avons besoin pour mettre en place et faire fonctionner un nouveau endpoint. LoopBack 4 Structure du projet Un fichier ping.controller.ts initial est créé pour nous. C’est la convention de nommage par défaut que l’application LoopBack applique par configuration, qui peut être modifiée dans le fichier application.ts et qui sera explorée dans de futurs articles. Après avoir ouvert le fichier ping.controller.ts, nous pouvons voir que le code utilise des décorateurs TypeScript pour fournir des métadonnées HTTP à la fonction ping() TypeScript dans la classe PingController. Ce décorateur permet à l’application LoopBack de savoir que toute requête HTTP GET doit invoquer la fonction ping(). La fonction ping() renvoie un objet JSON simple. L’application LoopBack s’occupe de la sérialisation automatique des données de réponse, qui est dans ce cas JSON. Création d’un nouveau Endpoint\nUn nouveau point final peut être créé en écrivant une nouvelle fonction décorée sur le PingController dans le fichier ping.controller.ts en se référant à la fonction ping() existante. LoopBack nous permet également de créer facilement de nouveaux contrôleurs en utilisant le CLI : Afin d’utiliser le contrôleur REST avec l’option de fonctions CRUD, nous devons d’abord avoir un référentiel que nous examinerons dans les prochains articles. Si nous exécutons notre serveur avec npm, démarrez et rafraîchissez notre navigateur OpenAPI, remarquez qu’il n’y a pas encore de mention d’un PaymentController. C’est parce que nous n’avons pas encore mappé de fonctions aux chemins HTTP pour l’application LoopBack à documenter en utilisant les spécifications OpenAPI. Une fonction appelée paye accepte un seul paramètre paiement de type any et retourne un Object. Nous utilisons deux décorateurs : Ce qui dit à LoopBack de mapper la fonction pay() à une méthode HTTP POST sur les requêtes entrantes /payments et qui indique à LoopBack de mapper le corps de requête HTTP POST au paramètre de paiement de la fonction pay(). LoopBack analysera automatiquement le corps de requête HTTP JSON en fonction du type requis, ce qui est le cas dans ce cas. En réexécutant le serveur (npm start) et en rafraîchissant le navigateur OpenAPI Spec, le PaymentController sera présent avec un endpoint POST /payments. PaymentController - POST /payments Le navigateur OpenAPI Spec affiche les paramètres disponibles que nous pouvons utiliser pour interagir avec l’API, qui est juste un corps de requête HTTP pour le moment. Nous pouvons tester ce endpoint en appuyant sur le bouton “Try it out” en haut à droite. Test POST /payments La valeur d’exemple a été initialisée avec un objet JSON vide. Ce n’est pas très utile, car cela ne communique pas les valeurs attendues par le endpoint. Grâce à des normes REST simples, nous pouvons établir que nous pouvons probablement utiliser ce endpoint pour effectuer un paiement, mais quelles sont les propriétés exactes que nous pouvons transmettre ici? Valeur? Devise? Montant? Paramètres du document à l’aide des définitions de modèle Dans LoopBack 3.x, tout était piloté par un modèle, qui était un simple fichier de configuration JSON décrivant les propriétés du modèle et leurs types. Les fichiers de définition de modèle permettaient également aux développeurs de spécifier si le modèle était persistant ou non et de mapper les propriétés JSON sur des colonnes spécifiques aux bases de données (si nécessaire). Le fichier permettait également de configurer des validations, des relations, des acls (Access Control Lists) et des méthodes à distance. LoopBack 4 a pour but de découpler beaucoup de ces éléments afin de permettre une plus grande flexibilité. Nous pouvons toutefois réutiliser une grande partie de la structure syntaxique des métadonnées dans LoopBack 4, en conséquence. Nous utilisons la classe Model ci-dessus pour déclarer que la classe PaymentRequest n’est pas persistante, car elle n’est pas conforme à l’interface Persistable (qui se trouve dans le paquet LoopBack Repository). La classe Entity, utilisée dans les articles ultérieurs, implémente l’interface Persistable et inclut une fonction qui est utilisée pour définir quelle propriété détermine son caractère unique, c’est-à-dire qu’elle a un identifiant unique et peut être stockée/persistée dans une source de données (Data Source). La classe PaymentRequest est utilisée pour modéliser les données de notre module POST /payments HTTP Request. Le décorateur @model() peut être utilisé pour inclure des métadonnées supplémentaires pour le modèle. Dans ce cas, il est juste utilisé pour faire savoir à LoopBack qu’il s’agit d’un modèle et qu’il doit être utilisé pour rendre la documentation dans la spécification OpenAPI. Le décorateur @property est utilisé pour fournir des métadonnées supplémentaires aux propriétés individuelles de notre modèle. Ces métadonnées permettent d’afficher les propriétés dans les fichiers de définition de modèle LoopBack 3 et leur but principal est de permettre aux spécifications OpenAPI de documenter facilement les propriétés ainsi que les propriétés de mapper aux noms de colonnes spécifiques à la base de données. Nous pouvons utiliser cette classe de modèle comme type de paramètre dans la fonction PaymentController#pay : Avec une classe TypeScript spécifique utilisée comme type de paramètre, LoopBack peut maintenant fournir des détails supplémentaires à la spécification OpenAPI et notre navigateur rend maintenant ce qui suit (après avoir redémarré le serveur et actualisé la page): POST /payments Documentation Request Body Nos développeurs frontaux peuvent maintenant facilement lire la documentation interactive et commencer à intégrer leurs applications avec un minimum d’effort. L’exécution de cette opération après avoir appuyé sur le bouton “Try it out” et modifié certains des paramètres permet d’obtenir un code de réponse HTTP 200 avec le corps de réponse JSON suivant: 200 Success Nous avons changé la propriété de statut à “succès” dans la fonction pay() plus tôt, ce qui est vu dans la sortie JSON ci-dessus. Conclusion Cet article a introduit LoopBack 4 en échafaudant une API de paiement simple par l’intermédiaire du CLI. Nous avons examiné à quel point il est facile de documenter et de tester les endpoints de l’API à l’aide des spécifications OpenAPI intégrées en utilisant les contrôleurs LoopBack 4 et les fonctions TypeScript décorées. Enfin, nous avons exploré l’évolution des fichiers de définition de modèle LoopBack 2/3 en détail. LoopBack 4 est toujours en cours de développement, avec de nombreuses nouvelles fonctionnalités construites par l’impressionnante communauté open-source. Dans les articles suivants, nous les explorerons tous plus en détail au fur et à mesure que nous construirons notre API de paiement simple.","frontmatter":{"title":"Premiers pas avec LoopBack 4","subtitle":"LoopBack 4 est un framework d'API open-source. La dernière version a adopté les dernières fonctionnalités de ES2016/2017/2018, supporte TypeScript et intègre de nouveaux standards tels que OpenAPI Spec et GraphQL, parmi d'autres."},"fields":{"slug":"/node-loopback/"}}}]}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/node-loopback-database/","prev":{"excerpt":"LoopBack 4 est un framework d’API open-source pour Node.js. La dernière version a adopté les dernières fonctionnalités de ES2016/2017/2018, supporte TypeScript et intègre de nouveaux standards tels que OpenAPI Spec et GraphQL, parmi d’autres. Cet article a pour but de guider les débutants à travers la documentation et d’expliquer les points cruciaux nécessaires pour commencer à construire un projet d’API LoopBack 4 maintenable. Installation Assurez-vous d’avoir Node.js version 8+ installé sur votre machine. Le monorepo LoopBack inclut un package CLI, qui nous aidera dans l’échafaudage de notre application LoopBack 4. Pour l’installer, exécutez la commande suivante sur votre terminal : Créer un nouveau projet Une fois que l’outil LoopBack 4 CLI a été installé en global sur notre machine locale, nous pouvons échafauder notre application en utilisant la commande suivante : Le terminal présentera les demandes d’entrée suivantes, que j’ai remplies ci-dessous et qui formeront la base de notre exemple d’API pour l’avenir. Après avoir parcouru l’assistant CLI ci-dessus, il créera un tas de répertoires et de fichiers boilerplate ainsi que lancera npm install à notre place. Nous pouvons alors naviguer dans notre répertoire nouvellement créé et démarrer l’application. Si tout s’est bien déroulé, vous devriez voir le résultat suivant : Le projet expose un simple endpoint GET /ping. Ce qui n’est pas clair dans la sortie du terminal, ou dans la documentation de démarrage, c’est que l’application LoopBack 4 expose également un endpoint qui rendra la documentation OpenAPI Spec. Pour y accéder, il vous suffit d’ouvrir votre navigateur et d’aller à l’url suivante : http://localhost:3000/swagger-ui. LoopBack 4 OpenAPI Cette fonctionnalité permet aux développeurs d’API de documenter facilement leurs services Web au fur et à mesure que le code est écrit et de tester les endpoints d’une manière conviviale. Exploration de l’expression standard Le LoopBack CLI crée beaucoup de fichiers et de dossiers pour nous. Réduisons le bruit et concentrons-nous sur les éléments dont nous avons besoin pour mettre en place et faire fonctionner un nouveau endpoint. LoopBack 4 Structure du projet Un fichier ping.controller.ts initial est créé pour nous. C’est la convention de nommage par défaut que l’application LoopBack applique par configuration, qui peut être modifiée dans le fichier application.ts et qui sera explorée dans de futurs articles. Après avoir ouvert le fichier ping.controller.ts, nous pouvons voir que le code utilise des décorateurs TypeScript pour fournir des métadonnées HTTP à la fonction ping() TypeScript dans la classe PingController. Ce décorateur permet à l’application LoopBack de savoir que toute requête HTTP GET doit invoquer la fonction ping(). La fonction ping() renvoie un objet JSON simple. L’application LoopBack s’occupe de la sérialisation automatique des données de réponse, qui est dans ce cas JSON. Création d’un nouveau Endpoint\nUn nouveau point final peut être créé en écrivant une nouvelle fonction décorée sur le PingController dans le fichier ping.controller.ts en se référant à la fonction ping() existante. LoopBack nous permet également de créer facilement de nouveaux contrôleurs en utilisant le CLI : Afin d’utiliser le contrôleur REST avec l’option de fonctions CRUD, nous devons d’abord avoir un référentiel que nous examinerons dans les prochains articles. Si nous exécutons notre serveur avec npm, démarrez et rafraîchissez notre navigateur OpenAPI, remarquez qu’il n’y a pas encore de mention d’un PaymentController. C’est parce que nous n’avons pas encore mappé de fonctions aux chemins HTTP pour l’application LoopBack à documenter en utilisant les spécifications OpenAPI. Une fonction appelée paye accepte un seul paramètre paiement de type any et retourne un Object. Nous utilisons deux décorateurs : Ce qui dit à LoopBack de mapper la fonction pay() à une méthode HTTP POST sur les requêtes entrantes /payments et qui indique à LoopBack de mapper le corps de requête HTTP POST au paramètre de paiement de la fonction pay(). LoopBack analysera automatiquement le corps de requête HTTP JSON en fonction du type requis, ce qui est le cas dans ce cas. En réexécutant le serveur (npm start) et en rafraîchissant le navigateur OpenAPI Spec, le PaymentController sera présent avec un endpoint POST /payments. PaymentController - POST /payments Le navigateur OpenAPI Spec affiche les paramètres disponibles que nous pouvons utiliser pour interagir avec l’API, qui est juste un corps de requête HTTP pour le moment. Nous pouvons tester ce endpoint en appuyant sur le bouton “Try it out” en haut à droite. Test POST /payments La valeur d’exemple a été initialisée avec un objet JSON vide. Ce n’est pas très utile, car cela ne communique pas les valeurs attendues par le endpoint. Grâce à des normes REST simples, nous pouvons établir que nous pouvons probablement utiliser ce endpoint pour effectuer un paiement, mais quelles sont les propriétés exactes que nous pouvons transmettre ici? Valeur? Devise? Montant? Paramètres du document à l’aide des définitions de modèle Dans LoopBack 3.x, tout était piloté par un modèle, qui était un simple fichier de configuration JSON décrivant les propriétés du modèle et leurs types. Les fichiers de définition de modèle permettaient également aux développeurs de spécifier si le modèle était persistant ou non et de mapper les propriétés JSON sur des colonnes spécifiques aux bases de données (si nécessaire). Le fichier permettait également de configurer des validations, des relations, des acls (Access Control Lists) et des méthodes à distance. LoopBack 4 a pour but de découpler beaucoup de ces éléments afin de permettre une plus grande flexibilité. Nous pouvons toutefois réutiliser une grande partie de la structure syntaxique des métadonnées dans LoopBack 4, en conséquence. Nous utilisons la classe Model ci-dessus pour déclarer que la classe PaymentRequest n’est pas persistante, car elle n’est pas conforme à l’interface Persistable (qui se trouve dans le paquet LoopBack Repository). La classe Entity, utilisée dans les articles ultérieurs, implémente l’interface Persistable et inclut une fonction qui est utilisée pour définir quelle propriété détermine son caractère unique, c’est-à-dire qu’elle a un identifiant unique et peut être stockée/persistée dans une source de données (Data Source). La classe PaymentRequest est utilisée pour modéliser les données de notre module POST /payments HTTP Request. Le décorateur @model() peut être utilisé pour inclure des métadonnées supplémentaires pour le modèle. Dans ce cas, il est juste utilisé pour faire savoir à LoopBack qu’il s’agit d’un modèle et qu’il doit être utilisé pour rendre la documentation dans la spécification OpenAPI. Le décorateur @property est utilisé pour fournir des métadonnées supplémentaires aux propriétés individuelles de notre modèle. Ces métadonnées permettent d’afficher les propriétés dans les fichiers de définition de modèle LoopBack 3 et leur but principal est de permettre aux spécifications OpenAPI de documenter facilement les propriétés ainsi que les propriétés de mapper aux noms de colonnes spécifiques à la base de données. Nous pouvons utiliser cette classe de modèle comme type de paramètre dans la fonction PaymentController#pay : Avec une classe TypeScript spécifique utilisée comme type de paramètre, LoopBack peut maintenant fournir des détails supplémentaires à la spécification OpenAPI et notre navigateur rend maintenant ce qui suit (après avoir redémarré le serveur et actualisé la page): POST /payments Documentation Request Body Nos développeurs frontaux peuvent maintenant facilement lire la documentation interactive et commencer à intégrer leurs applications avec un minimum d’effort. L’exécution de cette opération après avoir appuyé sur le bouton “Try it out” et modifié certains des paramètres permet d’obtenir un code de réponse HTTP 200 avec le corps de réponse JSON suivant: 200 Success Nous avons changé la propriété de statut à “succès” dans la fonction pay() plus tôt, ce qui est vu dans la sortie JSON ci-dessus. Conclusion Cet article a introduit LoopBack 4 en échafaudant une API de paiement simple par l’intermédiaire du CLI. Nous avons examiné à quel point il est facile de documenter et de tester les endpoints de l’API à l’aide des spécifications OpenAPI intégrées en utilisant les contrôleurs LoopBack 4 et les fonctions TypeScript décorées. Enfin, nous avons exploré l’évolution des fichiers de définition de modèle LoopBack 2/3 en détail. LoopBack 4 est toujours en cours de développement, avec de nombreuses nouvelles fonctionnalités construites par l’impressionnante communauté open-source. Dans les articles suivants, nous les explorerons tous plus en détail au fur et à mesure que nous construirons notre API de paiement simple.","timeToRead":7,"frontmatter":{"title":"Premiers pas avec LoopBack 4","subtitle":"LoopBack 4 est un framework d'API open-source. La dernière version a adopté les dernières fonctionnalités de ES2016/2017/2018, supporte TypeScript et intègre de nouveaux standards tels que OpenAPI Spec et GraphQL, parmi d'autres.","tags":["LoopBack","Node.js"],"category":["Node.js"],"date":"2019-06-29T08:00:00.000Z","draft":false,"image":{"childImageSharp":{"fluid":{"aspectRatio":1,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIDBQH/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAgP/2gAMAwEAAhADEAAAAd2qFGs6KLKpA6D/xAAaEAACAwEBAAAAAAAAAAAAAAABAgADERAS/9oACAEBAAEFAmYKBaNltZY+S8UYvf/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABcRAQADAAAAAAAAAAAAAAAAAAIBESD/2gAIAQIBAT8Bgmsf/8QAIBAAAgEBCQAAAAAAAAAAAAAAAREAAhASICExQVFhcf/aAAgBAQAGPwJmIg0+2MLTeZPu8IBxg//EABsQAAICAwEAAAAAAAAAAAAAAAERACEQIDGx/9oACAEBAAE/IWZQhjIPFTxZdwoB1CpF5SyGi0//2gAMAwEAAgADAAAAEGfvAP/EABYRAQEBAAAAAAAAAAAAAAAAAAERIP/aAAgBAwEBPxBW4//EABgRAQADAQAAAAAAAAAAAAAAAAEAEBHh/9oACAECAQE/EGaXkb//xAAeEAEBAAEEAwEAAAAAAAAAAAABESEAMUFhECBxwf/aAAgBAQABPxBSMi50HycxA+/j4mbfQaZtJz1qYZEiAUiAeB2k71ltDTzCen//2Q==","sizes":"(max-width: 2000px) 100vw, 2000px","src":"/static/9611cacec962506545385f22b26d913d/883ab/loopback.jpg","srcSet":"/static/9611cacec962506545385f22b26d913d/f8f18/loopback.jpg 930w,\n/static/9611cacec962506545385f22b26d913d/0e6ff/loopback.jpg 1860w,\n/static/9611cacec962506545385f22b26d913d/883ab/loopback.jpg 2000w"}}},"author":{"id":"ludo","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"fixed":{"src":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png"}}]}}},"fields":{"layout":"post","slug":"/node-loopback/"}},"next":{"excerpt":"Utilisations de PM2 PM2 a beaucoup d’utilisations, jetons un coup d’oeil à quelques-unes d’entre elles: Redémarrage après un crash: PM2 nous permet de maintenir les processus en cours d’exécution Suivi et gestion des processus à distance: un portail web vous permet de garder un oeil sur les precessus distants et de les gérer. Il ne se contente pas d’exécuter des applications Node: PM2 n’est pas limité aux seuls processus Node.js, c’est vrai, vous pouvez même l’utiliser pour garder votre serveur Minecraft en ligne. PM2 peut mémoriser tous vos processus et les redémarrer après un redémarrage du système. Et bien plus encore. Pour commencer La première chose que nous devons faire est d’installer PM2 globalement sur votre machine : Commandes de base Venons-en aux principe de base de son utilisation. Pour démarrer un processus sous PM2, il suffit de lancer pm2 start <app>. App étant le nom du fihier que vous exécutez. PM2 produira quelque chose comme ceci Faites attention à ce qu’il dis sous id. Si vous oubliez, lancez pm2 list. Si vous voulez ajouter un nom au processus lorsque vous le lancez, vous pouvez utiliser le paramètre --name (pm2 start app.js --name my-api). Votre application fonctionne maintenant sous PM2, si elle plante, PM2 la redémarrera. Redémarrage en cas de modification de fichier Une autre fonctionnalité impressionnante que PM2 a est de redémarrer quand un fichier dans le répertoire de travail change. Pour que PM2 regarde notre répertoire et redémmarre les changements de fichier, incluez --watch lorsque vous démarrez votre application. Persistance jusqu’au redémarrage PM2 nous permet également de démarrer nos processus lorsque notre serveur (re)démarre. Commencez tout ce que vous voulez avoir en cours d’exécution tout le temps à travers pm2 start et puis exécutez pm2 save. Maintenant, quand notre système redémarre, PM2 démarrera tous les processus que nous avions en cours d’exécution lorsque nous avons lancé pm2 save. PM2 fait beaucoup de choses, je vais vous laisser découvrir le reste par vous même d’autres fonctions Le mode cluster Commandes Description pm2 start app.js -i 0 Démarre un maximum de processus avec LB en fonction des CPU disponibles. Listen Commandes Description pm2 list Afficher l’état de tous les processus pm2 jlist Impression de la liste des processus en JSON brut pm2 prettylist Impression de la liste des processus en JSON embelli pm2 describe 0 Afficher toutes les informations concernant un spécifique pm2 monit Surveiller tous les processus Logs Commandes Description pm2 logs [--raw] Afficher tous les journaux de processus en streaming pm2 flush Vider tous les fichiers logs pm2 reloadLogs Recharger tous les logs Actions Commandes Description pm2 stop all Arrêter tous les processus pm2 restart all Redémarrer tous les processus pm2 reload all Rechargement des temps d’arrêt 0s (pour les applications NETWORKED) pm2 stop 0 Arrêt d’un id de processus spécifique pm2 restart 0 Redémarrer un id de processus spécifique pm2 delete 0 Supprimer le processus de la liste pm2 delete all Supprimer tous les processus de la liste PM2 fait beaucoup de choses, dont la plupart sortent du cadre de cette brève introduction. A l’avenir, nous pourrions couvrir le mode cluster de PM2, la gestion des processus à distance et plus encore. Merci de votre lecture !","timeToRead":3,"frontmatter":{"title":"Prise en main de PM2, le gestionnaire de processus Node.js","subtitle":"PM2, ou Process Manager 2 est un gestionnaire de processus de production incroyablement polyvalent, écrit en Node.js.","tags":["PM2","Node.js"],"category":["Node.js"],"date":"2019-08-01T21:00:00.000Z","draft":false,"image":{"childImageSharp":{"fluid":{"aspectRatio":1.7777777777777777,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB7sbJEUL/AP/EABgQAQEAAwAAAAAAAAAAAAAAAAEAEBIh/9oACAEBAAEFAltmOmf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAXEAADAQAAAAAAAAAAAAAAAAAAIDEy/9oACAEBAAY/AoZX/8QAGRABAAIDAAAAAAAAAAAAAAAAAQARICEx/9oACAEBAAE/IUHpid7xtiVh/9oADAMBAAIAAwAAABAUD//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/ECf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAEBAAIDAAAAAAAAAAAAAAABEQBBIFHh/9oACAEBAAE/EFQSFpvAquOmid+YIS3Tw//Z","sizes":"(max-width: 1280px) 100vw, 1280px","src":"/static/73813d7b6a5ab8956ab1d3105c143941/c108b/pm2.jpg","srcSet":"/static/73813d7b6a5ab8956ab1d3105c143941/f8f18/pm2.jpg 930w,\n/static/73813d7b6a5ab8956ab1d3105c143941/c108b/pm2.jpg 1280w"}}},"author":{"id":"ludo","bio":"Développeur senior. Fullstack + DevOps","avatar":{"children":[{"fixed":{"src":"/static/5f2c129e42248a92c87b13b4293950cf/4e842/ghost.png"}}]}}},"fields":{"layout":"post","slug":"/node-pm2/"}},"primaryTag":"LoopBack","primaryCategory":"Node.js"}}}